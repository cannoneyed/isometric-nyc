(function(){const M=document.createElement("link").relList;if(M&&M.supports&&M.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function i(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(a){if(a.ep)return;a.ep=!0;const o=i(a);fetch(a.href,o)}})();function Ku(L){return L&&L.__esModule&&Object.prototype.hasOwnProperty.call(L,"default")?L.default:L}var Vs={exports:{}},Zn={},Gs={exports:{}},Oe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bu;function Xh(){if(Bu)return Oe;Bu=1;var L=Symbol.for("react.element"),M=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),g=Symbol.iterator;function v(O){return O===null||typeof O!="object"?null:(O=g&&O[g]||O["@@iterator"],typeof O=="function"?O:null)}var T={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E=Object.assign,_={};function C(O,j,ne){this.props=O,this.context=j,this.refs=_,this.updater=ne||T}C.prototype.isReactComponent={},C.prototype.setState=function(O,j){if(typeof O!="object"&&typeof O!="function"&&O!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,O,j,"setState")},C.prototype.forceUpdate=function(O){this.updater.enqueueForceUpdate(this,O,"forceUpdate")};function D(){}D.prototype=C.prototype;function H(O,j,ne){this.props=O,this.context=j,this.refs=_,this.updater=ne||T}var N=H.prototype=new D;N.constructor=H,E(N,C.prototype),N.isPureReactComponent=!0;var J=Array.isArray,Q=Object.prototype.hasOwnProperty,ee={current:null},he={key:!0,ref:!0,__self:!0,__source:!0};function ie(O,j,ne){var Re,De={},ke=null,Ne=null;if(j!=null)for(Re in j.ref!==void 0&&(Ne=j.ref),j.key!==void 0&&(ke=""+j.key),j)Q.call(j,Re)&&!he.hasOwnProperty(Re)&&(De[Re]=j[Re]);var ze=arguments.length-2;if(ze===1)De.children=ne;else if(1<ze){for(var He=Array(ze),Je=0;Je<ze;Je++)He[Je]=arguments[Je+2];De.children=He}if(O&&O.defaultProps)for(Re in ze=O.defaultProps,ze)De[Re]===void 0&&(De[Re]=ze[Re]);return{$$typeof:L,type:O,key:ke,ref:Ne,props:De,_owner:ee.current}}function ue(O,j){return{$$typeof:L,type:O.type,key:j,ref:O.ref,props:O.props,_owner:O._owner}}function se(O){return typeof O=="object"&&O!==null&&O.$$typeof===L}function pe(O){var j={"=":"=0",":":"=2"};return"$"+O.replace(/[=:]/g,function(ne){return j[ne]})}var re=/\/+/g;function Te(O,j){return typeof O=="object"&&O!==null&&O.key!=null?pe(""+O.key):j.toString(36)}function Me(O,j,ne,Re,De){var ke=typeof O;(ke==="undefined"||ke==="boolean")&&(O=null);var Ne=!1;if(O===null)Ne=!0;else switch(ke){case"string":case"number":Ne=!0;break;case"object":switch(O.$$typeof){case L:case M:Ne=!0}}if(Ne)return Ne=O,De=De(Ne),O=Re===""?"."+Te(Ne,0):Re,J(De)?(ne="",O!=null&&(ne=O.replace(re,"$&/")+"/"),Me(De,j,ne,"",function(Je){return Je})):De!=null&&(se(De)&&(De=ue(De,ne+(!De.key||Ne&&Ne.key===De.key?"":(""+De.key).replace(re,"$&/")+"/")+O)),j.push(De)),1;if(Ne=0,Re=Re===""?".":Re+":",J(O))for(var ze=0;ze<O.length;ze++){ke=O[ze];var He=Re+Te(ke,ze);Ne+=Me(ke,j,ne,He,De)}else if(He=v(O),typeof He=="function")for(O=He.call(O),ze=0;!(ke=O.next()).done;)ke=ke.value,He=Re+Te(ke,ze++),Ne+=Me(ke,j,ne,He,De);else if(ke==="object")throw j=String(O),Error("Objects are not valid as a React child (found: "+(j==="[object Object]"?"object with keys {"+Object.keys(O).join(", ")+"}":j)+"). If you meant to render a collection of children, use an array instead.");return Ne}function Le(O,j,ne){if(O==null)return O;var Re=[],De=0;return Me(O,Re,"","",function(ke){return j.call(ne,ke,De++)}),Re}function Ce(O){if(O._status===-1){var j=O._result;j=j(),j.then(function(ne){(O._status===0||O._status===-1)&&(O._status=1,O._result=ne)},function(ne){(O._status===0||O._status===-1)&&(O._status=2,O._result=ne)}),O._status===-1&&(O._status=0,O._result=j)}if(O._status===1)return O._result.default;throw O._result}var Se={current:null},Y={transition:null},de={ReactCurrentDispatcher:Se,ReactCurrentBatchConfig:Y,ReactCurrentOwner:ee};function oe(){throw Error("act(...) is not supported in production builds of React.")}return Oe.Children={map:Le,forEach:function(O,j,ne){Le(O,function(){j.apply(this,arguments)},ne)},count:function(O){var j=0;return Le(O,function(){j++}),j},toArray:function(O){return Le(O,function(j){return j})||[]},only:function(O){if(!se(O))throw Error("React.Children.only expected to receive a single React element child.");return O}},Oe.Component=C,Oe.Fragment=i,Oe.Profiler=a,Oe.PureComponent=H,Oe.StrictMode=r,Oe.Suspense=u,Oe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=de,Oe.act=oe,Oe.cloneElement=function(O,j,ne){if(O==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+O+".");var Re=E({},O.props),De=O.key,ke=O.ref,Ne=O._owner;if(j!=null){if(j.ref!==void 0&&(ke=j.ref,Ne=ee.current),j.key!==void 0&&(De=""+j.key),O.type&&O.type.defaultProps)var ze=O.type.defaultProps;for(He in j)Q.call(j,He)&&!he.hasOwnProperty(He)&&(Re[He]=j[He]===void 0&&ze!==void 0?ze[He]:j[He])}var He=arguments.length-2;if(He===1)Re.children=ne;else if(1<He){ze=Array(He);for(var Je=0;Je<He;Je++)ze[Je]=arguments[Je+2];Re.children=ze}return{$$typeof:L,type:O.type,key:De,ref:ke,props:Re,_owner:Ne}},Oe.createContext=function(O){return O={$$typeof:l,_currentValue:O,_currentValue2:O,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},O.Provider={$$typeof:o,_context:O},O.Consumer=O},Oe.createElement=ie,Oe.createFactory=function(O){var j=ie.bind(null,O);return j.type=O,j},Oe.createRef=function(){return{current:null}},Oe.forwardRef=function(O){return{$$typeof:d,render:O}},Oe.isValidElement=se,Oe.lazy=function(O){return{$$typeof:f,_payload:{_status:-1,_result:O},_init:Ce}},Oe.memo=function(O,j){return{$$typeof:h,type:O,compare:j===void 0?null:j}},Oe.startTransition=function(O){var j=Y.transition;Y.transition={};try{O()}finally{Y.transition=j}},Oe.unstable_act=oe,Oe.useCallback=function(O,j){return Se.current.useCallback(O,j)},Oe.useContext=function(O){return Se.current.useContext(O)},Oe.useDebugValue=function(){},Oe.useDeferredValue=function(O){return Se.current.useDeferredValue(O)},Oe.useEffect=function(O,j){return Se.current.useEffect(O,j)},Oe.useId=function(){return Se.current.useId()},Oe.useImperativeHandle=function(O,j,ne){return Se.current.useImperativeHandle(O,j,ne)},Oe.useInsertionEffect=function(O,j){return Se.current.useInsertionEffect(O,j)},Oe.useLayoutEffect=function(O,j){return Se.current.useLayoutEffect(O,j)},Oe.useMemo=function(O,j){return Se.current.useMemo(O,j)},Oe.useReducer=function(O,j,ne){return Se.current.useReducer(O,j,ne)},Oe.useRef=function(O){return Se.current.useRef(O)},Oe.useState=function(O){return Se.current.useState(O)},Oe.useSyncExternalStore=function(O,j,ne){return Se.current.useSyncExternalStore(O,j,ne)},Oe.useTransition=function(){return Se.current.useTransition()},Oe.version="18.3.1",Oe}var Hu;function ta(){return Hu||(Hu=1,Gs.exports=Xh()),Gs.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bu;function Yh(){if(bu)return Zn;bu=1;var L=ta(),M=Symbol.for("react.element"),i=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,a=L.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function l(d,u,h){var f,g={},v=null,T=null;h!==void 0&&(v=""+h),u.key!==void 0&&(v=""+u.key),u.ref!==void 0&&(T=u.ref);for(f in u)r.call(u,f)&&!o.hasOwnProperty(f)&&(g[f]=u[f]);if(d&&d.defaultProps)for(f in u=d.defaultProps,u)g[f]===void 0&&(g[f]=u[f]);return{$$typeof:M,type:d,key:v,ref:T,props:g,_owner:a.current}}return Zn.Fragment=i,Zn.jsx=l,Zn.jsxs=l,Zn}var Uu;function Qh(){return Uu||(Uu=1,Vs.exports=Yh()),Vs.exports}var te=Qh(),eo={},Zs={exports:{}},Et={},qs={exports:{}},Xs={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ju;function Kh(){return ju||(ju=1,(function(L){function M(Y,de){var oe=Y.length;Y.push(de);e:for(;0<oe;){var O=oe-1>>>1,j=Y[O];if(0<a(j,de))Y[O]=de,Y[oe]=j,oe=O;else break e}}function i(Y){return Y.length===0?null:Y[0]}function r(Y){if(Y.length===0)return null;var de=Y[0],oe=Y.pop();if(oe!==de){Y[0]=oe;e:for(var O=0,j=Y.length,ne=j>>>1;O<ne;){var Re=2*(O+1)-1,De=Y[Re],ke=Re+1,Ne=Y[ke];if(0>a(De,oe))ke<j&&0>a(Ne,De)?(Y[O]=Ne,Y[ke]=oe,O=ke):(Y[O]=De,Y[Re]=oe,O=Re);else if(ke<j&&0>a(Ne,oe))Y[O]=Ne,Y[ke]=oe,O=ke;else break e}}return de}function a(Y,de){var oe=Y.sortIndex-de.sortIndex;return oe!==0?oe:Y.id-de.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;L.unstable_now=function(){return o.now()}}else{var l=Date,d=l.now();L.unstable_now=function(){return l.now()-d}}var u=[],h=[],f=1,g=null,v=3,T=!1,E=!1,_=!1,C=typeof setTimeout=="function"?setTimeout:null,D=typeof clearTimeout=="function"?clearTimeout:null,H=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function N(Y){for(var de=i(h);de!==null;){if(de.callback===null)r(h);else if(de.startTime<=Y)r(h),de.sortIndex=de.expirationTime,M(u,de);else break;de=i(h)}}function J(Y){if(_=!1,N(Y),!E)if(i(u)!==null)E=!0,Ce(Q);else{var de=i(h);de!==null&&Se(J,de.startTime-Y)}}function Q(Y,de){E=!1,_&&(_=!1,D(ie),ie=-1),T=!0;var oe=v;try{for(N(de),g=i(u);g!==null&&(!(g.expirationTime>de)||Y&&!pe());){var O=g.callback;if(typeof O=="function"){g.callback=null,v=g.priorityLevel;var j=O(g.expirationTime<=de);de=L.unstable_now(),typeof j=="function"?g.callback=j:g===i(u)&&r(u),N(de)}else r(u);g=i(u)}if(g!==null)var ne=!0;else{var Re=i(h);Re!==null&&Se(J,Re.startTime-de),ne=!1}return ne}finally{g=null,v=oe,T=!1}}var ee=!1,he=null,ie=-1,ue=5,se=-1;function pe(){return!(L.unstable_now()-se<ue)}function re(){if(he!==null){var Y=L.unstable_now();se=Y;var de=!0;try{de=he(!0,Y)}finally{de?Te():(ee=!1,he=null)}}else ee=!1}var Te;if(typeof H=="function")Te=function(){H(re)};else if(typeof MessageChannel<"u"){var Me=new MessageChannel,Le=Me.port2;Me.port1.onmessage=re,Te=function(){Le.postMessage(null)}}else Te=function(){C(re,0)};function Ce(Y){he=Y,ee||(ee=!0,Te())}function Se(Y,de){ie=C(function(){Y(L.unstable_now())},de)}L.unstable_IdlePriority=5,L.unstable_ImmediatePriority=1,L.unstable_LowPriority=4,L.unstable_NormalPriority=3,L.unstable_Profiling=null,L.unstable_UserBlockingPriority=2,L.unstable_cancelCallback=function(Y){Y.callback=null},L.unstable_continueExecution=function(){E||T||(E=!0,Ce(Q))},L.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ue=0<Y?Math.floor(1e3/Y):5},L.unstable_getCurrentPriorityLevel=function(){return v},L.unstable_getFirstCallbackNode=function(){return i(u)},L.unstable_next=function(Y){switch(v){case 1:case 2:case 3:var de=3;break;default:de=v}var oe=v;v=de;try{return Y()}finally{v=oe}},L.unstable_pauseExecution=function(){},L.unstable_requestPaint=function(){},L.unstable_runWithPriority=function(Y,de){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var oe=v;v=Y;try{return de()}finally{v=oe}},L.unstable_scheduleCallback=function(Y,de,oe){var O=L.unstable_now();switch(typeof oe=="object"&&oe!==null?(oe=oe.delay,oe=typeof oe=="number"&&0<oe?O+oe:O):oe=O,Y){case 1:var j=-1;break;case 2:j=250;break;case 5:j=1073741823;break;case 4:j=1e4;break;default:j=5e3}return j=oe+j,Y={id:f++,callback:de,priorityLevel:Y,startTime:oe,expirationTime:j,sortIndex:-1},oe>O?(Y.sortIndex=oe,M(h,Y),i(u)===null&&Y===i(h)&&(_?(D(ie),ie=-1):_=!0,Se(J,oe-O))):(Y.sortIndex=j,M(u,Y),E||T||(E=!0,Ce(Q))),Y},L.unstable_shouldYield=pe,L.unstable_wrapCallback=function(Y){var de=v;return function(){var oe=v;v=de;try{return Y.apply(this,arguments)}finally{v=oe}}}})(Xs)),Xs}var Wu;function Jh(){return Wu||(Wu=1,qs.exports=Kh()),qs.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vu;function $h(){if(Vu)return Et;Vu=1;var L=ta(),M=Jh();function i(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,a={};function o(e,t){l(e,t),l(e+"Capture",t)}function l(e,t){for(a[e]=t,e=0;e<t.length;e++)r.add(t[e])}var d=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},g={};function v(e){return u.call(g,e)?!0:u.call(f,e)?!1:h.test(e)?g[e]=!0:(f[e]=!0,!1)}function T(e,t,n,s){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return s?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function E(e,t,n,s){if(t===null||typeof t>"u"||T(e,t,n,s))return!0;if(s)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function _(e,t,n,s,c,p,x){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=s,this.attributeNamespace=c,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=p,this.removeEmptyString=x}var C={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){C[e]=new _(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];C[t]=new _(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){C[e]=new _(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){C[e]=new _(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){C[e]=new _(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){C[e]=new _(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){C[e]=new _(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){C[e]=new _(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){C[e]=new _(e,5,!1,e.toLowerCase(),null,!1,!1)});var D=/[\-:]([a-z])/g;function H(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(D,H);C[t]=new _(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(D,H);C[t]=new _(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(D,H);C[t]=new _(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){C[e]=new _(e,1,!1,e.toLowerCase(),null,!1,!1)}),C.xlinkHref=new _("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){C[e]=new _(e,1,!1,e.toLowerCase(),null,!0,!0)});function N(e,t,n,s){var c=C.hasOwnProperty(t)?C[t]:null;(c!==null?c.type!==0:s||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(E(t,n,c,s)&&(n=null),s||c===null?v(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):c.mustUseProperty?e[c.propertyName]=n===null?c.type===3?!1:"":n:(t=c.attributeName,s=c.attributeNamespace,n===null?e.removeAttribute(t):(c=c.type,n=c===3||c===4&&n===!0?"":""+n,s?e.setAttributeNS(s,t,n):e.setAttribute(t,n))))}var J=L.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Q=Symbol.for("react.element"),ee=Symbol.for("react.portal"),he=Symbol.for("react.fragment"),ie=Symbol.for("react.strict_mode"),ue=Symbol.for("react.profiler"),se=Symbol.for("react.provider"),pe=Symbol.for("react.context"),re=Symbol.for("react.forward_ref"),Te=Symbol.for("react.suspense"),Me=Symbol.for("react.suspense_list"),Le=Symbol.for("react.memo"),Ce=Symbol.for("react.lazy"),Se=Symbol.for("react.offscreen"),Y=Symbol.iterator;function de(e){return e===null||typeof e!="object"?null:(e=Y&&e[Y]||e["@@iterator"],typeof e=="function"?e:null)}var oe=Object.assign,O;function j(e){if(O===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);O=t&&t[1]||""}return`
`+O+e}var ne=!1;function Re(e,t){if(!e||ne)return"";ne=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(b){var s=b}Reflect.construct(e,[],t)}else{try{t.call()}catch(b){s=b}e.call(t.prototype)}else{try{throw Error()}catch(b){s=b}e()}}catch(b){if(b&&s&&typeof b.stack=="string"){for(var c=b.stack.split(`
`),p=s.stack.split(`
`),x=c.length-1,k=p.length-1;1<=x&&0<=k&&c[x]!==p[k];)k--;for(;1<=x&&0<=k;x--,k--)if(c[x]!==p[k]){if(x!==1||k!==1)do if(x--,k--,0>k||c[x]!==p[k]){var F=`
`+c[x].replace(" at new "," at ");return e.displayName&&F.includes("<anonymous>")&&(F=F.replace("<anonymous>",e.displayName)),F}while(1<=x&&0<=k);break}}}finally{ne=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?j(e):""}function De(e){switch(e.tag){case 5:return j(e.type);case 16:return j("Lazy");case 13:return j("Suspense");case 19:return j("SuspenseList");case 0:case 2:case 15:return e=Re(e.type,!1),e;case 11:return e=Re(e.type.render,!1),e;case 1:return e=Re(e.type,!0),e;default:return""}}function ke(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case he:return"Fragment";case ee:return"Portal";case ue:return"Profiler";case ie:return"StrictMode";case Te:return"Suspense";case Me:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case pe:return(e.displayName||"Context")+".Consumer";case se:return(e._context.displayName||"Context")+".Provider";case re:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Le:return t=e.displayName||null,t!==null?t:ke(e.type)||"Memo";case Ce:t=e._payload,e=e._init;try{return ke(e(t))}catch{}}return null}function Ne(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ke(t);case 8:return t===ie?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function ze(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function He(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Je(e){var t=He(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),s=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var c=n.get,p=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return c.call(this)},set:function(x){s=""+x,p.call(this,x)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(x){s=""+x},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Nt(e){e._valueTracker||(e._valueTracker=Je(e))}function si(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),s="";return e&&(s=He(e)?e.checked?"true":"false":e.value),e=s,e!==n?(t.setValue(e),!0):!1}function vt(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Yt(e,t){var n=t.checked;return oe({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function rt(e,t){var n=t.defaultValue==null?"":t.defaultValue,s=t.checked!=null?t.checked:t.defaultChecked;n=ze(t.value!=null?t.value:n),e._wrapperState={initialChecked:s,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function yt(e,t){t=t.checked,t!=null&&N(e,"checked",t,!1)}function m(e,t){yt(e,t);var n=ze(t.value),s=t.type;if(n!=null)s==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(s==="submit"||s==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?A(e,t.type,n):t.hasOwnProperty("defaultValue")&&A(e,t.type,ze(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function P(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var s=t.type;if(!(s!=="submit"&&s!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function A(e,t,n){(t!=="number"||vt(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var V=Array.isArray;function $(e,t,n,s){if(e=e.options,t){t={};for(var c=0;c<n.length;c++)t["$"+n[c]]=!0;for(n=0;n<e.length;n++)c=t.hasOwnProperty("$"+e[n].value),e[n].selected!==c&&(e[n].selected=c),c&&s&&(e[n].defaultSelected=!0)}else{for(n=""+ze(n),t=null,c=0;c<e.length;c++){if(e[c].value===n){e[c].selected=!0,s&&(e[c].defaultSelected=!0);return}t!==null||e[c].disabled||(t=e[c])}t!==null&&(t.selected=!0)}}function ge(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(i(91));return oe({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function W(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(i(92));if(V(n)){if(1<n.length)throw Error(i(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:ze(n)}}function Ee(e,t){var n=ze(t.value),s=ze(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),s!=null&&(e.defaultValue=""+s)}function Ie(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function je(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function _e(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?je(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var We,w=(function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,s,c){MSApp.execUnsafeLocalFunction(function(){return e(t,n,s,c)})}:e})(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(We=We||document.createElement("div"),We.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=We.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function y(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var S={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},R=["Webkit","ms","Moz","O"];Object.keys(S).forEach(function(e){R.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),S[t]=S[e]})});function U(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||S.hasOwnProperty(e)&&S[e]?(""+t).trim():t+"px"}function X(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var s=n.indexOf("--")===0,c=U(n,t[n],s);n==="float"&&(n="cssFloat"),s?e.setProperty(n,c):e[n]=c}}var ve=oe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ae(e,t){if(t){if(ve[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(i(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(i(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(i(61))}if(t.style!=null&&typeof t.style!="object")throw Error(i(62))}}function ye(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var lt=null;function Qe(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Wt=null,Qt=null,Kt=null;function un(e){if(e=Ln(e)){if(typeof Wt!="function")throw Error(i(280));var t=e.stateNode;t&&(t=gr(t),Wt(e.stateNode,e.type,t))}}function ia(e){Qt?Kt?Kt.push(e):Kt=[e]:Qt=e}function na(){if(Qt){var e=Qt,t=Kt;if(Kt=Qt=null,un(e),t)for(e=0;e<t.length;e++)un(t[e])}}function ra(e,t){return e(t)}function oa(){}var so=!1;function sa(e,t,n){if(so)return e(t,n);so=!0;try{return ra(e,t,n)}finally{so=!1,(Qt!==null||Kt!==null)&&(oa(),na())}}function cn(e,t){var n=e.stateNode;if(n===null)return null;var s=gr(n);if(s===null)return null;n=s[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(e=e.type,s=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!s;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(i(231,t,typeof n));return n}var ao=!1;if(d)try{var hn={};Object.defineProperty(hn,"passive",{get:function(){ao=!0}}),window.addEventListener("test",hn,hn),window.removeEventListener("test",hn,hn)}catch{ao=!1}function ec(e,t,n,s,c,p,x,k,F){var b=Array.prototype.slice.call(arguments,3);try{t.apply(n,b)}catch(Z){this.onError(Z)}}var dn=!1,qn=null,Xn=!1,lo=null,tc={onError:function(e){dn=!0,qn=e}};function ic(e,t,n,s,c,p,x,k,F){dn=!1,qn=null,ec.apply(tc,arguments)}function nc(e,t,n,s,c,p,x,k,F){if(ic.apply(this,arguments),dn){if(dn){var b=qn;dn=!1,qn=null}else throw Error(i(198));Xn||(Xn=!0,lo=b)}}function Ci(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function aa(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function la(e){if(Ci(e)!==e)throw Error(i(188))}function rc(e){var t=e.alternate;if(!t){if(t=Ci(e),t===null)throw Error(i(188));return t!==e?null:e}for(var n=e,s=t;;){var c=n.return;if(c===null)break;var p=c.alternate;if(p===null){if(s=c.return,s!==null){n=s;continue}break}if(c.child===p.child){for(p=c.child;p;){if(p===n)return la(c),e;if(p===s)return la(c),t;p=p.sibling}throw Error(i(188))}if(n.return!==s.return)n=c,s=p;else{for(var x=!1,k=c.child;k;){if(k===n){x=!0,n=c,s=p;break}if(k===s){x=!0,s=c,n=p;break}k=k.sibling}if(!x){for(k=p.child;k;){if(k===n){x=!0,n=p,s=c;break}if(k===s){x=!0,s=p,n=c;break}k=k.sibling}if(!x)throw Error(i(189))}}if(n.alternate!==s)throw Error(i(190))}if(n.tag!==3)throw Error(i(188));return n.stateNode.current===n?e:t}function ua(e){return e=rc(e),e!==null?ca(e):null}function ca(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=ca(e);if(t!==null)return t;e=e.sibling}return null}var ha=M.unstable_scheduleCallback,da=M.unstable_cancelCallback,oc=M.unstable_shouldYield,sc=M.unstable_requestPaint,$e=M.unstable_now,ac=M.unstable_getCurrentPriorityLevel,uo=M.unstable_ImmediatePriority,fa=M.unstable_UserBlockingPriority,Yn=M.unstable_NormalPriority,lc=M.unstable_LowPriority,pa=M.unstable_IdlePriority,Qn=null,Vt=null;function uc(e){if(Vt&&typeof Vt.onCommitFiberRoot=="function")try{Vt.onCommitFiberRoot(Qn,e,void 0,(e.current.flags&128)===128)}catch{}}var It=Math.clz32?Math.clz32:dc,cc=Math.log,hc=Math.LN2;function dc(e){return e>>>=0,e===0?32:31-(cc(e)/hc|0)|0}var Kn=64,Jn=4194304;function fn(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function $n(e,t){var n=e.pendingLanes;if(n===0)return 0;var s=0,c=e.suspendedLanes,p=e.pingedLanes,x=n&268435455;if(x!==0){var k=x&~c;k!==0?s=fn(k):(p&=x,p!==0&&(s=fn(p)))}else x=n&~c,x!==0?s=fn(x):p!==0&&(s=fn(p));if(s===0)return 0;if(t!==0&&t!==s&&(t&c)===0&&(c=s&-s,p=t&-t,c>=p||c===16&&(p&4194240)!==0))return t;if((s&4)!==0&&(s|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=s;0<t;)n=31-It(t),c=1<<n,s|=e[n],t&=~c;return s}function fc(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function pc(e,t){for(var n=e.suspendedLanes,s=e.pingedLanes,c=e.expirationTimes,p=e.pendingLanes;0<p;){var x=31-It(p),k=1<<x,F=c[x];F===-1?((k&n)===0||(k&s)!==0)&&(c[x]=fc(k,t)):F<=t&&(e.expiredLanes|=k),p&=~k}}function co(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function ga(){var e=Kn;return Kn<<=1,(Kn&4194240)===0&&(Kn=64),e}function ho(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function pn(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-It(t),e[t]=n}function gc(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var s=e.eventTimes;for(e=e.expirationTimes;0<n;){var c=31-It(n),p=1<<c;t[c]=0,s[c]=-1,e[c]=-1,n&=~p}}function fo(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var s=31-It(n),c=1<<s;c&t|e[s]&t&&(e[s]|=t),n&=~c}}var Ue=0;function ma(e){return e&=-e,1<e?4<e?(e&268435455)!==0?16:536870912:4:1}var va,po,ya,wa,xa,go=!1,er=[],ai=null,li=null,ui=null,gn=new Map,mn=new Map,ci=[],mc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ta(e,t){switch(e){case"focusin":case"focusout":ai=null;break;case"dragenter":case"dragleave":li=null;break;case"mouseover":case"mouseout":ui=null;break;case"pointerover":case"pointerout":gn.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":mn.delete(t.pointerId)}}function vn(e,t,n,s,c,p){return e===null||e.nativeEvent!==p?(e={blockedOn:t,domEventName:n,eventSystemFlags:s,nativeEvent:p,targetContainers:[c]},t!==null&&(t=Ln(t),t!==null&&po(t)),e):(e.eventSystemFlags|=s,t=e.targetContainers,c!==null&&t.indexOf(c)===-1&&t.push(c),e)}function vc(e,t,n,s,c){switch(t){case"focusin":return ai=vn(ai,e,t,n,s,c),!0;case"dragenter":return li=vn(li,e,t,n,s,c),!0;case"mouseover":return ui=vn(ui,e,t,n,s,c),!0;case"pointerover":var p=c.pointerId;return gn.set(p,vn(gn.get(p)||null,e,t,n,s,c)),!0;case"gotpointercapture":return p=c.pointerId,mn.set(p,vn(mn.get(p)||null,e,t,n,s,c)),!0}return!1}function _a(e){var t=Ri(e.target);if(t!==null){var n=Ci(t);if(n!==null){if(t=n.tag,t===13){if(t=aa(n),t!==null){e.blockedOn=t,xa(e.priority,function(){ya(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function tr(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=vo(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var s=new n.constructor(n.type,n);lt=s,n.target.dispatchEvent(s),lt=null}else return t=Ln(n),t!==null&&po(t),e.blockedOn=n,!1;t.shift()}return!0}function Sa(e,t,n){tr(e)&&n.delete(t)}function yc(){go=!1,ai!==null&&tr(ai)&&(ai=null),li!==null&&tr(li)&&(li=null),ui!==null&&tr(ui)&&(ui=null),gn.forEach(Sa),mn.forEach(Sa)}function yn(e,t){e.blockedOn===t&&(e.blockedOn=null,go||(go=!0,M.unstable_scheduleCallback(M.unstable_NormalPriority,yc)))}function wn(e){function t(c){return yn(c,e)}if(0<er.length){yn(er[0],e);for(var n=1;n<er.length;n++){var s=er[n];s.blockedOn===e&&(s.blockedOn=null)}}for(ai!==null&&yn(ai,e),li!==null&&yn(li,e),ui!==null&&yn(ui,e),gn.forEach(t),mn.forEach(t),n=0;n<ci.length;n++)s=ci[n],s.blockedOn===e&&(s.blockedOn=null);for(;0<ci.length&&(n=ci[0],n.blockedOn===null);)_a(n),n.blockedOn===null&&ci.shift()}var Hi=J.ReactCurrentBatchConfig,ir=!0;function wc(e,t,n,s){var c=Ue,p=Hi.transition;Hi.transition=null;try{Ue=1,mo(e,t,n,s)}finally{Ue=c,Hi.transition=p}}function xc(e,t,n,s){var c=Ue,p=Hi.transition;Hi.transition=null;try{Ue=4,mo(e,t,n,s)}finally{Ue=c,Hi.transition=p}}function mo(e,t,n,s){if(ir){var c=vo(e,t,n,s);if(c===null)Mo(e,t,s,nr,n),Ta(e,s);else if(vc(c,e,t,n,s))s.stopPropagation();else if(Ta(e,s),t&4&&-1<mc.indexOf(e)){for(;c!==null;){var p=Ln(c);if(p!==null&&va(p),p=vo(e,t,n,s),p===null&&Mo(e,t,s,nr,n),p===c)break;c=p}c!==null&&s.stopPropagation()}else Mo(e,t,s,null,n)}}var nr=null;function vo(e,t,n,s){if(nr=null,e=Qe(s),e=Ri(e),e!==null)if(t=Ci(e),t===null)e=null;else if(n=t.tag,n===13){if(e=aa(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return nr=e,null}function Ea(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ac()){case uo:return 1;case fa:return 4;case Yn:case lc:return 16;case pa:return 536870912;default:return 16}default:return 16}}var hi=null,yo=null,rr=null;function Pa(){if(rr)return rr;var e,t=yo,n=t.length,s,c="value"in hi?hi.value:hi.textContent,p=c.length;for(e=0;e<n&&t[e]===c[e];e++);var x=n-e;for(s=1;s<=x&&t[n-s]===c[p-s];s++);return rr=c.slice(e,1<s?1-s:void 0)}function or(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function sr(){return!0}function Ca(){return!1}function Pt(e){function t(n,s,c,p,x){this._reactName=n,this._targetInst=c,this.type=s,this.nativeEvent=p,this.target=x,this.currentTarget=null;for(var k in e)e.hasOwnProperty(k)&&(n=e[k],this[k]=n?n(p):p[k]);return this.isDefaultPrevented=(p.defaultPrevented!=null?p.defaultPrevented:p.returnValue===!1)?sr:Ca,this.isPropagationStopped=Ca,this}return oe(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=sr)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=sr)},persist:function(){},isPersistent:sr}),t}var bi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},wo=Pt(bi),xn=oe({},bi,{view:0,detail:0}),Tc=Pt(xn),xo,To,Tn,ar=oe({},xn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:So,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Tn&&(Tn&&e.type==="mousemove"?(xo=e.screenX-Tn.screenX,To=e.screenY-Tn.screenY):To=xo=0,Tn=e),xo)},movementY:function(e){return"movementY"in e?e.movementY:To}}),Ra=Pt(ar),_c=oe({},ar,{dataTransfer:0}),Sc=Pt(_c),Ec=oe({},xn,{relatedTarget:0}),_o=Pt(Ec),Pc=oe({},bi,{animationName:0,elapsedTime:0,pseudoElement:0}),Cc=Pt(Pc),Rc=oe({},bi,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Dc=Pt(Rc),kc=oe({},bi,{data:0}),Da=Pt(kc),Fc={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Lc={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},zc={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Oc(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=zc[e])?!!t[e]:!1}function So(){return Oc}var Mc=oe({},xn,{key:function(e){if(e.key){var t=Fc[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=or(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Lc[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:So,charCode:function(e){return e.type==="keypress"?or(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?or(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Nc=Pt(Mc),Ic=oe({},ar,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ka=Pt(Ic),Ac=oe({},xn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:So}),Bc=Pt(Ac),Hc=oe({},bi,{propertyName:0,elapsedTime:0,pseudoElement:0}),bc=Pt(Hc),Uc=oe({},ar,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),jc=Pt(Uc),Wc=[9,13,27,32],Eo=d&&"CompositionEvent"in window,_n=null;d&&"documentMode"in document&&(_n=document.documentMode);var Vc=d&&"TextEvent"in window&&!_n,Fa=d&&(!Eo||_n&&8<_n&&11>=_n),La=" ",za=!1;function Oa(e,t){switch(e){case"keyup":return Wc.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ma(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ui=!1;function Gc(e,t){switch(e){case"compositionend":return Ma(t);case"keypress":return t.which!==32?null:(za=!0,La);case"textInput":return e=t.data,e===La&&za?null:e;default:return null}}function Zc(e,t){if(Ui)return e==="compositionend"||!Eo&&Oa(e,t)?(e=Pa(),rr=yo=hi=null,Ui=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Fa&&t.locale!=="ko"?null:t.data;default:return null}}var qc={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Na(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!qc[e.type]:t==="textarea"}function Ia(e,t,n,s){ia(s),t=dr(t,"onChange"),0<t.length&&(n=new wo("onChange","change",null,n,s),e.push({event:n,listeners:t}))}var Sn=null,En=null;function Xc(e){el(e,0)}function lr(e){var t=Zi(e);if(si(t))return e}function Yc(e,t){if(e==="change")return t}var Aa=!1;if(d){var Po;if(d){var Co="oninput"in document;if(!Co){var Ba=document.createElement("div");Ba.setAttribute("oninput","return;"),Co=typeof Ba.oninput=="function"}Po=Co}else Po=!1;Aa=Po&&(!document.documentMode||9<document.documentMode)}function Ha(){Sn&&(Sn.detachEvent("onpropertychange",ba),En=Sn=null)}function ba(e){if(e.propertyName==="value"&&lr(En)){var t=[];Ia(t,En,e,Qe(e)),sa(Xc,t)}}function Qc(e,t,n){e==="focusin"?(Ha(),Sn=t,En=n,Sn.attachEvent("onpropertychange",ba)):e==="focusout"&&Ha()}function Kc(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return lr(En)}function Jc(e,t){if(e==="click")return lr(t)}function $c(e,t){if(e==="input"||e==="change")return lr(t)}function eh(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var At=typeof Object.is=="function"?Object.is:eh;function Pn(e,t){if(At(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var c=n[s];if(!u.call(t,c)||!At(e[c],t[c]))return!1}return!0}function Ua(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ja(e,t){var n=Ua(e);e=0;for(var s;n;){if(n.nodeType===3){if(s=e+n.textContent.length,e<=t&&s>=t)return{node:n,offset:t-e};e=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Ua(n)}}function Wa(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Wa(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Va(){for(var e=window,t=vt();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=vt(e.document)}return t}function Ro(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function th(e){var t=Va(),n=e.focusedElem,s=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Wa(n.ownerDocument.documentElement,n)){if(s!==null&&Ro(n)){if(t=s.start,e=s.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var c=n.textContent.length,p=Math.min(s.start,c);s=s.end===void 0?p:Math.min(s.end,c),!e.extend&&p>s&&(c=s,s=p,p=c),c=ja(n,p);var x=ja(n,s);c&&x&&(e.rangeCount!==1||e.anchorNode!==c.node||e.anchorOffset!==c.offset||e.focusNode!==x.node||e.focusOffset!==x.offset)&&(t=t.createRange(),t.setStart(c.node,c.offset),e.removeAllRanges(),p>s?(e.addRange(t),e.extend(x.node,x.offset)):(t.setEnd(x.node,x.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var ih=d&&"documentMode"in document&&11>=document.documentMode,ji=null,Do=null,Cn=null,ko=!1;function Ga(e,t,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;ko||ji==null||ji!==vt(s)||(s=ji,"selectionStart"in s&&Ro(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),Cn&&Pn(Cn,s)||(Cn=s,s=dr(Do,"onSelect"),0<s.length&&(t=new wo("onSelect","select",null,t,n),e.push({event:t,listeners:s}),t.target=ji)))}function ur(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Wi={animationend:ur("Animation","AnimationEnd"),animationiteration:ur("Animation","AnimationIteration"),animationstart:ur("Animation","AnimationStart"),transitionend:ur("Transition","TransitionEnd")},Fo={},Za={};d&&(Za=document.createElement("div").style,"AnimationEvent"in window||(delete Wi.animationend.animation,delete Wi.animationiteration.animation,delete Wi.animationstart.animation),"TransitionEvent"in window||delete Wi.transitionend.transition);function cr(e){if(Fo[e])return Fo[e];if(!Wi[e])return e;var t=Wi[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Za)return Fo[e]=t[n];return e}var qa=cr("animationend"),Xa=cr("animationiteration"),Ya=cr("animationstart"),Qa=cr("transitionend"),Ka=new Map,Ja="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function di(e,t){Ka.set(e,t),o(t,[e])}for(var Lo=0;Lo<Ja.length;Lo++){var zo=Ja[Lo],nh=zo.toLowerCase(),rh=zo[0].toUpperCase()+zo.slice(1);di(nh,"on"+rh)}di(qa,"onAnimationEnd"),di(Xa,"onAnimationIteration"),di(Ya,"onAnimationStart"),di("dblclick","onDoubleClick"),di("focusin","onFocus"),di("focusout","onBlur"),di(Qa,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Rn="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),oh=new Set("cancel close invalid load scroll toggle".split(" ").concat(Rn));function $a(e,t,n){var s=e.type||"unknown-event";e.currentTarget=n,nc(s,t,void 0,e),e.currentTarget=null}function el(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var s=e[n],c=s.event;s=s.listeners;e:{var p=void 0;if(t)for(var x=s.length-1;0<=x;x--){var k=s[x],F=k.instance,b=k.currentTarget;if(k=k.listener,F!==p&&c.isPropagationStopped())break e;$a(c,k,b),p=F}else for(x=0;x<s.length;x++){if(k=s[x],F=k.instance,b=k.currentTarget,k=k.listener,F!==p&&c.isPropagationStopped())break e;$a(c,k,b),p=F}}}if(Xn)throw e=lo,Xn=!1,lo=null,e}function Ge(e,t){var n=t[bo];n===void 0&&(n=t[bo]=new Set);var s=e+"__bubble";n.has(s)||(tl(t,e,2,!1),n.add(s))}function Oo(e,t,n){var s=0;t&&(s|=4),tl(n,e,s,t)}var hr="_reactListening"+Math.random().toString(36).slice(2);function Dn(e){if(!e[hr]){e[hr]=!0,r.forEach(function(n){n!=="selectionchange"&&(oh.has(n)||Oo(n,!1,e),Oo(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[hr]||(t[hr]=!0,Oo("selectionchange",!1,t))}}function tl(e,t,n,s){switch(Ea(t)){case 1:var c=wc;break;case 4:c=xc;break;default:c=mo}n=c.bind(null,t,n,e),c=void 0,!ao||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(c=!0),s?c!==void 0?e.addEventListener(t,n,{capture:!0,passive:c}):e.addEventListener(t,n,!0):c!==void 0?e.addEventListener(t,n,{passive:c}):e.addEventListener(t,n,!1)}function Mo(e,t,n,s,c){var p=s;if((t&1)===0&&(t&2)===0&&s!==null)e:for(;;){if(s===null)return;var x=s.tag;if(x===3||x===4){var k=s.stateNode.containerInfo;if(k===c||k.nodeType===8&&k.parentNode===c)break;if(x===4)for(x=s.return;x!==null;){var F=x.tag;if((F===3||F===4)&&(F=x.stateNode.containerInfo,F===c||F.nodeType===8&&F.parentNode===c))return;x=x.return}for(;k!==null;){if(x=Ri(k),x===null)return;if(F=x.tag,F===5||F===6){s=p=x;continue e}k=k.parentNode}}s=s.return}sa(function(){var b=p,Z=Qe(n),q=[];e:{var G=Ka.get(e);if(G!==void 0){var ae=wo,ce=e;switch(e){case"keypress":if(or(n)===0)break e;case"keydown":case"keyup":ae=Nc;break;case"focusin":ce="focus",ae=_o;break;case"focusout":ce="blur",ae=_o;break;case"beforeblur":case"afterblur":ae=_o;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ae=Ra;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ae=Sc;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ae=Bc;break;case qa:case Xa:case Ya:ae=Cc;break;case Qa:ae=bc;break;case"scroll":ae=Tc;break;case"wheel":ae=jc;break;case"copy":case"cut":case"paste":ae=Dc;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ae=ka}var fe=(t&4)!==0,et=!fe&&e==="scroll",I=fe?G!==null?G+"Capture":null:G;fe=[];for(var z=b,B;z!==null;){B=z;var K=B.stateNode;if(B.tag===5&&K!==null&&(B=K,I!==null&&(K=cn(z,I),K!=null&&fe.push(kn(z,K,B)))),et)break;z=z.return}0<fe.length&&(G=new ae(G,ce,null,n,Z),q.push({event:G,listeners:fe}))}}if((t&7)===0){e:{if(G=e==="mouseover"||e==="pointerover",ae=e==="mouseout"||e==="pointerout",G&&n!==lt&&(ce=n.relatedTarget||n.fromElement)&&(Ri(ce)||ce[Jt]))break e;if((ae||G)&&(G=Z.window===Z?Z:(G=Z.ownerDocument)?G.defaultView||G.parentWindow:window,ae?(ce=n.relatedTarget||n.toElement,ae=b,ce=ce?Ri(ce):null,ce!==null&&(et=Ci(ce),ce!==et||ce.tag!==5&&ce.tag!==6)&&(ce=null)):(ae=null,ce=b),ae!==ce)){if(fe=Ra,K="onMouseLeave",I="onMouseEnter",z="mouse",(e==="pointerout"||e==="pointerover")&&(fe=ka,K="onPointerLeave",I="onPointerEnter",z="pointer"),et=ae==null?G:Zi(ae),B=ce==null?G:Zi(ce),G=new fe(K,z+"leave",ae,n,Z),G.target=et,G.relatedTarget=B,K=null,Ri(Z)===b&&(fe=new fe(I,z+"enter",ce,n,Z),fe.target=B,fe.relatedTarget=et,K=fe),et=K,ae&&ce)t:{for(fe=ae,I=ce,z=0,B=fe;B;B=Vi(B))z++;for(B=0,K=I;K;K=Vi(K))B++;for(;0<z-B;)fe=Vi(fe),z--;for(;0<B-z;)I=Vi(I),B--;for(;z--;){if(fe===I||I!==null&&fe===I.alternate)break t;fe=Vi(fe),I=Vi(I)}fe=null}else fe=null;ae!==null&&il(q,G,ae,fe,!1),ce!==null&&et!==null&&il(q,et,ce,fe,!0)}}e:{if(G=b?Zi(b):window,ae=G.nodeName&&G.nodeName.toLowerCase(),ae==="select"||ae==="input"&&G.type==="file")var me=Yc;else if(Na(G))if(Aa)me=$c;else{me=Kc;var we=Qc}else(ae=G.nodeName)&&ae.toLowerCase()==="input"&&(G.type==="checkbox"||G.type==="radio")&&(me=Jc);if(me&&(me=me(e,b))){Ia(q,me,n,Z);break e}we&&we(e,G,b),e==="focusout"&&(we=G._wrapperState)&&we.controlled&&G.type==="number"&&A(G,"number",G.value)}switch(we=b?Zi(b):window,e){case"focusin":(Na(we)||we.contentEditable==="true")&&(ji=we,Do=b,Cn=null);break;case"focusout":Cn=Do=ji=null;break;case"mousedown":ko=!0;break;case"contextmenu":case"mouseup":case"dragend":ko=!1,Ga(q,n,Z);break;case"selectionchange":if(ih)break;case"keydown":case"keyup":Ga(q,n,Z)}var xe;if(Eo)e:{switch(e){case"compositionstart":var Pe="onCompositionStart";break e;case"compositionend":Pe="onCompositionEnd";break e;case"compositionupdate":Pe="onCompositionUpdate";break e}Pe=void 0}else Ui?Oa(e,n)&&(Pe="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(Pe="onCompositionStart");Pe&&(Fa&&n.locale!=="ko"&&(Ui||Pe!=="onCompositionStart"?Pe==="onCompositionEnd"&&Ui&&(xe=Pa()):(hi=Z,yo="value"in hi?hi.value:hi.textContent,Ui=!0)),we=dr(b,Pe),0<we.length&&(Pe=new Da(Pe,e,null,n,Z),q.push({event:Pe,listeners:we}),xe?Pe.data=xe:(xe=Ma(n),xe!==null&&(Pe.data=xe)))),(xe=Vc?Gc(e,n):Zc(e,n))&&(b=dr(b,"onBeforeInput"),0<b.length&&(Z=new Da("onBeforeInput","beforeinput",null,n,Z),q.push({event:Z,listeners:b}),Z.data=xe))}el(q,t)})}function kn(e,t,n){return{instance:e,listener:t,currentTarget:n}}function dr(e,t){for(var n=t+"Capture",s=[];e!==null;){var c=e,p=c.stateNode;c.tag===5&&p!==null&&(c=p,p=cn(e,n),p!=null&&s.unshift(kn(e,p,c)),p=cn(e,t),p!=null&&s.push(kn(e,p,c))),e=e.return}return s}function Vi(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function il(e,t,n,s,c){for(var p=t._reactName,x=[];n!==null&&n!==s;){var k=n,F=k.alternate,b=k.stateNode;if(F!==null&&F===s)break;k.tag===5&&b!==null&&(k=b,c?(F=cn(n,p),F!=null&&x.unshift(kn(n,F,k))):c||(F=cn(n,p),F!=null&&x.push(kn(n,F,k)))),n=n.return}x.length!==0&&e.push({event:t,listeners:x})}var sh=/\r\n?/g,ah=/\u0000|\uFFFD/g;function nl(e){return(typeof e=="string"?e:""+e).replace(sh,`
`).replace(ah,"")}function fr(e,t,n){if(t=nl(t),nl(e)!==t&&n)throw Error(i(425))}function pr(){}var No=null,Io=null;function Ao(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Bo=typeof setTimeout=="function"?setTimeout:void 0,lh=typeof clearTimeout=="function"?clearTimeout:void 0,rl=typeof Promise=="function"?Promise:void 0,uh=typeof queueMicrotask=="function"?queueMicrotask:typeof rl<"u"?function(e){return rl.resolve(null).then(e).catch(ch)}:Bo;function ch(e){setTimeout(function(){throw e})}function Ho(e,t){var n=t,s=0;do{var c=n.nextSibling;if(e.removeChild(n),c&&c.nodeType===8)if(n=c.data,n==="/$"){if(s===0){e.removeChild(c),wn(t);return}s--}else n!=="$"&&n!=="$?"&&n!=="$!"||s++;n=c}while(n);wn(t)}function fi(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function ol(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Gi=Math.random().toString(36).slice(2),Gt="__reactFiber$"+Gi,Fn="__reactProps$"+Gi,Jt="__reactContainer$"+Gi,bo="__reactEvents$"+Gi,hh="__reactListeners$"+Gi,dh="__reactHandles$"+Gi;function Ri(e){var t=e[Gt];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Jt]||n[Gt]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=ol(e);e!==null;){if(n=e[Gt])return n;e=ol(e)}return t}e=n,n=e.parentNode}return null}function Ln(e){return e=e[Gt]||e[Jt],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Zi(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(i(33))}function gr(e){return e[Fn]||null}var Uo=[],qi=-1;function pi(e){return{current:e}}function Ze(e){0>qi||(e.current=Uo[qi],Uo[qi]=null,qi--)}function Ve(e,t){qi++,Uo[qi]=e.current,e.current=t}var gi={},ht=pi(gi),wt=pi(!1),Di=gi;function Xi(e,t){var n=e.type.contextTypes;if(!n)return gi;var s=e.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===t)return s.__reactInternalMemoizedMaskedChildContext;var c={},p;for(p in n)c[p]=t[p];return s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=c),c}function xt(e){return e=e.childContextTypes,e!=null}function mr(){Ze(wt),Ze(ht)}function sl(e,t,n){if(ht.current!==gi)throw Error(i(168));Ve(ht,t),Ve(wt,n)}function al(e,t,n){var s=e.stateNode;if(t=t.childContextTypes,typeof s.getChildContext!="function")return n;s=s.getChildContext();for(var c in s)if(!(c in t))throw Error(i(108,Ne(e)||"Unknown",c));return oe({},n,s)}function vr(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||gi,Di=ht.current,Ve(ht,e),Ve(wt,wt.current),!0}function ll(e,t,n){var s=e.stateNode;if(!s)throw Error(i(169));n?(e=al(e,t,Di),s.__reactInternalMemoizedMergedChildContext=e,Ze(wt),Ze(ht),Ve(ht,e)):Ze(wt),Ve(wt,n)}var $t=null,yr=!1,jo=!1;function ul(e){$t===null?$t=[e]:$t.push(e)}function fh(e){yr=!0,ul(e)}function mi(){if(!jo&&$t!==null){jo=!0;var e=0,t=Ue;try{var n=$t;for(Ue=1;e<n.length;e++){var s=n[e];do s=s(!0);while(s!==null)}$t=null,yr=!1}catch(c){throw $t!==null&&($t=$t.slice(e+1)),ha(uo,mi),c}finally{Ue=t,jo=!1}}return null}var Yi=[],Qi=0,wr=null,xr=0,kt=[],Ft=0,ki=null,ei=1,ti="";function Fi(e,t){Yi[Qi++]=xr,Yi[Qi++]=wr,wr=e,xr=t}function cl(e,t,n){kt[Ft++]=ei,kt[Ft++]=ti,kt[Ft++]=ki,ki=e;var s=ei;e=ti;var c=32-It(s)-1;s&=~(1<<c),n+=1;var p=32-It(t)+c;if(30<p){var x=c-c%5;p=(s&(1<<x)-1).toString(32),s>>=x,c-=x,ei=1<<32-It(t)+c|n<<c|s,ti=p+e}else ei=1<<p|n<<c|s,ti=e}function Wo(e){e.return!==null&&(Fi(e,1),cl(e,1,0))}function Vo(e){for(;e===wr;)wr=Yi[--Qi],Yi[Qi]=null,xr=Yi[--Qi],Yi[Qi]=null;for(;e===ki;)ki=kt[--Ft],kt[Ft]=null,ti=kt[--Ft],kt[Ft]=null,ei=kt[--Ft],kt[Ft]=null}var Ct=null,Rt=null,qe=!1,Bt=null;function hl(e,t){var n=Mt(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function dl(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Ct=e,Rt=fi(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Ct=e,Rt=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=ki!==null?{id:ei,overflow:ti}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Mt(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Ct=e,Rt=null,!0):!1;default:return!1}}function Go(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Zo(e){if(qe){var t=Rt;if(t){var n=t;if(!dl(e,t)){if(Go(e))throw Error(i(418));t=fi(n.nextSibling);var s=Ct;t&&dl(e,t)?hl(s,n):(e.flags=e.flags&-4097|2,qe=!1,Ct=e)}}else{if(Go(e))throw Error(i(418));e.flags=e.flags&-4097|2,qe=!1,Ct=e}}}function fl(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Ct=e}function Tr(e){if(e!==Ct)return!1;if(!qe)return fl(e),qe=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Ao(e.type,e.memoizedProps)),t&&(t=Rt)){if(Go(e))throw pl(),Error(i(418));for(;t;)hl(e,t),t=fi(t.nextSibling)}if(fl(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(i(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Rt=fi(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Rt=null}}else Rt=Ct?fi(e.stateNode.nextSibling):null;return!0}function pl(){for(var e=Rt;e;)e=fi(e.nextSibling)}function Ki(){Rt=Ct=null,qe=!1}function qo(e){Bt===null?Bt=[e]:Bt.push(e)}var ph=J.ReactCurrentBatchConfig;function zn(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(i(309));var s=n.stateNode}if(!s)throw Error(i(147,e));var c=s,p=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===p?t.ref:(t=function(x){var k=c.refs;x===null?delete k[p]:k[p]=x},t._stringRef=p,t)}if(typeof e!="string")throw Error(i(284));if(!n._owner)throw Error(i(290,e))}return e}function _r(e,t){throw e=Object.prototype.toString.call(t),Error(i(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function gl(e){var t=e._init;return t(e._payload)}function ml(e){function t(I,z){if(e){var B=I.deletions;B===null?(I.deletions=[z],I.flags|=16):B.push(z)}}function n(I,z){if(!e)return null;for(;z!==null;)t(I,z),z=z.sibling;return null}function s(I,z){for(I=new Map;z!==null;)z.key!==null?I.set(z.key,z):I.set(z.index,z),z=z.sibling;return I}function c(I,z){return I=Ei(I,z),I.index=0,I.sibling=null,I}function p(I,z,B){return I.index=B,e?(B=I.alternate,B!==null?(B=B.index,B<z?(I.flags|=2,z):B):(I.flags|=2,z)):(I.flags|=1048576,z)}function x(I){return e&&I.alternate===null&&(I.flags|=2),I}function k(I,z,B,K){return z===null||z.tag!==6?(z=Bs(B,I.mode,K),z.return=I,z):(z=c(z,B),z.return=I,z)}function F(I,z,B,K){var me=B.type;return me===he?Z(I,z,B.props.children,K,B.key):z!==null&&(z.elementType===me||typeof me=="object"&&me!==null&&me.$$typeof===Ce&&gl(me)===z.type)?(K=c(z,B.props),K.ref=zn(I,z,B),K.return=I,K):(K=Zr(B.type,B.key,B.props,null,I.mode,K),K.ref=zn(I,z,B),K.return=I,K)}function b(I,z,B,K){return z===null||z.tag!==4||z.stateNode.containerInfo!==B.containerInfo||z.stateNode.implementation!==B.implementation?(z=Hs(B,I.mode,K),z.return=I,z):(z=c(z,B.children||[]),z.return=I,z)}function Z(I,z,B,K,me){return z===null||z.tag!==7?(z=Bi(B,I.mode,K,me),z.return=I,z):(z=c(z,B),z.return=I,z)}function q(I,z,B){if(typeof z=="string"&&z!==""||typeof z=="number")return z=Bs(""+z,I.mode,B),z.return=I,z;if(typeof z=="object"&&z!==null){switch(z.$$typeof){case Q:return B=Zr(z.type,z.key,z.props,null,I.mode,B),B.ref=zn(I,null,z),B.return=I,B;case ee:return z=Hs(z,I.mode,B),z.return=I,z;case Ce:var K=z._init;return q(I,K(z._payload),B)}if(V(z)||de(z))return z=Bi(z,I.mode,B,null),z.return=I,z;_r(I,z)}return null}function G(I,z,B,K){var me=z!==null?z.key:null;if(typeof B=="string"&&B!==""||typeof B=="number")return me!==null?null:k(I,z,""+B,K);if(typeof B=="object"&&B!==null){switch(B.$$typeof){case Q:return B.key===me?F(I,z,B,K):null;case ee:return B.key===me?b(I,z,B,K):null;case Ce:return me=B._init,G(I,z,me(B._payload),K)}if(V(B)||de(B))return me!==null?null:Z(I,z,B,K,null);_r(I,B)}return null}function ae(I,z,B,K,me){if(typeof K=="string"&&K!==""||typeof K=="number")return I=I.get(B)||null,k(z,I,""+K,me);if(typeof K=="object"&&K!==null){switch(K.$$typeof){case Q:return I=I.get(K.key===null?B:K.key)||null,F(z,I,K,me);case ee:return I=I.get(K.key===null?B:K.key)||null,b(z,I,K,me);case Ce:var we=K._init;return ae(I,z,B,we(K._payload),me)}if(V(K)||de(K))return I=I.get(B)||null,Z(z,I,K,me,null);_r(z,K)}return null}function ce(I,z,B,K){for(var me=null,we=null,xe=z,Pe=z=0,at=null;xe!==null&&Pe<B.length;Pe++){xe.index>Pe?(at=xe,xe=null):at=xe.sibling;var be=G(I,xe,B[Pe],K);if(be===null){xe===null&&(xe=at);break}e&&xe&&be.alternate===null&&t(I,xe),z=p(be,z,Pe),we===null?me=be:we.sibling=be,we=be,xe=at}if(Pe===B.length)return n(I,xe),qe&&Fi(I,Pe),me;if(xe===null){for(;Pe<B.length;Pe++)xe=q(I,B[Pe],K),xe!==null&&(z=p(xe,z,Pe),we===null?me=xe:we.sibling=xe,we=xe);return qe&&Fi(I,Pe),me}for(xe=s(I,xe);Pe<B.length;Pe++)at=ae(xe,I,Pe,B[Pe],K),at!==null&&(e&&at.alternate!==null&&xe.delete(at.key===null?Pe:at.key),z=p(at,z,Pe),we===null?me=at:we.sibling=at,we=at);return e&&xe.forEach(function(Pi){return t(I,Pi)}),qe&&Fi(I,Pe),me}function fe(I,z,B,K){var me=de(B);if(typeof me!="function")throw Error(i(150));if(B=me.call(B),B==null)throw Error(i(151));for(var we=me=null,xe=z,Pe=z=0,at=null,be=B.next();xe!==null&&!be.done;Pe++,be=B.next()){xe.index>Pe?(at=xe,xe=null):at=xe.sibling;var Pi=G(I,xe,be.value,K);if(Pi===null){xe===null&&(xe=at);break}e&&xe&&Pi.alternate===null&&t(I,xe),z=p(Pi,z,Pe),we===null?me=Pi:we.sibling=Pi,we=Pi,xe=at}if(be.done)return n(I,xe),qe&&Fi(I,Pe),me;if(xe===null){for(;!be.done;Pe++,be=B.next())be=q(I,be.value,K),be!==null&&(z=p(be,z,Pe),we===null?me=be:we.sibling=be,we=be);return qe&&Fi(I,Pe),me}for(xe=s(I,xe);!be.done;Pe++,be=B.next())be=ae(xe,I,Pe,be.value,K),be!==null&&(e&&be.alternate!==null&&xe.delete(be.key===null?Pe:be.key),z=p(be,z,Pe),we===null?me=be:we.sibling=be,we=be);return e&&xe.forEach(function(qh){return t(I,qh)}),qe&&Fi(I,Pe),me}function et(I,z,B,K){if(typeof B=="object"&&B!==null&&B.type===he&&B.key===null&&(B=B.props.children),typeof B=="object"&&B!==null){switch(B.$$typeof){case Q:e:{for(var me=B.key,we=z;we!==null;){if(we.key===me){if(me=B.type,me===he){if(we.tag===7){n(I,we.sibling),z=c(we,B.props.children),z.return=I,I=z;break e}}else if(we.elementType===me||typeof me=="object"&&me!==null&&me.$$typeof===Ce&&gl(me)===we.type){n(I,we.sibling),z=c(we,B.props),z.ref=zn(I,we,B),z.return=I,I=z;break e}n(I,we);break}else t(I,we);we=we.sibling}B.type===he?(z=Bi(B.props.children,I.mode,K,B.key),z.return=I,I=z):(K=Zr(B.type,B.key,B.props,null,I.mode,K),K.ref=zn(I,z,B),K.return=I,I=K)}return x(I);case ee:e:{for(we=B.key;z!==null;){if(z.key===we)if(z.tag===4&&z.stateNode.containerInfo===B.containerInfo&&z.stateNode.implementation===B.implementation){n(I,z.sibling),z=c(z,B.children||[]),z.return=I,I=z;break e}else{n(I,z);break}else t(I,z);z=z.sibling}z=Hs(B,I.mode,K),z.return=I,I=z}return x(I);case Ce:return we=B._init,et(I,z,we(B._payload),K)}if(V(B))return ce(I,z,B,K);if(de(B))return fe(I,z,B,K);_r(I,B)}return typeof B=="string"&&B!==""||typeof B=="number"?(B=""+B,z!==null&&z.tag===6?(n(I,z.sibling),z=c(z,B),z.return=I,I=z):(n(I,z),z=Bs(B,I.mode,K),z.return=I,I=z),x(I)):n(I,z)}return et}var Ji=ml(!0),vl=ml(!1),Sr=pi(null),Er=null,$i=null,Xo=null;function Yo(){Xo=$i=Er=null}function Qo(e){var t=Sr.current;Ze(Sr),e._currentValue=t}function Ko(e,t,n){for(;e!==null;){var s=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,s!==null&&(s.childLanes|=t)):s!==null&&(s.childLanes&t)!==t&&(s.childLanes|=t),e===n)break;e=e.return}}function en(e,t){Er=e,Xo=$i=null,e=e.dependencies,e!==null&&e.firstContext!==null&&((e.lanes&t)!==0&&(Tt=!0),e.firstContext=null)}function Lt(e){var t=e._currentValue;if(Xo!==e)if(e={context:e,memoizedValue:t,next:null},$i===null){if(Er===null)throw Error(i(308));$i=e,Er.dependencies={lanes:0,firstContext:e}}else $i=$i.next=e;return t}var Li=null;function Jo(e){Li===null?Li=[e]:Li.push(e)}function yl(e,t,n,s){var c=t.interleaved;return c===null?(n.next=n,Jo(t)):(n.next=c.next,c.next=n),t.interleaved=n,ii(e,s)}function ii(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var vi=!1;function $o(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function wl(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ni(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function yi(e,t,n){var s=e.updateQueue;if(s===null)return null;if(s=s.shared,(Be&2)!==0){var c=s.pending;return c===null?t.next=t:(t.next=c.next,c.next=t),s.pending=t,ii(e,n)}return c=s.interleaved,c===null?(t.next=t,Jo(s)):(t.next=c.next,c.next=t),s.interleaved=t,ii(e,n)}function Pr(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var s=t.lanes;s&=e.pendingLanes,n|=s,t.lanes=n,fo(e,n)}}function xl(e,t){var n=e.updateQueue,s=e.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var c=null,p=null;if(n=n.firstBaseUpdate,n!==null){do{var x={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};p===null?c=p=x:p=p.next=x,n=n.next}while(n!==null);p===null?c=p=t:p=p.next=t}else c=p=t;n={baseState:s.baseState,firstBaseUpdate:c,lastBaseUpdate:p,shared:s.shared,effects:s.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Cr(e,t,n,s){var c=e.updateQueue;vi=!1;var p=c.firstBaseUpdate,x=c.lastBaseUpdate,k=c.shared.pending;if(k!==null){c.shared.pending=null;var F=k,b=F.next;F.next=null,x===null?p=b:x.next=b,x=F;var Z=e.alternate;Z!==null&&(Z=Z.updateQueue,k=Z.lastBaseUpdate,k!==x&&(k===null?Z.firstBaseUpdate=b:k.next=b,Z.lastBaseUpdate=F))}if(p!==null){var q=c.baseState;x=0,Z=b=F=null,k=p;do{var G=k.lane,ae=k.eventTime;if((s&G)===G){Z!==null&&(Z=Z.next={eventTime:ae,lane:0,tag:k.tag,payload:k.payload,callback:k.callback,next:null});e:{var ce=e,fe=k;switch(G=t,ae=n,fe.tag){case 1:if(ce=fe.payload,typeof ce=="function"){q=ce.call(ae,q,G);break e}q=ce;break e;case 3:ce.flags=ce.flags&-65537|128;case 0:if(ce=fe.payload,G=typeof ce=="function"?ce.call(ae,q,G):ce,G==null)break e;q=oe({},q,G);break e;case 2:vi=!0}}k.callback!==null&&k.lane!==0&&(e.flags|=64,G=c.effects,G===null?c.effects=[k]:G.push(k))}else ae={eventTime:ae,lane:G,tag:k.tag,payload:k.payload,callback:k.callback,next:null},Z===null?(b=Z=ae,F=q):Z=Z.next=ae,x|=G;if(k=k.next,k===null){if(k=c.shared.pending,k===null)break;G=k,k=G.next,G.next=null,c.lastBaseUpdate=G,c.shared.pending=null}}while(!0);if(Z===null&&(F=q),c.baseState=F,c.firstBaseUpdate=b,c.lastBaseUpdate=Z,t=c.shared.interleaved,t!==null){c=t;do x|=c.lane,c=c.next;while(c!==t)}else p===null&&(c.shared.lanes=0);Mi|=x,e.lanes=x,e.memoizedState=q}}function Tl(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var s=e[t],c=s.callback;if(c!==null){if(s.callback=null,s=n,typeof c!="function")throw Error(i(191,c));c.call(s)}}}var On={},Zt=pi(On),Mn=pi(On),Nn=pi(On);function zi(e){if(e===On)throw Error(i(174));return e}function es(e,t){switch(Ve(Nn,t),Ve(Mn,e),Ve(Zt,On),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:_e(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=_e(t,e)}Ze(Zt),Ve(Zt,t)}function tn(){Ze(Zt),Ze(Mn),Ze(Nn)}function _l(e){zi(Nn.current);var t=zi(Zt.current),n=_e(t,e.type);t!==n&&(Ve(Mn,e),Ve(Zt,n))}function ts(e){Mn.current===e&&(Ze(Zt),Ze(Mn))}var Xe=pi(0);function Rr(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var is=[];function ns(){for(var e=0;e<is.length;e++)is[e]._workInProgressVersionPrimary=null;is.length=0}var Dr=J.ReactCurrentDispatcher,rs=J.ReactCurrentBatchConfig,Oi=0,Ye=null,it=null,ot=null,kr=!1,In=!1,An=0,gh=0;function dt(){throw Error(i(321))}function os(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!At(e[n],t[n]))return!1;return!0}function ss(e,t,n,s,c,p){if(Oi=p,Ye=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Dr.current=e===null||e.memoizedState===null?wh:xh,e=n(s,c),In){p=0;do{if(In=!1,An=0,25<=p)throw Error(i(301));p+=1,ot=it=null,t.updateQueue=null,Dr.current=Th,e=n(s,c)}while(In)}if(Dr.current=zr,t=it!==null&&it.next!==null,Oi=0,ot=it=Ye=null,kr=!1,t)throw Error(i(300));return e}function as(){var e=An!==0;return An=0,e}function qt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ot===null?Ye.memoizedState=ot=e:ot=ot.next=e,ot}function zt(){if(it===null){var e=Ye.alternate;e=e!==null?e.memoizedState:null}else e=it.next;var t=ot===null?Ye.memoizedState:ot.next;if(t!==null)ot=t,it=e;else{if(e===null)throw Error(i(310));it=e,e={memoizedState:it.memoizedState,baseState:it.baseState,baseQueue:it.baseQueue,queue:it.queue,next:null},ot===null?Ye.memoizedState=ot=e:ot=ot.next=e}return ot}function Bn(e,t){return typeof t=="function"?t(e):t}function ls(e){var t=zt(),n=t.queue;if(n===null)throw Error(i(311));n.lastRenderedReducer=e;var s=it,c=s.baseQueue,p=n.pending;if(p!==null){if(c!==null){var x=c.next;c.next=p.next,p.next=x}s.baseQueue=c=p,n.pending=null}if(c!==null){p=c.next,s=s.baseState;var k=x=null,F=null,b=p;do{var Z=b.lane;if((Oi&Z)===Z)F!==null&&(F=F.next={lane:0,action:b.action,hasEagerState:b.hasEagerState,eagerState:b.eagerState,next:null}),s=b.hasEagerState?b.eagerState:e(s,b.action);else{var q={lane:Z,action:b.action,hasEagerState:b.hasEagerState,eagerState:b.eagerState,next:null};F===null?(k=F=q,x=s):F=F.next=q,Ye.lanes|=Z,Mi|=Z}b=b.next}while(b!==null&&b!==p);F===null?x=s:F.next=k,At(s,t.memoizedState)||(Tt=!0),t.memoizedState=s,t.baseState=x,t.baseQueue=F,n.lastRenderedState=s}if(e=n.interleaved,e!==null){c=e;do p=c.lane,Ye.lanes|=p,Mi|=p,c=c.next;while(c!==e)}else c===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function us(e){var t=zt(),n=t.queue;if(n===null)throw Error(i(311));n.lastRenderedReducer=e;var s=n.dispatch,c=n.pending,p=t.memoizedState;if(c!==null){n.pending=null;var x=c=c.next;do p=e(p,x.action),x=x.next;while(x!==c);At(p,t.memoizedState)||(Tt=!0),t.memoizedState=p,t.baseQueue===null&&(t.baseState=p),n.lastRenderedState=p}return[p,s]}function Sl(){}function El(e,t){var n=Ye,s=zt(),c=t(),p=!At(s.memoizedState,c);if(p&&(s.memoizedState=c,Tt=!0),s=s.queue,cs(Rl.bind(null,n,s,e),[e]),s.getSnapshot!==t||p||ot!==null&&ot.memoizedState.tag&1){if(n.flags|=2048,Hn(9,Cl.bind(null,n,s,c,t),void 0,null),st===null)throw Error(i(349));(Oi&30)!==0||Pl(n,t,c)}return c}function Pl(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Ye.updateQueue,t===null?(t={lastEffect:null,stores:null},Ye.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Cl(e,t,n,s){t.value=n,t.getSnapshot=s,Dl(t)&&kl(e)}function Rl(e,t,n){return n(function(){Dl(t)&&kl(e)})}function Dl(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!At(e,n)}catch{return!0}}function kl(e){var t=ii(e,1);t!==null&&jt(t,e,1,-1)}function Fl(e){var t=qt();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Bn,lastRenderedState:e},t.queue=e,e=e.dispatch=yh.bind(null,Ye,e),[t.memoizedState,e]}function Hn(e,t,n,s){return e={tag:e,create:t,destroy:n,deps:s,next:null},t=Ye.updateQueue,t===null?(t={lastEffect:null,stores:null},Ye.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(s=n.next,n.next=e,e.next=s,t.lastEffect=e)),e}function Ll(){return zt().memoizedState}function Fr(e,t,n,s){var c=qt();Ye.flags|=e,c.memoizedState=Hn(1|t,n,void 0,s===void 0?null:s)}function Lr(e,t,n,s){var c=zt();s=s===void 0?null:s;var p=void 0;if(it!==null){var x=it.memoizedState;if(p=x.destroy,s!==null&&os(s,x.deps)){c.memoizedState=Hn(t,n,p,s);return}}Ye.flags|=e,c.memoizedState=Hn(1|t,n,p,s)}function zl(e,t){return Fr(8390656,8,e,t)}function cs(e,t){return Lr(2048,8,e,t)}function Ol(e,t){return Lr(4,2,e,t)}function Ml(e,t){return Lr(4,4,e,t)}function Nl(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Il(e,t,n){return n=n!=null?n.concat([e]):null,Lr(4,4,Nl.bind(null,t,e),n)}function hs(){}function Al(e,t){var n=zt();t=t===void 0?null:t;var s=n.memoizedState;return s!==null&&t!==null&&os(t,s[1])?s[0]:(n.memoizedState=[e,t],e)}function Bl(e,t){var n=zt();t=t===void 0?null:t;var s=n.memoizedState;return s!==null&&t!==null&&os(t,s[1])?s[0]:(e=e(),n.memoizedState=[e,t],e)}function Hl(e,t,n){return(Oi&21)===0?(e.baseState&&(e.baseState=!1,Tt=!0),e.memoizedState=n):(At(n,t)||(n=ga(),Ye.lanes|=n,Mi|=n,e.baseState=!0),t)}function mh(e,t){var n=Ue;Ue=n!==0&&4>n?n:4,e(!0);var s=rs.transition;rs.transition={};try{e(!1),t()}finally{Ue=n,rs.transition=s}}function bl(){return zt().memoizedState}function vh(e,t,n){var s=_i(e);if(n={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null},Ul(e))jl(t,n);else if(n=yl(e,t,n,s),n!==null){var c=mt();jt(n,e,s,c),Wl(n,t,s)}}function yh(e,t,n){var s=_i(e),c={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null};if(Ul(e))jl(t,c);else{var p=e.alternate;if(e.lanes===0&&(p===null||p.lanes===0)&&(p=t.lastRenderedReducer,p!==null))try{var x=t.lastRenderedState,k=p(x,n);if(c.hasEagerState=!0,c.eagerState=k,At(k,x)){var F=t.interleaved;F===null?(c.next=c,Jo(t)):(c.next=F.next,F.next=c),t.interleaved=c;return}}catch{}finally{}n=yl(e,t,c,s),n!==null&&(c=mt(),jt(n,e,s,c),Wl(n,t,s))}}function Ul(e){var t=e.alternate;return e===Ye||t!==null&&t===Ye}function jl(e,t){In=kr=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Wl(e,t,n){if((n&4194240)!==0){var s=t.lanes;s&=e.pendingLanes,n|=s,t.lanes=n,fo(e,n)}}var zr={readContext:Lt,useCallback:dt,useContext:dt,useEffect:dt,useImperativeHandle:dt,useInsertionEffect:dt,useLayoutEffect:dt,useMemo:dt,useReducer:dt,useRef:dt,useState:dt,useDebugValue:dt,useDeferredValue:dt,useTransition:dt,useMutableSource:dt,useSyncExternalStore:dt,useId:dt,unstable_isNewReconciler:!1},wh={readContext:Lt,useCallback:function(e,t){return qt().memoizedState=[e,t===void 0?null:t],e},useContext:Lt,useEffect:zl,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Fr(4194308,4,Nl.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Fr(4194308,4,e,t)},useInsertionEffect:function(e,t){return Fr(4,2,e,t)},useMemo:function(e,t){var n=qt();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var s=qt();return t=n!==void 0?n(t):t,s.memoizedState=s.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},s.queue=e,e=e.dispatch=vh.bind(null,Ye,e),[s.memoizedState,e]},useRef:function(e){var t=qt();return e={current:e},t.memoizedState=e},useState:Fl,useDebugValue:hs,useDeferredValue:function(e){return qt().memoizedState=e},useTransition:function(){var e=Fl(!1),t=e[0];return e=mh.bind(null,e[1]),qt().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var s=Ye,c=qt();if(qe){if(n===void 0)throw Error(i(407));n=n()}else{if(n=t(),st===null)throw Error(i(349));(Oi&30)!==0||Pl(s,t,n)}c.memoizedState=n;var p={value:n,getSnapshot:t};return c.queue=p,zl(Rl.bind(null,s,p,e),[e]),s.flags|=2048,Hn(9,Cl.bind(null,s,p,n,t),void 0,null),n},useId:function(){var e=qt(),t=st.identifierPrefix;if(qe){var n=ti,s=ei;n=(s&~(1<<32-It(s)-1)).toString(32)+n,t=":"+t+"R"+n,n=An++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=gh++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},xh={readContext:Lt,useCallback:Al,useContext:Lt,useEffect:cs,useImperativeHandle:Il,useInsertionEffect:Ol,useLayoutEffect:Ml,useMemo:Bl,useReducer:ls,useRef:Ll,useState:function(){return ls(Bn)},useDebugValue:hs,useDeferredValue:function(e){var t=zt();return Hl(t,it.memoizedState,e)},useTransition:function(){var e=ls(Bn)[0],t=zt().memoizedState;return[e,t]},useMutableSource:Sl,useSyncExternalStore:El,useId:bl,unstable_isNewReconciler:!1},Th={readContext:Lt,useCallback:Al,useContext:Lt,useEffect:cs,useImperativeHandle:Il,useInsertionEffect:Ol,useLayoutEffect:Ml,useMemo:Bl,useReducer:us,useRef:Ll,useState:function(){return us(Bn)},useDebugValue:hs,useDeferredValue:function(e){var t=zt();return it===null?t.memoizedState=e:Hl(t,it.memoizedState,e)},useTransition:function(){var e=us(Bn)[0],t=zt().memoizedState;return[e,t]},useMutableSource:Sl,useSyncExternalStore:El,useId:bl,unstable_isNewReconciler:!1};function Ht(e,t){if(e&&e.defaultProps){t=oe({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function ds(e,t,n,s){t=e.memoizedState,n=n(s,t),n=n==null?t:oe({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Or={isMounted:function(e){return(e=e._reactInternals)?Ci(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var s=mt(),c=_i(e),p=ni(s,c);p.payload=t,n!=null&&(p.callback=n),t=yi(e,p,c),t!==null&&(jt(t,e,c,s),Pr(t,e,c))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var s=mt(),c=_i(e),p=ni(s,c);p.tag=1,p.payload=t,n!=null&&(p.callback=n),t=yi(e,p,c),t!==null&&(jt(t,e,c,s),Pr(t,e,c))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=mt(),s=_i(e),c=ni(n,s);c.tag=2,t!=null&&(c.callback=t),t=yi(e,c,s),t!==null&&(jt(t,e,s,n),Pr(t,e,s))}};function Vl(e,t,n,s,c,p,x){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(s,p,x):t.prototype&&t.prototype.isPureReactComponent?!Pn(n,s)||!Pn(c,p):!0}function Gl(e,t,n){var s=!1,c=gi,p=t.contextType;return typeof p=="object"&&p!==null?p=Lt(p):(c=xt(t)?Di:ht.current,s=t.contextTypes,p=(s=s!=null)?Xi(e,c):gi),t=new t(n,p),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Or,e.stateNode=t,t._reactInternals=e,s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=c,e.__reactInternalMemoizedMaskedChildContext=p),t}function Zl(e,t,n,s){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,s),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,s),t.state!==e&&Or.enqueueReplaceState(t,t.state,null)}function fs(e,t,n,s){var c=e.stateNode;c.props=n,c.state=e.memoizedState,c.refs={},$o(e);var p=t.contextType;typeof p=="object"&&p!==null?c.context=Lt(p):(p=xt(t)?Di:ht.current,c.context=Xi(e,p)),c.state=e.memoizedState,p=t.getDerivedStateFromProps,typeof p=="function"&&(ds(e,t,p,n),c.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof c.getSnapshotBeforeUpdate=="function"||typeof c.UNSAFE_componentWillMount!="function"&&typeof c.componentWillMount!="function"||(t=c.state,typeof c.componentWillMount=="function"&&c.componentWillMount(),typeof c.UNSAFE_componentWillMount=="function"&&c.UNSAFE_componentWillMount(),t!==c.state&&Or.enqueueReplaceState(c,c.state,null),Cr(e,n,c,s),c.state=e.memoizedState),typeof c.componentDidMount=="function"&&(e.flags|=4194308)}function nn(e,t){try{var n="",s=t;do n+=De(s),s=s.return;while(s);var c=n}catch(p){c=`
Error generating stack: `+p.message+`
`+p.stack}return{value:e,source:t,stack:c,digest:null}}function ps(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function gs(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var _h=typeof WeakMap=="function"?WeakMap:Map;function ql(e,t,n){n=ni(-1,n),n.tag=3,n.payload={element:null};var s=t.value;return n.callback=function(){br||(br=!0,Fs=s),gs(e,t)},n}function Xl(e,t,n){n=ni(-1,n),n.tag=3;var s=e.type.getDerivedStateFromError;if(typeof s=="function"){var c=t.value;n.payload=function(){return s(c)},n.callback=function(){gs(e,t)}}var p=e.stateNode;return p!==null&&typeof p.componentDidCatch=="function"&&(n.callback=function(){gs(e,t),typeof s!="function"&&(xi===null?xi=new Set([this]):xi.add(this));var x=t.stack;this.componentDidCatch(t.value,{componentStack:x!==null?x:""})}),n}function Yl(e,t,n){var s=e.pingCache;if(s===null){s=e.pingCache=new _h;var c=new Set;s.set(t,c)}else c=s.get(t),c===void 0&&(c=new Set,s.set(t,c));c.has(n)||(c.add(n),e=Ih.bind(null,e,t,n),t.then(e,e))}function Ql(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Kl(e,t,n,s,c){return(e.mode&1)===0?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=ni(-1,1),t.tag=2,yi(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=c,e)}var Sh=J.ReactCurrentOwner,Tt=!1;function gt(e,t,n,s){t.child=e===null?vl(t,null,n,s):Ji(t,e.child,n,s)}function Jl(e,t,n,s,c){n=n.render;var p=t.ref;return en(t,c),s=ss(e,t,n,s,p,c),n=as(),e!==null&&!Tt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~c,ri(e,t,c)):(qe&&n&&Wo(t),t.flags|=1,gt(e,t,s,c),t.child)}function $l(e,t,n,s,c){if(e===null){var p=n.type;return typeof p=="function"&&!As(p)&&p.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=p,eu(e,t,p,s,c)):(e=Zr(n.type,null,s,t,t.mode,c),e.ref=t.ref,e.return=t,t.child=e)}if(p=e.child,(e.lanes&c)===0){var x=p.memoizedProps;if(n=n.compare,n=n!==null?n:Pn,n(x,s)&&e.ref===t.ref)return ri(e,t,c)}return t.flags|=1,e=Ei(p,s),e.ref=t.ref,e.return=t,t.child=e}function eu(e,t,n,s,c){if(e!==null){var p=e.memoizedProps;if(Pn(p,s)&&e.ref===t.ref)if(Tt=!1,t.pendingProps=s=p,(e.lanes&c)!==0)(e.flags&131072)!==0&&(Tt=!0);else return t.lanes=e.lanes,ri(e,t,c)}return ms(e,t,n,s,c)}function tu(e,t,n){var s=t.pendingProps,c=s.children,p=e!==null?e.memoizedState:null;if(s.mode==="hidden")if((t.mode&1)===0)t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ve(on,Dt),Dt|=n;else{if((n&1073741824)===0)return e=p!==null?p.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ve(on,Dt),Dt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=p!==null?p.baseLanes:n,Ve(on,Dt),Dt|=s}else p!==null?(s=p.baseLanes|n,t.memoizedState=null):s=n,Ve(on,Dt),Dt|=s;return gt(e,t,c,n),t.child}function iu(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function ms(e,t,n,s,c){var p=xt(n)?Di:ht.current;return p=Xi(t,p),en(t,c),n=ss(e,t,n,s,p,c),s=as(),e!==null&&!Tt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~c,ri(e,t,c)):(qe&&s&&Wo(t),t.flags|=1,gt(e,t,n,c),t.child)}function nu(e,t,n,s,c){if(xt(n)){var p=!0;vr(t)}else p=!1;if(en(t,c),t.stateNode===null)Nr(e,t),Gl(t,n,s),fs(t,n,s,c),s=!0;else if(e===null){var x=t.stateNode,k=t.memoizedProps;x.props=k;var F=x.context,b=n.contextType;typeof b=="object"&&b!==null?b=Lt(b):(b=xt(n)?Di:ht.current,b=Xi(t,b));var Z=n.getDerivedStateFromProps,q=typeof Z=="function"||typeof x.getSnapshotBeforeUpdate=="function";q||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(k!==s||F!==b)&&Zl(t,x,s,b),vi=!1;var G=t.memoizedState;x.state=G,Cr(t,s,x,c),F=t.memoizedState,k!==s||G!==F||wt.current||vi?(typeof Z=="function"&&(ds(t,n,Z,s),F=t.memoizedState),(k=vi||Vl(t,n,k,s,G,F,b))?(q||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(t.flags|=4194308)):(typeof x.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=s,t.memoizedState=F),x.props=s,x.state=F,x.context=b,s=k):(typeof x.componentDidMount=="function"&&(t.flags|=4194308),s=!1)}else{x=t.stateNode,wl(e,t),k=t.memoizedProps,b=t.type===t.elementType?k:Ht(t.type,k),x.props=b,q=t.pendingProps,G=x.context,F=n.contextType,typeof F=="object"&&F!==null?F=Lt(F):(F=xt(n)?Di:ht.current,F=Xi(t,F));var ae=n.getDerivedStateFromProps;(Z=typeof ae=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(k!==q||G!==F)&&Zl(t,x,s,F),vi=!1,G=t.memoizedState,x.state=G,Cr(t,s,x,c);var ce=t.memoizedState;k!==q||G!==ce||wt.current||vi?(typeof ae=="function"&&(ds(t,n,ae,s),ce=t.memoizedState),(b=vi||Vl(t,n,b,s,G,ce,F)||!1)?(Z||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(s,ce,F),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(s,ce,F)),typeof x.componentDidUpdate=="function"&&(t.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof x.componentDidUpdate!="function"||k===e.memoizedProps&&G===e.memoizedState||(t.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||k===e.memoizedProps&&G===e.memoizedState||(t.flags|=1024),t.memoizedProps=s,t.memoizedState=ce),x.props=s,x.state=ce,x.context=F,s=b):(typeof x.componentDidUpdate!="function"||k===e.memoizedProps&&G===e.memoizedState||(t.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||k===e.memoizedProps&&G===e.memoizedState||(t.flags|=1024),s=!1)}return vs(e,t,n,s,p,c)}function vs(e,t,n,s,c,p){iu(e,t);var x=(t.flags&128)!==0;if(!s&&!x)return c&&ll(t,n,!1),ri(e,t,p);s=t.stateNode,Sh.current=t;var k=x&&typeof n.getDerivedStateFromError!="function"?null:s.render();return t.flags|=1,e!==null&&x?(t.child=Ji(t,e.child,null,p),t.child=Ji(t,null,k,p)):gt(e,t,k,p),t.memoizedState=s.state,c&&ll(t,n,!0),t.child}function ru(e){var t=e.stateNode;t.pendingContext?sl(e,t.pendingContext,t.pendingContext!==t.context):t.context&&sl(e,t.context,!1),es(e,t.containerInfo)}function ou(e,t,n,s,c){return Ki(),qo(c),t.flags|=256,gt(e,t,n,s),t.child}var ys={dehydrated:null,treeContext:null,retryLane:0};function ws(e){return{baseLanes:e,cachePool:null,transitions:null}}function su(e,t,n){var s=t.pendingProps,c=Xe.current,p=!1,x=(t.flags&128)!==0,k;if((k=x)||(k=e!==null&&e.memoizedState===null?!1:(c&2)!==0),k?(p=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(c|=1),Ve(Xe,c&1),e===null)return Zo(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?((t.mode&1)===0?t.lanes=1:e.data==="$!"?t.lanes=8:t.lanes=1073741824,null):(x=s.children,e=s.fallback,p?(s=t.mode,p=t.child,x={mode:"hidden",children:x},(s&1)===0&&p!==null?(p.childLanes=0,p.pendingProps=x):p=qr(x,s,0,null),e=Bi(e,s,n,null),p.return=t,e.return=t,p.sibling=e,t.child=p,t.child.memoizedState=ws(n),t.memoizedState=ys,e):xs(t,x));if(c=e.memoizedState,c!==null&&(k=c.dehydrated,k!==null))return Eh(e,t,x,s,k,c,n);if(p){p=s.fallback,x=t.mode,c=e.child,k=c.sibling;var F={mode:"hidden",children:s.children};return(x&1)===0&&t.child!==c?(s=t.child,s.childLanes=0,s.pendingProps=F,t.deletions=null):(s=Ei(c,F),s.subtreeFlags=c.subtreeFlags&14680064),k!==null?p=Ei(k,p):(p=Bi(p,x,n,null),p.flags|=2),p.return=t,s.return=t,s.sibling=p,t.child=s,s=p,p=t.child,x=e.child.memoizedState,x=x===null?ws(n):{baseLanes:x.baseLanes|n,cachePool:null,transitions:x.transitions},p.memoizedState=x,p.childLanes=e.childLanes&~n,t.memoizedState=ys,s}return p=e.child,e=p.sibling,s=Ei(p,{mode:"visible",children:s.children}),(t.mode&1)===0&&(s.lanes=n),s.return=t,s.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=s,t.memoizedState=null,s}function xs(e,t){return t=qr({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Mr(e,t,n,s){return s!==null&&qo(s),Ji(t,e.child,null,n),e=xs(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Eh(e,t,n,s,c,p,x){if(n)return t.flags&256?(t.flags&=-257,s=ps(Error(i(422))),Mr(e,t,x,s)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(p=s.fallback,c=t.mode,s=qr({mode:"visible",children:s.children},c,0,null),p=Bi(p,c,x,null),p.flags|=2,s.return=t,p.return=t,s.sibling=p,t.child=s,(t.mode&1)!==0&&Ji(t,e.child,null,x),t.child.memoizedState=ws(x),t.memoizedState=ys,p);if((t.mode&1)===0)return Mr(e,t,x,null);if(c.data==="$!"){if(s=c.nextSibling&&c.nextSibling.dataset,s)var k=s.dgst;return s=k,p=Error(i(419)),s=ps(p,s,void 0),Mr(e,t,x,s)}if(k=(x&e.childLanes)!==0,Tt||k){if(s=st,s!==null){switch(x&-x){case 4:c=2;break;case 16:c=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:c=32;break;case 536870912:c=268435456;break;default:c=0}c=(c&(s.suspendedLanes|x))!==0?0:c,c!==0&&c!==p.retryLane&&(p.retryLane=c,ii(e,c),jt(s,e,c,-1))}return Is(),s=ps(Error(i(421))),Mr(e,t,x,s)}return c.data==="$?"?(t.flags|=128,t.child=e.child,t=Ah.bind(null,e),c._reactRetry=t,null):(e=p.treeContext,Rt=fi(c.nextSibling),Ct=t,qe=!0,Bt=null,e!==null&&(kt[Ft++]=ei,kt[Ft++]=ti,kt[Ft++]=ki,ei=e.id,ti=e.overflow,ki=t),t=xs(t,s.children),t.flags|=4096,t)}function au(e,t,n){e.lanes|=t;var s=e.alternate;s!==null&&(s.lanes|=t),Ko(e.return,t,n)}function Ts(e,t,n,s,c){var p=e.memoizedState;p===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:c}:(p.isBackwards=t,p.rendering=null,p.renderingStartTime=0,p.last=s,p.tail=n,p.tailMode=c)}function lu(e,t,n){var s=t.pendingProps,c=s.revealOrder,p=s.tail;if(gt(e,t,s.children,n),s=Xe.current,(s&2)!==0)s=s&1|2,t.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&au(e,n,t);else if(e.tag===19)au(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}s&=1}if(Ve(Xe,s),(t.mode&1)===0)t.memoizedState=null;else switch(c){case"forwards":for(n=t.child,c=null;n!==null;)e=n.alternate,e!==null&&Rr(e)===null&&(c=n),n=n.sibling;n=c,n===null?(c=t.child,t.child=null):(c=n.sibling,n.sibling=null),Ts(t,!1,c,n,p);break;case"backwards":for(n=null,c=t.child,t.child=null;c!==null;){if(e=c.alternate,e!==null&&Rr(e)===null){t.child=c;break}e=c.sibling,c.sibling=n,n=c,c=e}Ts(t,!0,n,null,p);break;case"together":Ts(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Nr(e,t){(t.mode&1)===0&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ri(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Mi|=t.lanes,(n&t.childLanes)===0)return null;if(e!==null&&t.child!==e.child)throw Error(i(153));if(t.child!==null){for(e=t.child,n=Ei(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Ei(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function Ph(e,t,n){switch(t.tag){case 3:ru(t),Ki();break;case 5:_l(t);break;case 1:xt(t.type)&&vr(t);break;case 4:es(t,t.stateNode.containerInfo);break;case 10:var s=t.type._context,c=t.memoizedProps.value;Ve(Sr,s._currentValue),s._currentValue=c;break;case 13:if(s=t.memoizedState,s!==null)return s.dehydrated!==null?(Ve(Xe,Xe.current&1),t.flags|=128,null):(n&t.child.childLanes)!==0?su(e,t,n):(Ve(Xe,Xe.current&1),e=ri(e,t,n),e!==null?e.sibling:null);Ve(Xe,Xe.current&1);break;case 19:if(s=(n&t.childLanes)!==0,(e.flags&128)!==0){if(s)return lu(e,t,n);t.flags|=128}if(c=t.memoizedState,c!==null&&(c.rendering=null,c.tail=null,c.lastEffect=null),Ve(Xe,Xe.current),s)break;return null;case 22:case 23:return t.lanes=0,tu(e,t,n)}return ri(e,t,n)}var uu,_s,cu,hu;uu=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},_s=function(){},cu=function(e,t,n,s){var c=e.memoizedProps;if(c!==s){e=t.stateNode,zi(Zt.current);var p=null;switch(n){case"input":c=Yt(e,c),s=Yt(e,s),p=[];break;case"select":c=oe({},c,{value:void 0}),s=oe({},s,{value:void 0}),p=[];break;case"textarea":c=ge(e,c),s=ge(e,s),p=[];break;default:typeof c.onClick!="function"&&typeof s.onClick=="function"&&(e.onclick=pr)}Ae(n,s);var x;n=null;for(b in c)if(!s.hasOwnProperty(b)&&c.hasOwnProperty(b)&&c[b]!=null)if(b==="style"){var k=c[b];for(x in k)k.hasOwnProperty(x)&&(n||(n={}),n[x]="")}else b!=="dangerouslySetInnerHTML"&&b!=="children"&&b!=="suppressContentEditableWarning"&&b!=="suppressHydrationWarning"&&b!=="autoFocus"&&(a.hasOwnProperty(b)?p||(p=[]):(p=p||[]).push(b,null));for(b in s){var F=s[b];if(k=c!=null?c[b]:void 0,s.hasOwnProperty(b)&&F!==k&&(F!=null||k!=null))if(b==="style")if(k){for(x in k)!k.hasOwnProperty(x)||F&&F.hasOwnProperty(x)||(n||(n={}),n[x]="");for(x in F)F.hasOwnProperty(x)&&k[x]!==F[x]&&(n||(n={}),n[x]=F[x])}else n||(p||(p=[]),p.push(b,n)),n=F;else b==="dangerouslySetInnerHTML"?(F=F?F.__html:void 0,k=k?k.__html:void 0,F!=null&&k!==F&&(p=p||[]).push(b,F)):b==="children"?typeof F!="string"&&typeof F!="number"||(p=p||[]).push(b,""+F):b!=="suppressContentEditableWarning"&&b!=="suppressHydrationWarning"&&(a.hasOwnProperty(b)?(F!=null&&b==="onScroll"&&Ge("scroll",e),p||k===F||(p=[])):(p=p||[]).push(b,F))}n&&(p=p||[]).push("style",n);var b=p;(t.updateQueue=b)&&(t.flags|=4)}},hu=function(e,t,n,s){n!==s&&(t.flags|=4)};function bn(e,t){if(!qe)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:s.sibling=null}}function ft(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,s=0;if(t)for(var c=e.child;c!==null;)n|=c.lanes|c.childLanes,s|=c.subtreeFlags&14680064,s|=c.flags&14680064,c.return=e,c=c.sibling;else for(c=e.child;c!==null;)n|=c.lanes|c.childLanes,s|=c.subtreeFlags,s|=c.flags,c.return=e,c=c.sibling;return e.subtreeFlags|=s,e.childLanes=n,t}function Ch(e,t,n){var s=t.pendingProps;switch(Vo(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ft(t),null;case 1:return xt(t.type)&&mr(),ft(t),null;case 3:return s=t.stateNode,tn(),Ze(wt),Ze(ht),ns(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(e===null||e.child===null)&&(Tr(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,Bt!==null&&(Os(Bt),Bt=null))),_s(e,t),ft(t),null;case 5:ts(t);var c=zi(Nn.current);if(n=t.type,e!==null&&t.stateNode!=null)cu(e,t,n,s,c),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!s){if(t.stateNode===null)throw Error(i(166));return ft(t),null}if(e=zi(Zt.current),Tr(t)){s=t.stateNode,n=t.type;var p=t.memoizedProps;switch(s[Gt]=t,s[Fn]=p,e=(t.mode&1)!==0,n){case"dialog":Ge("cancel",s),Ge("close",s);break;case"iframe":case"object":case"embed":Ge("load",s);break;case"video":case"audio":for(c=0;c<Rn.length;c++)Ge(Rn[c],s);break;case"source":Ge("error",s);break;case"img":case"image":case"link":Ge("error",s),Ge("load",s);break;case"details":Ge("toggle",s);break;case"input":rt(s,p),Ge("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!p.multiple},Ge("invalid",s);break;case"textarea":W(s,p),Ge("invalid",s)}Ae(n,p),c=null;for(var x in p)if(p.hasOwnProperty(x)){var k=p[x];x==="children"?typeof k=="string"?s.textContent!==k&&(p.suppressHydrationWarning!==!0&&fr(s.textContent,k,e),c=["children",k]):typeof k=="number"&&s.textContent!==""+k&&(p.suppressHydrationWarning!==!0&&fr(s.textContent,k,e),c=["children",""+k]):a.hasOwnProperty(x)&&k!=null&&x==="onScroll"&&Ge("scroll",s)}switch(n){case"input":Nt(s),P(s,p,!0);break;case"textarea":Nt(s),Ie(s);break;case"select":case"option":break;default:typeof p.onClick=="function"&&(s.onclick=pr)}s=c,t.updateQueue=s,s!==null&&(t.flags|=4)}else{x=c.nodeType===9?c:c.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=je(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=x.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof s.is=="string"?e=x.createElement(n,{is:s.is}):(e=x.createElement(n),n==="select"&&(x=e,s.multiple?x.multiple=!0:s.size&&(x.size=s.size))):e=x.createElementNS(e,n),e[Gt]=t,e[Fn]=s,uu(e,t,!1,!1),t.stateNode=e;e:{switch(x=ye(n,s),n){case"dialog":Ge("cancel",e),Ge("close",e),c=s;break;case"iframe":case"object":case"embed":Ge("load",e),c=s;break;case"video":case"audio":for(c=0;c<Rn.length;c++)Ge(Rn[c],e);c=s;break;case"source":Ge("error",e),c=s;break;case"img":case"image":case"link":Ge("error",e),Ge("load",e),c=s;break;case"details":Ge("toggle",e),c=s;break;case"input":rt(e,s),c=Yt(e,s),Ge("invalid",e);break;case"option":c=s;break;case"select":e._wrapperState={wasMultiple:!!s.multiple},c=oe({},s,{value:void 0}),Ge("invalid",e);break;case"textarea":W(e,s),c=ge(e,s),Ge("invalid",e);break;default:c=s}Ae(n,c),k=c;for(p in k)if(k.hasOwnProperty(p)){var F=k[p];p==="style"?X(e,F):p==="dangerouslySetInnerHTML"?(F=F?F.__html:void 0,F!=null&&w(e,F)):p==="children"?typeof F=="string"?(n!=="textarea"||F!=="")&&y(e,F):typeof F=="number"&&y(e,""+F):p!=="suppressContentEditableWarning"&&p!=="suppressHydrationWarning"&&p!=="autoFocus"&&(a.hasOwnProperty(p)?F!=null&&p==="onScroll"&&Ge("scroll",e):F!=null&&N(e,p,F,x))}switch(n){case"input":Nt(e),P(e,s,!1);break;case"textarea":Nt(e),Ie(e);break;case"option":s.value!=null&&e.setAttribute("value",""+ze(s.value));break;case"select":e.multiple=!!s.multiple,p=s.value,p!=null?$(e,!!s.multiple,p,!1):s.defaultValue!=null&&$(e,!!s.multiple,s.defaultValue,!0);break;default:typeof c.onClick=="function"&&(e.onclick=pr)}switch(n){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return ft(t),null;case 6:if(e&&t.stateNode!=null)hu(e,t,e.memoizedProps,s);else{if(typeof s!="string"&&t.stateNode===null)throw Error(i(166));if(n=zi(Nn.current),zi(Zt.current),Tr(t)){if(s=t.stateNode,n=t.memoizedProps,s[Gt]=t,(p=s.nodeValue!==n)&&(e=Ct,e!==null))switch(e.tag){case 3:fr(s.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&fr(s.nodeValue,n,(e.mode&1)!==0)}p&&(t.flags|=4)}else s=(n.nodeType===9?n:n.ownerDocument).createTextNode(s),s[Gt]=t,t.stateNode=s}return ft(t),null;case 13:if(Ze(Xe),s=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(qe&&Rt!==null&&(t.mode&1)!==0&&(t.flags&128)===0)pl(),Ki(),t.flags|=98560,p=!1;else if(p=Tr(t),s!==null&&s.dehydrated!==null){if(e===null){if(!p)throw Error(i(318));if(p=t.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(i(317));p[Gt]=t}else Ki(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;ft(t),p=!1}else Bt!==null&&(Os(Bt),Bt=null),p=!0;if(!p)return t.flags&65536?t:null}return(t.flags&128)!==0?(t.lanes=n,t):(s=s!==null,s!==(e!==null&&e.memoizedState!==null)&&s&&(t.child.flags|=8192,(t.mode&1)!==0&&(e===null||(Xe.current&1)!==0?nt===0&&(nt=3):Is())),t.updateQueue!==null&&(t.flags|=4),ft(t),null);case 4:return tn(),_s(e,t),e===null&&Dn(t.stateNode.containerInfo),ft(t),null;case 10:return Qo(t.type._context),ft(t),null;case 17:return xt(t.type)&&mr(),ft(t),null;case 19:if(Ze(Xe),p=t.memoizedState,p===null)return ft(t),null;if(s=(t.flags&128)!==0,x=p.rendering,x===null)if(s)bn(p,!1);else{if(nt!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(x=Rr(e),x!==null){for(t.flags|=128,bn(p,!1),s=x.updateQueue,s!==null&&(t.updateQueue=s,t.flags|=4),t.subtreeFlags=0,s=n,n=t.child;n!==null;)p=n,e=s,p.flags&=14680066,x=p.alternate,x===null?(p.childLanes=0,p.lanes=e,p.child=null,p.subtreeFlags=0,p.memoizedProps=null,p.memoizedState=null,p.updateQueue=null,p.dependencies=null,p.stateNode=null):(p.childLanes=x.childLanes,p.lanes=x.lanes,p.child=x.child,p.subtreeFlags=0,p.deletions=null,p.memoizedProps=x.memoizedProps,p.memoizedState=x.memoizedState,p.updateQueue=x.updateQueue,p.type=x.type,e=x.dependencies,p.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ve(Xe,Xe.current&1|2),t.child}e=e.sibling}p.tail!==null&&$e()>sn&&(t.flags|=128,s=!0,bn(p,!1),t.lanes=4194304)}else{if(!s)if(e=Rr(x),e!==null){if(t.flags|=128,s=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),bn(p,!0),p.tail===null&&p.tailMode==="hidden"&&!x.alternate&&!qe)return ft(t),null}else 2*$e()-p.renderingStartTime>sn&&n!==1073741824&&(t.flags|=128,s=!0,bn(p,!1),t.lanes=4194304);p.isBackwards?(x.sibling=t.child,t.child=x):(n=p.last,n!==null?n.sibling=x:t.child=x,p.last=x)}return p.tail!==null?(t=p.tail,p.rendering=t,p.tail=t.sibling,p.renderingStartTime=$e(),t.sibling=null,n=Xe.current,Ve(Xe,s?n&1|2:n&1),t):(ft(t),null);case 22:case 23:return Ns(),s=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==s&&(t.flags|=8192),s&&(t.mode&1)!==0?(Dt&1073741824)!==0&&(ft(t),t.subtreeFlags&6&&(t.flags|=8192)):ft(t),null;case 24:return null;case 25:return null}throw Error(i(156,t.tag))}function Rh(e,t){switch(Vo(t),t.tag){case 1:return xt(t.type)&&mr(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return tn(),Ze(wt),Ze(ht),ns(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 5:return ts(t),null;case 13:if(Ze(Xe),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(i(340));Ki()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Ze(Xe),null;case 4:return tn(),null;case 10:return Qo(t.type._context),null;case 22:case 23:return Ns(),null;case 24:return null;default:return null}}var Ir=!1,pt=!1,Dh=typeof WeakSet=="function"?WeakSet:Set,le=null;function rn(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(s){Ke(e,t,s)}else n.current=null}function Ss(e,t,n){try{n()}catch(s){Ke(e,t,s)}}var du=!1;function kh(e,t){if(No=ir,e=Va(),Ro(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var c=s.anchorOffset,p=s.focusNode;s=s.focusOffset;try{n.nodeType,p.nodeType}catch{n=null;break e}var x=0,k=-1,F=-1,b=0,Z=0,q=e,G=null;t:for(;;){for(var ae;q!==n||c!==0&&q.nodeType!==3||(k=x+c),q!==p||s!==0&&q.nodeType!==3||(F=x+s),q.nodeType===3&&(x+=q.nodeValue.length),(ae=q.firstChild)!==null;)G=q,q=ae;for(;;){if(q===e)break t;if(G===n&&++b===c&&(k=x),G===p&&++Z===s&&(F=x),(ae=q.nextSibling)!==null)break;q=G,G=q.parentNode}q=ae}n=k===-1||F===-1?null:{start:k,end:F}}else n=null}n=n||{start:0,end:0}}else n=null;for(Io={focusedElem:e,selectionRange:n},ir=!1,le=t;le!==null;)if(t=le,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,le=e;else for(;le!==null;){t=le;try{var ce=t.alternate;if((t.flags&1024)!==0)switch(t.tag){case 0:case 11:case 15:break;case 1:if(ce!==null){var fe=ce.memoizedProps,et=ce.memoizedState,I=t.stateNode,z=I.getSnapshotBeforeUpdate(t.elementType===t.type?fe:Ht(t.type,fe),et);I.__reactInternalSnapshotBeforeUpdate=z}break;case 3:var B=t.stateNode.containerInfo;B.nodeType===1?B.textContent="":B.nodeType===9&&B.documentElement&&B.removeChild(B.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(i(163))}}catch(K){Ke(t,t.return,K)}if(e=t.sibling,e!==null){e.return=t.return,le=e;break}le=t.return}return ce=du,du=!1,ce}function Un(e,t,n){var s=t.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var c=s=s.next;do{if((c.tag&e)===e){var p=c.destroy;c.destroy=void 0,p!==void 0&&Ss(t,n,p)}c=c.next}while(c!==s)}}function Ar(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var s=n.create;n.destroy=s()}n=n.next}while(n!==t)}}function Es(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function fu(e){var t=e.alternate;t!==null&&(e.alternate=null,fu(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Gt],delete t[Fn],delete t[bo],delete t[hh],delete t[dh])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function pu(e){return e.tag===5||e.tag===3||e.tag===4}function gu(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||pu(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Ps(e,t,n){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=pr));else if(s!==4&&(e=e.child,e!==null))for(Ps(e,t,n),e=e.sibling;e!==null;)Ps(e,t,n),e=e.sibling}function Cs(e,t,n){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(s!==4&&(e=e.child,e!==null))for(Cs(e,t,n),e=e.sibling;e!==null;)Cs(e,t,n),e=e.sibling}var ut=null,bt=!1;function wi(e,t,n){for(n=n.child;n!==null;)mu(e,t,n),n=n.sibling}function mu(e,t,n){if(Vt&&typeof Vt.onCommitFiberUnmount=="function")try{Vt.onCommitFiberUnmount(Qn,n)}catch{}switch(n.tag){case 5:pt||rn(n,t);case 6:var s=ut,c=bt;ut=null,wi(e,t,n),ut=s,bt=c,ut!==null&&(bt?(e=ut,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):ut.removeChild(n.stateNode));break;case 18:ut!==null&&(bt?(e=ut,n=n.stateNode,e.nodeType===8?Ho(e.parentNode,n):e.nodeType===1&&Ho(e,n),wn(e)):Ho(ut,n.stateNode));break;case 4:s=ut,c=bt,ut=n.stateNode.containerInfo,bt=!0,wi(e,t,n),ut=s,bt=c;break;case 0:case 11:case 14:case 15:if(!pt&&(s=n.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){c=s=s.next;do{var p=c,x=p.destroy;p=p.tag,x!==void 0&&((p&2)!==0||(p&4)!==0)&&Ss(n,t,x),c=c.next}while(c!==s)}wi(e,t,n);break;case 1:if(!pt&&(rn(n,t),s=n.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=n.memoizedProps,s.state=n.memoizedState,s.componentWillUnmount()}catch(k){Ke(n,t,k)}wi(e,t,n);break;case 21:wi(e,t,n);break;case 22:n.mode&1?(pt=(s=pt)||n.memoizedState!==null,wi(e,t,n),pt=s):wi(e,t,n);break;default:wi(e,t,n)}}function vu(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new Dh),t.forEach(function(s){var c=Bh.bind(null,e,s);n.has(s)||(n.add(s),s.then(c,c))})}}function Ut(e,t){var n=t.deletions;if(n!==null)for(var s=0;s<n.length;s++){var c=n[s];try{var p=e,x=t,k=x;e:for(;k!==null;){switch(k.tag){case 5:ut=k.stateNode,bt=!1;break e;case 3:ut=k.stateNode.containerInfo,bt=!0;break e;case 4:ut=k.stateNode.containerInfo,bt=!0;break e}k=k.return}if(ut===null)throw Error(i(160));mu(p,x,c),ut=null,bt=!1;var F=c.alternate;F!==null&&(F.return=null),c.return=null}catch(b){Ke(c,t,b)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)yu(t,e),t=t.sibling}function yu(e,t){var n=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Ut(t,e),Xt(e),s&4){try{Un(3,e,e.return),Ar(3,e)}catch(fe){Ke(e,e.return,fe)}try{Un(5,e,e.return)}catch(fe){Ke(e,e.return,fe)}}break;case 1:Ut(t,e),Xt(e),s&512&&n!==null&&rn(n,n.return);break;case 5:if(Ut(t,e),Xt(e),s&512&&n!==null&&rn(n,n.return),e.flags&32){var c=e.stateNode;try{y(c,"")}catch(fe){Ke(e,e.return,fe)}}if(s&4&&(c=e.stateNode,c!=null)){var p=e.memoizedProps,x=n!==null?n.memoizedProps:p,k=e.type,F=e.updateQueue;if(e.updateQueue=null,F!==null)try{k==="input"&&p.type==="radio"&&p.name!=null&&yt(c,p),ye(k,x);var b=ye(k,p);for(x=0;x<F.length;x+=2){var Z=F[x],q=F[x+1];Z==="style"?X(c,q):Z==="dangerouslySetInnerHTML"?w(c,q):Z==="children"?y(c,q):N(c,Z,q,b)}switch(k){case"input":m(c,p);break;case"textarea":Ee(c,p);break;case"select":var G=c._wrapperState.wasMultiple;c._wrapperState.wasMultiple=!!p.multiple;var ae=p.value;ae!=null?$(c,!!p.multiple,ae,!1):G!==!!p.multiple&&(p.defaultValue!=null?$(c,!!p.multiple,p.defaultValue,!0):$(c,!!p.multiple,p.multiple?[]:"",!1))}c[Fn]=p}catch(fe){Ke(e,e.return,fe)}}break;case 6:if(Ut(t,e),Xt(e),s&4){if(e.stateNode===null)throw Error(i(162));c=e.stateNode,p=e.memoizedProps;try{c.nodeValue=p}catch(fe){Ke(e,e.return,fe)}}break;case 3:if(Ut(t,e),Xt(e),s&4&&n!==null&&n.memoizedState.isDehydrated)try{wn(t.containerInfo)}catch(fe){Ke(e,e.return,fe)}break;case 4:Ut(t,e),Xt(e);break;case 13:Ut(t,e),Xt(e),c=e.child,c.flags&8192&&(p=c.memoizedState!==null,c.stateNode.isHidden=p,!p||c.alternate!==null&&c.alternate.memoizedState!==null||(ks=$e())),s&4&&vu(e);break;case 22:if(Z=n!==null&&n.memoizedState!==null,e.mode&1?(pt=(b=pt)||Z,Ut(t,e),pt=b):Ut(t,e),Xt(e),s&8192){if(b=e.memoizedState!==null,(e.stateNode.isHidden=b)&&!Z&&(e.mode&1)!==0)for(le=e,Z=e.child;Z!==null;){for(q=le=Z;le!==null;){switch(G=le,ae=G.child,G.tag){case 0:case 11:case 14:case 15:Un(4,G,G.return);break;case 1:rn(G,G.return);var ce=G.stateNode;if(typeof ce.componentWillUnmount=="function"){s=G,n=G.return;try{t=s,ce.props=t.memoizedProps,ce.state=t.memoizedState,ce.componentWillUnmount()}catch(fe){Ke(s,n,fe)}}break;case 5:rn(G,G.return);break;case 22:if(G.memoizedState!==null){Tu(q);continue}}ae!==null?(ae.return=G,le=ae):Tu(q)}Z=Z.sibling}e:for(Z=null,q=e;;){if(q.tag===5){if(Z===null){Z=q;try{c=q.stateNode,b?(p=c.style,typeof p.setProperty=="function"?p.setProperty("display","none","important"):p.display="none"):(k=q.stateNode,F=q.memoizedProps.style,x=F!=null&&F.hasOwnProperty("display")?F.display:null,k.style.display=U("display",x))}catch(fe){Ke(e,e.return,fe)}}}else if(q.tag===6){if(Z===null)try{q.stateNode.nodeValue=b?"":q.memoizedProps}catch(fe){Ke(e,e.return,fe)}}else if((q.tag!==22&&q.tag!==23||q.memoizedState===null||q===e)&&q.child!==null){q.child.return=q,q=q.child;continue}if(q===e)break e;for(;q.sibling===null;){if(q.return===null||q.return===e)break e;Z===q&&(Z=null),q=q.return}Z===q&&(Z=null),q.sibling.return=q.return,q=q.sibling}}break;case 19:Ut(t,e),Xt(e),s&4&&vu(e);break;case 21:break;default:Ut(t,e),Xt(e)}}function Xt(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(pu(n)){var s=n;break e}n=n.return}throw Error(i(160))}switch(s.tag){case 5:var c=s.stateNode;s.flags&32&&(y(c,""),s.flags&=-33);var p=gu(e);Cs(e,p,c);break;case 3:case 4:var x=s.stateNode.containerInfo,k=gu(e);Ps(e,k,x);break;default:throw Error(i(161))}}catch(F){Ke(e,e.return,F)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Fh(e,t,n){le=e,wu(e)}function wu(e,t,n){for(var s=(e.mode&1)!==0;le!==null;){var c=le,p=c.child;if(c.tag===22&&s){var x=c.memoizedState!==null||Ir;if(!x){var k=c.alternate,F=k!==null&&k.memoizedState!==null||pt;k=Ir;var b=pt;if(Ir=x,(pt=F)&&!b)for(le=c;le!==null;)x=le,F=x.child,x.tag===22&&x.memoizedState!==null?_u(c):F!==null?(F.return=x,le=F):_u(c);for(;p!==null;)le=p,wu(p),p=p.sibling;le=c,Ir=k,pt=b}xu(e)}else(c.subtreeFlags&8772)!==0&&p!==null?(p.return=c,le=p):xu(e)}}function xu(e){for(;le!==null;){var t=le;if((t.flags&8772)!==0){var n=t.alternate;try{if((t.flags&8772)!==0)switch(t.tag){case 0:case 11:case 15:pt||Ar(5,t);break;case 1:var s=t.stateNode;if(t.flags&4&&!pt)if(n===null)s.componentDidMount();else{var c=t.elementType===t.type?n.memoizedProps:Ht(t.type,n.memoizedProps);s.componentDidUpdate(c,n.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var p=t.updateQueue;p!==null&&Tl(t,p,s);break;case 3:var x=t.updateQueue;if(x!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}Tl(t,x,n)}break;case 5:var k=t.stateNode;if(n===null&&t.flags&4){n=k;var F=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":F.autoFocus&&n.focus();break;case"img":F.src&&(n.src=F.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var b=t.alternate;if(b!==null){var Z=b.memoizedState;if(Z!==null){var q=Z.dehydrated;q!==null&&wn(q)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(i(163))}pt||t.flags&512&&Es(t)}catch(G){Ke(t,t.return,G)}}if(t===e){le=null;break}if(n=t.sibling,n!==null){n.return=t.return,le=n;break}le=t.return}}function Tu(e){for(;le!==null;){var t=le;if(t===e){le=null;break}var n=t.sibling;if(n!==null){n.return=t.return,le=n;break}le=t.return}}function _u(e){for(;le!==null;){var t=le;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Ar(4,t)}catch(F){Ke(t,n,F)}break;case 1:var s=t.stateNode;if(typeof s.componentDidMount=="function"){var c=t.return;try{s.componentDidMount()}catch(F){Ke(t,c,F)}}var p=t.return;try{Es(t)}catch(F){Ke(t,p,F)}break;case 5:var x=t.return;try{Es(t)}catch(F){Ke(t,x,F)}}}catch(F){Ke(t,t.return,F)}if(t===e){le=null;break}var k=t.sibling;if(k!==null){k.return=t.return,le=k;break}le=t.return}}var Lh=Math.ceil,Br=J.ReactCurrentDispatcher,Rs=J.ReactCurrentOwner,Ot=J.ReactCurrentBatchConfig,Be=0,st=null,tt=null,ct=0,Dt=0,on=pi(0),nt=0,jn=null,Mi=0,Hr=0,Ds=0,Wn=null,_t=null,ks=0,sn=1/0,oi=null,br=!1,Fs=null,xi=null,Ur=!1,Ti=null,jr=0,Vn=0,Ls=null,Wr=-1,Vr=0;function mt(){return(Be&6)!==0?$e():Wr!==-1?Wr:Wr=$e()}function _i(e){return(e.mode&1)===0?1:(Be&2)!==0&&ct!==0?ct&-ct:ph.transition!==null?(Vr===0&&(Vr=ga()),Vr):(e=Ue,e!==0||(e=window.event,e=e===void 0?16:Ea(e.type)),e)}function jt(e,t,n,s){if(50<Vn)throw Vn=0,Ls=null,Error(i(185));pn(e,n,s),((Be&2)===0||e!==st)&&(e===st&&((Be&2)===0&&(Hr|=n),nt===4&&Si(e,ct)),St(e,s),n===1&&Be===0&&(t.mode&1)===0&&(sn=$e()+500,yr&&mi()))}function St(e,t){var n=e.callbackNode;pc(e,t);var s=$n(e,e===st?ct:0);if(s===0)n!==null&&da(n),e.callbackNode=null,e.callbackPriority=0;else if(t=s&-s,e.callbackPriority!==t){if(n!=null&&da(n),t===1)e.tag===0?fh(Eu.bind(null,e)):ul(Eu.bind(null,e)),uh(function(){(Be&6)===0&&mi()}),n=null;else{switch(ma(s)){case 1:n=uo;break;case 4:n=fa;break;case 16:n=Yn;break;case 536870912:n=pa;break;default:n=Yn}n=zu(n,Su.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Su(e,t){if(Wr=-1,Vr=0,(Be&6)!==0)throw Error(i(327));var n=e.callbackNode;if(an()&&e.callbackNode!==n)return null;var s=$n(e,e===st?ct:0);if(s===0)return null;if((s&30)!==0||(s&e.expiredLanes)!==0||t)t=Gr(e,s);else{t=s;var c=Be;Be|=2;var p=Cu();(st!==e||ct!==t)&&(oi=null,sn=$e()+500,Ii(e,t));do try{Mh();break}catch(k){Pu(e,k)}while(!0);Yo(),Br.current=p,Be=c,tt!==null?t=0:(st=null,ct=0,t=nt)}if(t!==0){if(t===2&&(c=co(e),c!==0&&(s=c,t=zs(e,c))),t===1)throw n=jn,Ii(e,0),Si(e,s),St(e,$e()),n;if(t===6)Si(e,s);else{if(c=e.current.alternate,(s&30)===0&&!zh(c)&&(t=Gr(e,s),t===2&&(p=co(e),p!==0&&(s=p,t=zs(e,p))),t===1))throw n=jn,Ii(e,0),Si(e,s),St(e,$e()),n;switch(e.finishedWork=c,e.finishedLanes=s,t){case 0:case 1:throw Error(i(345));case 2:Ai(e,_t,oi);break;case 3:if(Si(e,s),(s&130023424)===s&&(t=ks+500-$e(),10<t)){if($n(e,0)!==0)break;if(c=e.suspendedLanes,(c&s)!==s){mt(),e.pingedLanes|=e.suspendedLanes&c;break}e.timeoutHandle=Bo(Ai.bind(null,e,_t,oi),t);break}Ai(e,_t,oi);break;case 4:if(Si(e,s),(s&4194240)===s)break;for(t=e.eventTimes,c=-1;0<s;){var x=31-It(s);p=1<<x,x=t[x],x>c&&(c=x),s&=~p}if(s=c,s=$e()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*Lh(s/1960))-s,10<s){e.timeoutHandle=Bo(Ai.bind(null,e,_t,oi),s);break}Ai(e,_t,oi);break;case 5:Ai(e,_t,oi);break;default:throw Error(i(329))}}}return St(e,$e()),e.callbackNode===n?Su.bind(null,e):null}function zs(e,t){var n=Wn;return e.current.memoizedState.isDehydrated&&(Ii(e,t).flags|=256),e=Gr(e,t),e!==2&&(t=_t,_t=n,t!==null&&Os(t)),e}function Os(e){_t===null?_t=e:_t.push.apply(_t,e)}function zh(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var s=0;s<n.length;s++){var c=n[s],p=c.getSnapshot;c=c.value;try{if(!At(p(),c))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Si(e,t){for(t&=~Ds,t&=~Hr,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-It(t),s=1<<n;e[n]=-1,t&=~s}}function Eu(e){if((Be&6)!==0)throw Error(i(327));an();var t=$n(e,0);if((t&1)===0)return St(e,$e()),null;var n=Gr(e,t);if(e.tag!==0&&n===2){var s=co(e);s!==0&&(t=s,n=zs(e,s))}if(n===1)throw n=jn,Ii(e,0),Si(e,t),St(e,$e()),n;if(n===6)throw Error(i(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ai(e,_t,oi),St(e,$e()),null}function Ms(e,t){var n=Be;Be|=1;try{return e(t)}finally{Be=n,Be===0&&(sn=$e()+500,yr&&mi())}}function Ni(e){Ti!==null&&Ti.tag===0&&(Be&6)===0&&an();var t=Be;Be|=1;var n=Ot.transition,s=Ue;try{if(Ot.transition=null,Ue=1,e)return e()}finally{Ue=s,Ot.transition=n,Be=t,(Be&6)===0&&mi()}}function Ns(){Dt=on.current,Ze(on)}function Ii(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,lh(n)),tt!==null)for(n=tt.return;n!==null;){var s=n;switch(Vo(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&mr();break;case 3:tn(),Ze(wt),Ze(ht),ns();break;case 5:ts(s);break;case 4:tn();break;case 13:Ze(Xe);break;case 19:Ze(Xe);break;case 10:Qo(s.type._context);break;case 22:case 23:Ns()}n=n.return}if(st=e,tt=e=Ei(e.current,null),ct=Dt=t,nt=0,jn=null,Ds=Hr=Mi=0,_t=Wn=null,Li!==null){for(t=0;t<Li.length;t++)if(n=Li[t],s=n.interleaved,s!==null){n.interleaved=null;var c=s.next,p=n.pending;if(p!==null){var x=p.next;p.next=c,s.next=x}n.pending=s}Li=null}return e}function Pu(e,t){do{var n=tt;try{if(Yo(),Dr.current=zr,kr){for(var s=Ye.memoizedState;s!==null;){var c=s.queue;c!==null&&(c.pending=null),s=s.next}kr=!1}if(Oi=0,ot=it=Ye=null,In=!1,An=0,Rs.current=null,n===null||n.return===null){nt=1,jn=t,tt=null;break}e:{var p=e,x=n.return,k=n,F=t;if(t=ct,k.flags|=32768,F!==null&&typeof F=="object"&&typeof F.then=="function"){var b=F,Z=k,q=Z.tag;if((Z.mode&1)===0&&(q===0||q===11||q===15)){var G=Z.alternate;G?(Z.updateQueue=G.updateQueue,Z.memoizedState=G.memoizedState,Z.lanes=G.lanes):(Z.updateQueue=null,Z.memoizedState=null)}var ae=Ql(x);if(ae!==null){ae.flags&=-257,Kl(ae,x,k,p,t),ae.mode&1&&Yl(p,b,t),t=ae,F=b;var ce=t.updateQueue;if(ce===null){var fe=new Set;fe.add(F),t.updateQueue=fe}else ce.add(F);break e}else{if((t&1)===0){Yl(p,b,t),Is();break e}F=Error(i(426))}}else if(qe&&k.mode&1){var et=Ql(x);if(et!==null){(et.flags&65536)===0&&(et.flags|=256),Kl(et,x,k,p,t),qo(nn(F,k));break e}}p=F=nn(F,k),nt!==4&&(nt=2),Wn===null?Wn=[p]:Wn.push(p),p=x;do{switch(p.tag){case 3:p.flags|=65536,t&=-t,p.lanes|=t;var I=ql(p,F,t);xl(p,I);break e;case 1:k=F;var z=p.type,B=p.stateNode;if((p.flags&128)===0&&(typeof z.getDerivedStateFromError=="function"||B!==null&&typeof B.componentDidCatch=="function"&&(xi===null||!xi.has(B)))){p.flags|=65536,t&=-t,p.lanes|=t;var K=Xl(p,k,t);xl(p,K);break e}}p=p.return}while(p!==null)}Du(n)}catch(me){t=me,tt===n&&n!==null&&(tt=n=n.return);continue}break}while(!0)}function Cu(){var e=Br.current;return Br.current=zr,e===null?zr:e}function Is(){(nt===0||nt===3||nt===2)&&(nt=4),st===null||(Mi&268435455)===0&&(Hr&268435455)===0||Si(st,ct)}function Gr(e,t){var n=Be;Be|=2;var s=Cu();(st!==e||ct!==t)&&(oi=null,Ii(e,t));do try{Oh();break}catch(c){Pu(e,c)}while(!0);if(Yo(),Be=n,Br.current=s,tt!==null)throw Error(i(261));return st=null,ct=0,nt}function Oh(){for(;tt!==null;)Ru(tt)}function Mh(){for(;tt!==null&&!oc();)Ru(tt)}function Ru(e){var t=Lu(e.alternate,e,Dt);e.memoizedProps=e.pendingProps,t===null?Du(e):tt=t,Rs.current=null}function Du(e){var t=e;do{var n=t.alternate;if(e=t.return,(t.flags&32768)===0){if(n=Ch(n,t,Dt),n!==null){tt=n;return}}else{if(n=Rh(n,t),n!==null){n.flags&=32767,tt=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{nt=6,tt=null;return}}if(t=t.sibling,t!==null){tt=t;return}tt=t=e}while(t!==null);nt===0&&(nt=5)}function Ai(e,t,n){var s=Ue,c=Ot.transition;try{Ot.transition=null,Ue=1,Nh(e,t,n,s)}finally{Ot.transition=c,Ue=s}return null}function Nh(e,t,n,s){do an();while(Ti!==null);if((Be&6)!==0)throw Error(i(327));n=e.finishedWork;var c=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(i(177));e.callbackNode=null,e.callbackPriority=0;var p=n.lanes|n.childLanes;if(gc(e,p),e===st&&(tt=st=null,ct=0),(n.subtreeFlags&2064)===0&&(n.flags&2064)===0||Ur||(Ur=!0,zu(Yn,function(){return an(),null})),p=(n.flags&15990)!==0,(n.subtreeFlags&15990)!==0||p){p=Ot.transition,Ot.transition=null;var x=Ue;Ue=1;var k=Be;Be|=4,Rs.current=null,kh(e,n),yu(n,e),th(Io),ir=!!No,Io=No=null,e.current=n,Fh(n),sc(),Be=k,Ue=x,Ot.transition=p}else e.current=n;if(Ur&&(Ur=!1,Ti=e,jr=c),p=e.pendingLanes,p===0&&(xi=null),uc(n.stateNode),St(e,$e()),t!==null)for(s=e.onRecoverableError,n=0;n<t.length;n++)c=t[n],s(c.value,{componentStack:c.stack,digest:c.digest});if(br)throw br=!1,e=Fs,Fs=null,e;return(jr&1)!==0&&e.tag!==0&&an(),p=e.pendingLanes,(p&1)!==0?e===Ls?Vn++:(Vn=0,Ls=e):Vn=0,mi(),null}function an(){if(Ti!==null){var e=ma(jr),t=Ot.transition,n=Ue;try{if(Ot.transition=null,Ue=16>e?16:e,Ti===null)var s=!1;else{if(e=Ti,Ti=null,jr=0,(Be&6)!==0)throw Error(i(331));var c=Be;for(Be|=4,le=e.current;le!==null;){var p=le,x=p.child;if((le.flags&16)!==0){var k=p.deletions;if(k!==null){for(var F=0;F<k.length;F++){var b=k[F];for(le=b;le!==null;){var Z=le;switch(Z.tag){case 0:case 11:case 15:Un(8,Z,p)}var q=Z.child;if(q!==null)q.return=Z,le=q;else for(;le!==null;){Z=le;var G=Z.sibling,ae=Z.return;if(fu(Z),Z===b){le=null;break}if(G!==null){G.return=ae,le=G;break}le=ae}}}var ce=p.alternate;if(ce!==null){var fe=ce.child;if(fe!==null){ce.child=null;do{var et=fe.sibling;fe.sibling=null,fe=et}while(fe!==null)}}le=p}}if((p.subtreeFlags&2064)!==0&&x!==null)x.return=p,le=x;else e:for(;le!==null;){if(p=le,(p.flags&2048)!==0)switch(p.tag){case 0:case 11:case 15:Un(9,p,p.return)}var I=p.sibling;if(I!==null){I.return=p.return,le=I;break e}le=p.return}}var z=e.current;for(le=z;le!==null;){x=le;var B=x.child;if((x.subtreeFlags&2064)!==0&&B!==null)B.return=x,le=B;else e:for(x=z;le!==null;){if(k=le,(k.flags&2048)!==0)try{switch(k.tag){case 0:case 11:case 15:Ar(9,k)}}catch(me){Ke(k,k.return,me)}if(k===x){le=null;break e}var K=k.sibling;if(K!==null){K.return=k.return,le=K;break e}le=k.return}}if(Be=c,mi(),Vt&&typeof Vt.onPostCommitFiberRoot=="function")try{Vt.onPostCommitFiberRoot(Qn,e)}catch{}s=!0}return s}finally{Ue=n,Ot.transition=t}}return!1}function ku(e,t,n){t=nn(n,t),t=ql(e,t,1),e=yi(e,t,1),t=mt(),e!==null&&(pn(e,1,t),St(e,t))}function Ke(e,t,n){if(e.tag===3)ku(e,e,n);else for(;t!==null;){if(t.tag===3){ku(t,e,n);break}else if(t.tag===1){var s=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(xi===null||!xi.has(s))){e=nn(n,e),e=Xl(t,e,1),t=yi(t,e,1),e=mt(),t!==null&&(pn(t,1,e),St(t,e));break}}t=t.return}}function Ih(e,t,n){var s=e.pingCache;s!==null&&s.delete(t),t=mt(),e.pingedLanes|=e.suspendedLanes&n,st===e&&(ct&n)===n&&(nt===4||nt===3&&(ct&130023424)===ct&&500>$e()-ks?Ii(e,0):Ds|=n),St(e,t)}function Fu(e,t){t===0&&((e.mode&1)===0?t=1:(t=Jn,Jn<<=1,(Jn&130023424)===0&&(Jn=4194304)));var n=mt();e=ii(e,t),e!==null&&(pn(e,t,n),St(e,n))}function Ah(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Fu(e,n)}function Bh(e,t){var n=0;switch(e.tag){case 13:var s=e.stateNode,c=e.memoizedState;c!==null&&(n=c.retryLane);break;case 19:s=e.stateNode;break;default:throw Error(i(314))}s!==null&&s.delete(t),Fu(e,n)}var Lu;Lu=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||wt.current)Tt=!0;else{if((e.lanes&n)===0&&(t.flags&128)===0)return Tt=!1,Ph(e,t,n);Tt=(e.flags&131072)!==0}else Tt=!1,qe&&(t.flags&1048576)!==0&&cl(t,xr,t.index);switch(t.lanes=0,t.tag){case 2:var s=t.type;Nr(e,t),e=t.pendingProps;var c=Xi(t,ht.current);en(t,n),c=ss(null,t,s,e,c,n);var p=as();return t.flags|=1,typeof c=="object"&&c!==null&&typeof c.render=="function"&&c.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,xt(s)?(p=!0,vr(t)):p=!1,t.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,$o(t),c.updater=Or,t.stateNode=c,c._reactInternals=t,fs(t,s,e,n),t=vs(null,t,s,!0,p,n)):(t.tag=0,qe&&p&&Wo(t),gt(null,t,c,n),t=t.child),t;case 16:s=t.elementType;e:{switch(Nr(e,t),e=t.pendingProps,c=s._init,s=c(s._payload),t.type=s,c=t.tag=bh(s),e=Ht(s,e),c){case 0:t=ms(null,t,s,e,n);break e;case 1:t=nu(null,t,s,e,n);break e;case 11:t=Jl(null,t,s,e,n);break e;case 14:t=$l(null,t,s,Ht(s.type,e),n);break e}throw Error(i(306,s,""))}return t;case 0:return s=t.type,c=t.pendingProps,c=t.elementType===s?c:Ht(s,c),ms(e,t,s,c,n);case 1:return s=t.type,c=t.pendingProps,c=t.elementType===s?c:Ht(s,c),nu(e,t,s,c,n);case 3:e:{if(ru(t),e===null)throw Error(i(387));s=t.pendingProps,p=t.memoizedState,c=p.element,wl(e,t),Cr(t,s,null,n);var x=t.memoizedState;if(s=x.element,p.isDehydrated)if(p={element:s,isDehydrated:!1,cache:x.cache,pendingSuspenseBoundaries:x.pendingSuspenseBoundaries,transitions:x.transitions},t.updateQueue.baseState=p,t.memoizedState=p,t.flags&256){c=nn(Error(i(423)),t),t=ou(e,t,s,n,c);break e}else if(s!==c){c=nn(Error(i(424)),t),t=ou(e,t,s,n,c);break e}else for(Rt=fi(t.stateNode.containerInfo.firstChild),Ct=t,qe=!0,Bt=null,n=vl(t,null,s,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ki(),s===c){t=ri(e,t,n);break e}gt(e,t,s,n)}t=t.child}return t;case 5:return _l(t),e===null&&Zo(t),s=t.type,c=t.pendingProps,p=e!==null?e.memoizedProps:null,x=c.children,Ao(s,c)?x=null:p!==null&&Ao(s,p)&&(t.flags|=32),iu(e,t),gt(e,t,x,n),t.child;case 6:return e===null&&Zo(t),null;case 13:return su(e,t,n);case 4:return es(t,t.stateNode.containerInfo),s=t.pendingProps,e===null?t.child=Ji(t,null,s,n):gt(e,t,s,n),t.child;case 11:return s=t.type,c=t.pendingProps,c=t.elementType===s?c:Ht(s,c),Jl(e,t,s,c,n);case 7:return gt(e,t,t.pendingProps,n),t.child;case 8:return gt(e,t,t.pendingProps.children,n),t.child;case 12:return gt(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(s=t.type._context,c=t.pendingProps,p=t.memoizedProps,x=c.value,Ve(Sr,s._currentValue),s._currentValue=x,p!==null)if(At(p.value,x)){if(p.children===c.children&&!wt.current){t=ri(e,t,n);break e}}else for(p=t.child,p!==null&&(p.return=t);p!==null;){var k=p.dependencies;if(k!==null){x=p.child;for(var F=k.firstContext;F!==null;){if(F.context===s){if(p.tag===1){F=ni(-1,n&-n),F.tag=2;var b=p.updateQueue;if(b!==null){b=b.shared;var Z=b.pending;Z===null?F.next=F:(F.next=Z.next,Z.next=F),b.pending=F}}p.lanes|=n,F=p.alternate,F!==null&&(F.lanes|=n),Ko(p.return,n,t),k.lanes|=n;break}F=F.next}}else if(p.tag===10)x=p.type===t.type?null:p.child;else if(p.tag===18){if(x=p.return,x===null)throw Error(i(341));x.lanes|=n,k=x.alternate,k!==null&&(k.lanes|=n),Ko(x,n,t),x=p.sibling}else x=p.child;if(x!==null)x.return=p;else for(x=p;x!==null;){if(x===t){x=null;break}if(p=x.sibling,p!==null){p.return=x.return,x=p;break}x=x.return}p=x}gt(e,t,c.children,n),t=t.child}return t;case 9:return c=t.type,s=t.pendingProps.children,en(t,n),c=Lt(c),s=s(c),t.flags|=1,gt(e,t,s,n),t.child;case 14:return s=t.type,c=Ht(s,t.pendingProps),c=Ht(s.type,c),$l(e,t,s,c,n);case 15:return eu(e,t,t.type,t.pendingProps,n);case 17:return s=t.type,c=t.pendingProps,c=t.elementType===s?c:Ht(s,c),Nr(e,t),t.tag=1,xt(s)?(e=!0,vr(t)):e=!1,en(t,n),Gl(t,s,c),fs(t,s,c,n),vs(null,t,s,!0,e,n);case 19:return lu(e,t,n);case 22:return tu(e,t,n)}throw Error(i(156,t.tag))};function zu(e,t){return ha(e,t)}function Hh(e,t,n,s){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Mt(e,t,n,s){return new Hh(e,t,n,s)}function As(e){return e=e.prototype,!(!e||!e.isReactComponent)}function bh(e){if(typeof e=="function")return As(e)?1:0;if(e!=null){if(e=e.$$typeof,e===re)return 11;if(e===Le)return 14}return 2}function Ei(e,t){var n=e.alternate;return n===null?(n=Mt(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Zr(e,t,n,s,c,p){var x=2;if(s=e,typeof e=="function")As(e)&&(x=1);else if(typeof e=="string")x=5;else e:switch(e){case he:return Bi(n.children,c,p,t);case ie:x=8,c|=8;break;case ue:return e=Mt(12,n,t,c|2),e.elementType=ue,e.lanes=p,e;case Te:return e=Mt(13,n,t,c),e.elementType=Te,e.lanes=p,e;case Me:return e=Mt(19,n,t,c),e.elementType=Me,e.lanes=p,e;case Se:return qr(n,c,p,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case se:x=10;break e;case pe:x=9;break e;case re:x=11;break e;case Le:x=14;break e;case Ce:x=16,s=null;break e}throw Error(i(130,e==null?e:typeof e,""))}return t=Mt(x,n,t,c),t.elementType=e,t.type=s,t.lanes=p,t}function Bi(e,t,n,s){return e=Mt(7,e,s,t),e.lanes=n,e}function qr(e,t,n,s){return e=Mt(22,e,s,t),e.elementType=Se,e.lanes=n,e.stateNode={isHidden:!1},e}function Bs(e,t,n){return e=Mt(6,e,null,t),e.lanes=n,e}function Hs(e,t,n){return t=Mt(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Uh(e,t,n,s,c){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ho(0),this.expirationTimes=ho(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ho(0),this.identifierPrefix=s,this.onRecoverableError=c,this.mutableSourceEagerHydrationData=null}function bs(e,t,n,s,c,p,x,k,F){return e=new Uh(e,t,n,k,F),t===1?(t=1,p===!0&&(t|=8)):t=0,p=Mt(3,null,null,t),e.current=p,p.stateNode=e,p.memoizedState={element:s,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},$o(p),e}function jh(e,t,n){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ee,key:s==null?null:""+s,children:e,containerInfo:t,implementation:n}}function Ou(e){if(!e)return gi;e=e._reactInternals;e:{if(Ci(e)!==e||e.tag!==1)throw Error(i(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(xt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(i(171))}if(e.tag===1){var n=e.type;if(xt(n))return al(e,n,t)}return t}function Mu(e,t,n,s,c,p,x,k,F){return e=bs(n,s,!0,e,c,p,x,k,F),e.context=Ou(null),n=e.current,s=mt(),c=_i(n),p=ni(s,c),p.callback=t??null,yi(n,p,c),e.current.lanes=c,pn(e,c,s),St(e,s),e}function Xr(e,t,n,s){var c=t.current,p=mt(),x=_i(c);return n=Ou(n),t.context===null?t.context=n:t.pendingContext=n,t=ni(p,x),t.payload={element:e},s=s===void 0?null:s,s!==null&&(t.callback=s),e=yi(c,t,x),e!==null&&(jt(e,c,x,p),Pr(e,c,x)),x}function Yr(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Nu(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Us(e,t){Nu(e,t),(e=e.alternate)&&Nu(e,t)}function Wh(){return null}var Iu=typeof reportError=="function"?reportError:function(e){console.error(e)};function js(e){this._internalRoot=e}Qr.prototype.render=js.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(i(409));Xr(e,t,null,null)},Qr.prototype.unmount=js.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Ni(function(){Xr(null,e,null,null)}),t[Jt]=null}};function Qr(e){this._internalRoot=e}Qr.prototype.unstable_scheduleHydration=function(e){if(e){var t=wa();e={blockedOn:null,target:e,priority:t};for(var n=0;n<ci.length&&t!==0&&t<ci[n].priority;n++);ci.splice(n,0,e),n===0&&_a(e)}};function Ws(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Kr(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Au(){}function Vh(e,t,n,s,c){if(c){if(typeof s=="function"){var p=s;s=function(){var b=Yr(x);p.call(b)}}var x=Mu(t,s,e,0,null,!1,!1,"",Au);return e._reactRootContainer=x,e[Jt]=x.current,Dn(e.nodeType===8?e.parentNode:e),Ni(),x}for(;c=e.lastChild;)e.removeChild(c);if(typeof s=="function"){var k=s;s=function(){var b=Yr(F);k.call(b)}}var F=bs(e,0,!1,null,null,!1,!1,"",Au);return e._reactRootContainer=F,e[Jt]=F.current,Dn(e.nodeType===8?e.parentNode:e),Ni(function(){Xr(t,F,n,s)}),F}function Jr(e,t,n,s,c){var p=n._reactRootContainer;if(p){var x=p;if(typeof c=="function"){var k=c;c=function(){var F=Yr(x);k.call(F)}}Xr(t,x,e,c)}else x=Vh(n,t,e,c,s);return Yr(x)}va=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=fn(t.pendingLanes);n!==0&&(fo(t,n|1),St(t,$e()),(Be&6)===0&&(sn=$e()+500,mi()))}break;case 13:Ni(function(){var s=ii(e,1);if(s!==null){var c=mt();jt(s,e,1,c)}}),Us(e,1)}},po=function(e){if(e.tag===13){var t=ii(e,134217728);if(t!==null){var n=mt();jt(t,e,134217728,n)}Us(e,134217728)}},ya=function(e){if(e.tag===13){var t=_i(e),n=ii(e,t);if(n!==null){var s=mt();jt(n,e,t,s)}Us(e,t)}},wa=function(){return Ue},xa=function(e,t){var n=Ue;try{return Ue=e,t()}finally{Ue=n}},Wt=function(e,t,n){switch(t){case"input":if(m(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var s=n[t];if(s!==e&&s.form===e.form){var c=gr(s);if(!c)throw Error(i(90));si(s),m(s,c)}}}break;case"textarea":Ee(e,n);break;case"select":t=n.value,t!=null&&$(e,!!n.multiple,t,!1)}},ra=Ms,oa=Ni;var Gh={usingClientEntryPoint:!1,Events:[Ln,Zi,gr,ia,na,Ms]},Gn={findFiberByHostInstance:Ri,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Zh={bundleType:Gn.bundleType,version:Gn.version,rendererPackageName:Gn.rendererPackageName,rendererConfig:Gn.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:J.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=ua(e),e===null?null:e.stateNode},findFiberByHostInstance:Gn.findFiberByHostInstance||Wh,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var $r=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!$r.isDisabled&&$r.supportsFiber)try{Qn=$r.inject(Zh),Vt=$r}catch{}}return Et.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Gh,Et.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ws(t))throw Error(i(200));return jh(e,t,null,n)},Et.createRoot=function(e,t){if(!Ws(e))throw Error(i(299));var n=!1,s="",c=Iu;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(c=t.onRecoverableError)),t=bs(e,1,!1,null,null,n,!1,s,c),e[Jt]=t.current,Dn(e.nodeType===8?e.parentNode:e),new js(t)},Et.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(i(188)):(e=Object.keys(e).join(","),Error(i(268,e)));return e=ua(t),e=e===null?null:e.stateNode,e},Et.flushSync=function(e){return Ni(e)},Et.hydrate=function(e,t,n){if(!Kr(t))throw Error(i(200));return Jr(null,e,t,!0,n)},Et.hydrateRoot=function(e,t,n){if(!Ws(e))throw Error(i(405));var s=n!=null&&n.hydratedSources||null,c=!1,p="",x=Iu;if(n!=null&&(n.unstable_strictMode===!0&&(c=!0),n.identifierPrefix!==void 0&&(p=n.identifierPrefix),n.onRecoverableError!==void 0&&(x=n.onRecoverableError)),t=Mu(t,null,e,1,n??null,c,!1,p,x),e[Jt]=t.current,Dn(e),s)for(e=0;e<s.length;e++)n=s[e],c=n._getVersion,c=c(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,c]:t.mutableSourceEagerHydrationData.push(n,c);return new Qr(t)},Et.render=function(e,t,n){if(!Kr(t))throw Error(i(200));return Jr(null,e,t,!1,n)},Et.unmountComponentAtNode=function(e){if(!Kr(e))throw Error(i(40));return e._reactRootContainer?(Ni(function(){Jr(null,null,e,!1,function(){e._reactRootContainer=null,e[Jt]=null})}),!0):!1},Et.unstable_batchedUpdates=Ms,Et.unstable_renderSubtreeIntoContainer=function(e,t,n,s){if(!Kr(n))throw Error(i(200));if(e==null||e._reactInternals===void 0)throw Error(i(38));return Jr(e,t,n,!1,s)},Et.version="18.3.1-next-f1338f8080-20240426",Et}var Gu;function ed(){if(Gu)return Zs.exports;Gu=1;function L(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(L)}catch(M){console.error(M)}}return L(),Zs.exports=$h(),Zs.exports}var Zu;function td(){if(Zu)return eo;Zu=1;var L=ed();return eo.createRoot=L.createRoot,eo.hydrateRoot=L.hydrateRoot,eo}var id=td();const nd=Ku(id);var Fe=ta();/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rd=L=>L.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),od=L=>L.replace(/^([A-Z])|[\s-_]+(\w)/g,(M,i,r)=>r?r.toUpperCase():i.toLowerCase()),qu=L=>{const M=od(L);return M.charAt(0).toUpperCase()+M.slice(1)},Ju=(...L)=>L.filter((M,i,r)=>!!M&&M.trim()!==""&&r.indexOf(M)===i).join(" ").trim(),sd=L=>{for(const M in L)if(M.startsWith("aria-")||M==="role"||M==="title")return!0};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var ad={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ld=Fe.forwardRef(({color:L="currentColor",size:M=24,strokeWidth:i=2,absoluteStrokeWidth:r,className:a="",children:o,iconNode:l,...d},u)=>Fe.createElement("svg",{ref:u,...ad,width:M,height:M,stroke:L,strokeWidth:r?Number(i)*24/Number(M):i,className:Ju("lucide",a),...!o&&!sd(d)&&{"aria-hidden":"true"},...d},[...l.map(([h,f])=>Fe.createElement(h,f)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oo=(L,M)=>{const i=Fe.forwardRef(({className:r,...a},o)=>Fe.createElement(ld,{ref:o,iconNode:M,className:Ju(`lucide-${rd(qu(L))}`,`lucide-${L}`,r),...a}));return i.displayName=qu(L),i};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ud=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],cd=oo("circle-question-mark",ud);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hd=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],dd=oo("globe",hd);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fd=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],pd=oo("zoom-in",fd);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gd=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],md=oo("zoom-out",gd);var no={exports:{}},vd=no.exports,Xu;function yd(){return Xu||(Xu=1,(function(L){//! openseadragon 5.0.1
//! Built on 2024-12-09
//! Git commit: v5.0.1-0-480de92d
//! http://openseadragon.github.io
//! License: http://openseadragon.github.io/license/
function M(i){return new M.Viewer(i)}(function(i){i.version={versionStr:"5.0.1",major:parseInt("5",10),minor:parseInt("0",10),revision:parseInt("1",10)};var r={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object AsyncFunction]":"function","[object Promise]":"promise","[object Array]":"array","[object Date]":"date","[object RegExp]":"regexp","[object Object]":"object"},a=Object.prototype.toString,o=Object.prototype.hasOwnProperty;i.isFunction=function(l){return i.type(l)==="function"},i.isArray=Array.isArray||function(l){return i.type(l)==="array"},i.isWindow=function(l){return l&&typeof l=="object"&&"setInterval"in l},i.type=function(l){return l==null?String(l):r[a.call(l)]||"object"},i.isPlainObject=function(l){if(!l||M.type(l)!=="object"||l.nodeType||i.isWindow(l)||l.constructor&&!o.call(l,"constructor")&&!o.call(l.constructor.prototype,"isPrototypeOf"))return!1;var d;for(var u in l)d=u;return d===void 0||o.call(l,d)},i.isEmptyObject=function(l){for(var d in l)return!1;return!0},i.freezeObject=function(l){return Object.freeze?i.freezeObject=Object.freeze:i.freezeObject=function(d){return d},i.freezeObject(l)},i.supportsCanvas=(function(){var l=document.createElement("canvas");return!!(i.isFunction(l.getContext)&&l.getContext("2d"))})(),i.isCanvasTainted=function(l){var d=!1;try{l.getContext("2d").getImageData(0,0,1,1)}catch{d=!0}return d},i.supportsAddEventListener=(function(){return!!(document.documentElement.addEventListener&&document.addEventListener)})(),i.supportsRemoveEventListener=(function(){return!!(document.documentElement.removeEventListener&&document.removeEventListener)})(),i.supportsEventListenerOptions=(function(){var l=0;if(i.supportsAddEventListener)try{var d={get capture(){return l++,!1},get once(){return l++,!1},get passive(){return l++,!1}};window.addEventListener("test",null,d),window.removeEventListener("test",null,d)}catch{l=0}return l>=3})(),i.getCurrentPixelDensityRatio=function(){if(i.supportsCanvas){var l=document.createElement("canvas").getContext("2d"),d=window.devicePixelRatio||1,u=l.webkitBackingStorePixelRatio||l.mozBackingStorePixelRatio||l.msBackingStorePixelRatio||l.oBackingStorePixelRatio||l.backingStorePixelRatio||1;return Math.max(d,1)/u}else return 1},i.pixelDensityRatio=i.getCurrentPixelDensityRatio()})(M),(function(i){i.extend=function(){var u,h,f,g,v,T,E=arguments[0]||{},_=arguments.length,C=!1,D=1;for(typeof E=="boolean"&&(C=E,E=arguments[1]||{},D=2),typeof E!="object"&&!M.isFunction(E)&&(E={}),_===D&&(E=this,--D);D<_;D++)if(u=arguments[D],u!==null||u!==void 0)for(h in u){var H=Object.getOwnPropertyDescriptor(u,h);if(H!==void 0){if(H.get||H.set){Object.defineProperty(E,h,H);continue}g=H.value}else{i.console.warn('Could not copy inherited property "'+h+'".');continue}E!==g&&(C&&g&&(M.isPlainObject(g)||(v=M.isArray(g)))?(f=E[h],v?(v=!1,T=f&&M.isArray(f)?f:[]):T=f&&M.isPlainObject(f)?f:{},E[h]=M.extend(C,T,g)):g!==void 0&&(E[h]=g))}return E};var r=function(){if(typeof navigator!="object")return!1;var u=navigator.userAgent;return typeof u!="string"?!1:u.indexOf("iPhone")!==-1||u.indexOf("iPad")!==-1||u.indexOf("iPod")!==-1};i.extend(i,{DEFAULT_SETTINGS:{xmlPath:null,tileSources:null,tileHost:null,initialPage:0,crossOriginPolicy:!1,ajaxWithCredentials:!1,loadTilesWithAjax:!1,ajaxHeaders:{},splitHashDataForPost:!1,panHorizontal:!0,panVertical:!0,constrainDuringPan:!1,wrapHorizontal:!1,wrapVertical:!1,visibilityRatio:.5,minPixelRatio:.5,defaultZoomLevel:0,minZoomLevel:null,maxZoomLevel:null,homeFillsViewer:!1,clickTimeThreshold:300,clickDistThreshold:5,dblClickTimeThreshold:300,dblClickDistThreshold:20,springStiffness:6.5,animationTime:1.2,gestureSettingsMouse:{dragToPan:!0,scrollToZoom:!0,clickToZoom:!0,dblClickToZoom:!1,dblClickDragToZoom:!1,pinchToZoom:!1,zoomToRefPoint:!0,flickEnabled:!1,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsTouch:{dragToPan:!0,scrollToZoom:!1,clickToZoom:!1,dblClickToZoom:!0,dblClickDragToZoom:!0,pinchToZoom:!0,zoomToRefPoint:!0,flickEnabled:!0,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsPen:{dragToPan:!0,scrollToZoom:!1,clickToZoom:!0,dblClickToZoom:!1,dblClickDragToZoom:!1,pinchToZoom:!1,zoomToRefPoint:!0,flickEnabled:!1,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsUnknown:{dragToPan:!0,scrollToZoom:!1,clickToZoom:!1,dblClickToZoom:!0,dblClickDragToZoom:!1,pinchToZoom:!0,zoomToRefPoint:!0,flickEnabled:!0,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},zoomPerClick:2,zoomPerScroll:1.2,zoomPerDblClickDrag:1.2,zoomPerSecond:1,blendTime:0,alwaysBlend:!1,autoHideControls:!0,immediateRender:!1,minZoomImageRatio:.9,maxZoomPixelRatio:1.1,smoothTileEdgesMinZoom:1.1,iOSDevice:r(),pixelsPerWheelLine:40,pixelsPerArrowPress:40,autoResize:!0,preserveImageSizeOnResize:!1,minScrollDeltaTime:50,rotationIncrement:90,maxTilesPerFrame:1,showSequenceControl:!0,sequenceControlAnchor:null,preserveViewport:!1,preserveOverlays:!1,navPrevNextWrap:!1,showNavigationControl:!0,navigationControlAnchor:null,showZoomControl:!0,showHomeControl:!0,showFullPageControl:!0,showRotationControl:!1,showFlipControl:!1,controlsFadeDelay:2e3,controlsFadeLength:1500,mouseNavEnabled:!0,showNavigator:!1,navigatorElement:null,navigatorId:null,navigatorPosition:null,navigatorSizeRatio:.2,navigatorMaintainSizeRatio:!1,navigatorTop:null,navigatorLeft:null,navigatorHeight:null,navigatorWidth:null,navigatorAutoResize:!0,navigatorAutoFade:!0,navigatorRotate:!0,navigatorBackground:"#000",navigatorOpacity:.8,navigatorBorderColor:"#555",navigatorDisplayRegionColor:"#900",degrees:0,flipped:!1,overlayPreserveContentDirection:!0,opacity:1,compositeOperation:null,drawer:["webgl","canvas","html"],drawerOptions:{webgl:{},canvas:{},html:{},custom:{}},preload:!1,imageSmoothingEnabled:!0,placeholderFillStyle:null,subPixelRoundingForTransparency:null,showReferenceStrip:!1,referenceStripScroll:"horizontal",referenceStripElement:null,referenceStripHeight:null,referenceStripWidth:null,referenceStripPosition:"BOTTOM_LEFT",referenceStripSizeRatio:.2,collectionRows:3,collectionColumns:0,collectionLayout:"horizontal",collectionMode:!1,collectionTileSize:800,collectionTileMargin:80,imageLoaderLimit:0,maxImageCacheCount:200,timeout:3e4,tileRetryMax:0,tileRetryDelay:2500,prefixUrl:"/images/",navImages:{zoomIn:{REST:"zoomin_rest.png",GROUP:"zoomin_grouphover.png",HOVER:"zoomin_hover.png",DOWN:"zoomin_pressed.png"},zoomOut:{REST:"zoomout_rest.png",GROUP:"zoomout_grouphover.png",HOVER:"zoomout_hover.png",DOWN:"zoomout_pressed.png"},home:{REST:"home_rest.png",GROUP:"home_grouphover.png",HOVER:"home_hover.png",DOWN:"home_pressed.png"},fullpage:{REST:"fullpage_rest.png",GROUP:"fullpage_grouphover.png",HOVER:"fullpage_hover.png",DOWN:"fullpage_pressed.png"},rotateleft:{REST:"rotateleft_rest.png",GROUP:"rotateleft_grouphover.png",HOVER:"rotateleft_hover.png",DOWN:"rotateleft_pressed.png"},rotateright:{REST:"rotateright_rest.png",GROUP:"rotateright_grouphover.png",HOVER:"rotateright_hover.png",DOWN:"rotateright_pressed.png"},flip:{REST:"flip_rest.png",GROUP:"flip_grouphover.png",HOVER:"flip_hover.png",DOWN:"flip_pressed.png"},previous:{REST:"previous_rest.png",GROUP:"previous_grouphover.png",HOVER:"previous_hover.png",DOWN:"previous_pressed.png"},next:{REST:"next_rest.png",GROUP:"next_grouphover.png",HOVER:"next_hover.png",DOWN:"next_pressed.png"}},debugMode:!1,debugGridColor:["#437AB2","#1B9E77","#D95F02","#7570B3","#E7298A","#66A61E","#E6AB02","#A6761D","#666666"],silenceMultiImageWarnings:!1},delegate:function(u,h){return function(){var f=arguments;return f===void 0&&(f=[]),h.apply(u,f)}},BROWSERS:{UNKNOWN:0,IE:1,FIREFOX:2,SAFARI:3,CHROME:4,OPERA:5,EDGE:6,CHROMEEDGE:7},SUBPIXEL_ROUNDING_OCCURRENCES:{NEVER:0,ONLY_AT_REST:1,ALWAYS:2},_viewers:new Map,getViewer:function(u){return i._viewers.get(this.getElement(u))},getElement:function(u){return typeof u=="string"&&(u=document.getElementById(u)),u},getElementPosition:function(u){var h=new i.Point,f,g;for(u=i.getElement(u),f=i.getElementStyle(u).position==="fixed",g=d(u,f);g;)h.x+=u.offsetLeft,h.y+=u.offsetTop,f&&(h=h.plus(i.getPageScroll())),u=g,f=i.getElementStyle(u).position==="fixed",g=d(u,f);return h},getElementOffset:function(u){u=i.getElement(u);var h=u&&u.ownerDocument,f,g,v={top:0,left:0};return h?(f=h.documentElement,typeof u.getBoundingClientRect<"u"&&(v=u.getBoundingClientRect()),g=h===h.window?h:h.nodeType===9?h.defaultView||h.parentWindow:!1,new i.Point(v.left+(g.pageXOffset||f.scrollLeft)-(f.clientLeft||0),v.top+(g.pageYOffset||f.scrollTop)-(f.clientTop||0))):new i.Point},getElementSize:function(u){return u=i.getElement(u),new i.Point(u.clientWidth,u.clientHeight)},getElementStyle:document.documentElement.currentStyle?function(u){return u=i.getElement(u),u.currentStyle}:function(u){return u=i.getElement(u),window.getComputedStyle(u,"")},getCssPropertyWithVendorPrefix:function(u){var h={};return i.getCssPropertyWithVendorPrefix=function(f){if(h[f]!==void 0)return h[f];var g=document.createElement("div").style,v=null;if(g[f]!==void 0)v=f;else for(var T=["Webkit","Moz","MS","O","webkit","moz","ms","o"],E=i.capitalizeFirstLetter(f),_=0;_<T.length;_++){var C=T[_]+E;if(g[C]!==void 0){v=C;break}}return h[f]=v,v},i.getCssPropertyWithVendorPrefix(u)},capitalizeFirstLetter:function(u){return u.charAt(0).toUpperCase()+u.slice(1)},positiveModulo:function(u,h){var f=u%h;return f<0&&(f+=h),f},pointInElement:function(u,h){u=i.getElement(u);var f=i.getElementOffset(u),g=i.getElementSize(u);return h.x>=f.x&&h.x<f.x+g.x&&h.y<f.y+g.y&&h.y>=f.y},getMousePosition:function(u){if(typeof u.pageX=="number")i.getMousePosition=function(h){var f=new i.Point;return f.x=h.pageX,f.y=h.pageY,f};else if(typeof u.clientX=="number")i.getMousePosition=function(h){var f=new i.Point;return f.x=h.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,f.y=h.clientY+document.body.scrollTop+document.documentElement.scrollTop,f};else throw new Error("Unknown event mouse position, no known technique.");return i.getMousePosition(u)},getPageScroll:function(){var u=document.documentElement||{},h=document.body||{};if(typeof window.pageXOffset=="number")i.getPageScroll=function(){return new i.Point(window.pageXOffset,window.pageYOffset)};else if(h.scrollLeft||h.scrollTop)i.getPageScroll=function(){return new i.Point(document.body.scrollLeft,document.body.scrollTop)};else if(u.scrollLeft||u.scrollTop)i.getPageScroll=function(){return new i.Point(document.documentElement.scrollLeft,document.documentElement.scrollTop)};else return new i.Point(0,0);return i.getPageScroll()},setPageScroll:function(u){if(typeof window.scrollTo<"u")i.setPageScroll=function(g){window.scrollTo(g.x,g.y)};else{var h=i.getPageScroll();if(h.x===u.x&&h.y===u.y)return;document.body.scrollLeft=u.x,document.body.scrollTop=u.y;var f=i.getPageScroll();if(f.x!==h.x&&f.y!==h.y){i.setPageScroll=function(g){document.body.scrollLeft=g.x,document.body.scrollTop=g.y};return}if(document.documentElement.scrollLeft=u.x,document.documentElement.scrollTop=u.y,f=i.getPageScroll(),f.x!==h.x&&f.y!==h.y){i.setPageScroll=function(g){document.documentElement.scrollLeft=g.x,document.documentElement.scrollTop=g.y};return}i.setPageScroll=function(g){}}i.setPageScroll(u)},getWindowSize:function(){var u=document.documentElement||{},h=document.body||{};if(typeof window.innerWidth=="number")i.getWindowSize=function(){return new i.Point(window.innerWidth,window.innerHeight)};else if(u.clientWidth||u.clientHeight)i.getWindowSize=function(){return new i.Point(document.documentElement.clientWidth,document.documentElement.clientHeight)};else if(h.clientWidth||h.clientHeight)i.getWindowSize=function(){return new i.Point(document.body.clientWidth,document.body.clientHeight)};else throw new Error("Unknown window size, no known technique.");return i.getWindowSize()},makeCenteredNode:function(u){u=i.getElement(u);var h=[i.makeNeutralElement("div"),i.makeNeutralElement("div"),i.makeNeutralElement("div")];return i.extend(h[0].style,{display:"table",height:"100%",width:"100%"}),i.extend(h[1].style,{display:"table-row"}),i.extend(h[2].style,{display:"table-cell",verticalAlign:"middle",textAlign:"center"}),h[0].appendChild(h[1]),h[1].appendChild(h[2]),h[2].appendChild(u),h[0]},makeNeutralElement:function(u){var h=document.createElement(u),f=h.style;return f.background="transparent none",f.border="none",f.margin="0px",f.padding="0px",f.position="static",h},now:function(){return Date.now?i.now=Date.now:i.now=function(){return new Date().getTime()},i.now()},makeTransparentImage:function(u){var h=i.makeNeutralElement("img");return h.src=u,h},setElementOpacity:function(u,h,f){var g,v;u=i.getElement(u),f&&!i.Browser.alpha&&(h=Math.round(h)),i.Browser.opacity?u.style.opacity=h<1?h:"":h<1?(g=Math.round(100*h),v="alpha(opacity="+g+")",u.style.filter=v):u.style.filter=""},setElementTouchActionNone:function(u){u=i.getElement(u),typeof u.style.touchAction<"u"?u.style.touchAction="none":typeof u.style.msTouchAction<"u"&&(u.style.msTouchAction="none")},setElementPointerEvents:function(u,h){u=i.getElement(u),typeof u.style<"u"&&typeof u.style.pointerEvents<"u"&&(u.style.pointerEvents=h)},setElementPointerEventsNone:function(u){i.setElementPointerEvents(u,"none")},addClass:function(u,h){u=i.getElement(u),u.className?(" "+u.className+" ").indexOf(" "+h+" ")===-1&&(u.className+=" "+h):u.className=h},indexOf:function(u,h,f){return Array.prototype.indexOf?this.indexOf=function(g,v,T){return g.indexOf(v,T)}:this.indexOf=function(g,v,T){var E,_=T||0,C;if(!g)throw new TypeError;if(C=g.length,C===0||_>=C)return-1;for(_<0&&(_=C-Math.abs(_)),E=_;E<C;E++)if(g[E]===v)return E;return-1},this.indexOf(u,h,f)},removeClass:function(u,h){var f,g=[],v;for(u=i.getElement(u),f=u.className.split(/\s+/),v=0;v<f.length;v++)f[v]&&f[v]!==h&&g.push(f[v]);u.className=g.join(" ")},normalizeEventListenerOptions:function(u){var h;return typeof u<"u"?typeof u=="boolean"?h=i.supportsEventListenerOptions?{capture:u}:u:h=i.supportsEventListenerOptions?u:typeof u.capture<"u"?u.capture:!1:h=i.supportsEventListenerOptions?{capture:!1}:!1,h},addEvent:(function(){if(i.supportsAddEventListener)return function(u,h,f,g){g=i.normalizeEventListenerOptions(g),u=i.getElement(u),u.addEventListener(h,f,g)};if(document.documentElement.attachEvent&&document.attachEvent)return function(u,h,f){u=i.getElement(u),u.attachEvent("on"+h,f)};throw new Error("No known event model.")})(),removeEvent:(function(){if(i.supportsRemoveEventListener)return function(u,h,f,g){g=i.normalizeEventListenerOptions(g),u=i.getElement(u),u.removeEventListener(h,f,g)};if(document.documentElement.detachEvent&&document.detachEvent)return function(u,h,f){u=i.getElement(u),u.detachEvent("on"+h,f)};throw new Error("No known event model.")})(),cancelEvent:function(u){u.preventDefault()},eventIsCanceled:function(u){return u.defaultPrevented},stopEvent:function(u){u.stopPropagation()},createCallback:function(u,h){console.error("The createCallback function is deprecated and will be removed in future versions. Please use alternativeFunction instead.");var f=[],g;for(g=2;g<arguments.length;g++)f.push(arguments[g]);return function(){var v=f.concat([]),T;for(T=0;T<arguments.length;T++)v.push(arguments[T]);return h.apply(u,v)}},getUrlParameter:function(u){var h=l[u];return h||null},getUrlProtocol:function(u){var h=u.match(/^([a-z]+:)\/\//i);return h===null?window.location.protocol:h[1].toLowerCase()},createAjaxRequest:function(){if(window.XMLHttpRequest)return i.createAjaxRequest=function(){return new XMLHttpRequest},new XMLHttpRequest;throw new Error("Browser doesn't support XMLHttpRequest.")},makeAjaxRequest:function(u,h,f){var g,v,T,E;i.isPlainObject(u)&&(h=u.success,f=u.error,g=u.withCredentials,v=u.headers,T=u.responseType||null,E=u.postData||null,u=u.url);var _=i.getUrlProtocol(u),C=i.createAjaxRequest();if(!i.isFunction(h))throw new Error("makeAjaxRequest requires a success callback");C.onreadystatechange=function(){C.readyState===4&&(C.onreadystatechange=function(){},C.status>=200&&C.status<300||C.status===0&&_!=="http:"&&_!=="https:"?h(C):i.isFunction(f)?f(C):i.console.error("AJAX request returned %d: %s",C.status,u))};var D=E?"POST":"GET";try{if(C.open(D,u,!0),T&&(C.responseType=T),v)for(var H in v)Object.prototype.hasOwnProperty.call(v,H)&&v[H]&&C.setRequestHeader(H,v[H]);g&&(C.withCredentials=!0),C.send(E)}catch(N){i.console.error("%s while making AJAX request: %s",N.name,N.message),C.onreadystatechange=function(){},i.isFunction(f)&&f(C,N)}return C},jsonp:function(u){var h,f=u.url,g=document.head||document.getElementsByTagName("head")[0]||document.documentElement,v=u.callbackName||"openseadragon"+i.now(),T=window[v],E="$1"+v+"$2",_=u.param||"callback",C=u.callback;f=f.replace(/(=)\?(&|$)|\?\?/i,E),f+=(/\?/.test(f)?"&":"?")+_+"="+v,window[v]=function(D){if(T)window[v]=T;else try{delete window[v]}catch{}C&&i.isFunction(C)&&C(D)},h=document.createElement("script"),(u.async!==void 0||u.async!==!1)&&(h.async="async"),u.scriptCharset&&(h.charset=u.scriptCharset),h.src=f,h.onload=h.onreadystatechange=function(D,H){(H||!h.readyState||/loaded|complete/.test(h.readyState))&&(h.onload=h.onreadystatechange=null,g&&h.parentNode&&g.removeChild(h),h=void 0)},g.insertBefore(h,g.firstChild)},createFromDZI:function(){throw"OpenSeadragon.createFromDZI is deprecated, use Viewer.open."},parseXml:function(u){if(window.DOMParser)i.parseXml=function(h){var f=null,g;return g=new DOMParser,f=g.parseFromString(h,"text/xml"),f};else throw new Error("Browser doesn't support XML DOM.");return i.parseXml(u)},parseJSON:function(u){return i.parseJSON=window.JSON.parse,i.parseJSON(u)},imageFormatSupported:function(u){return u=u||"",!!o[u.toLowerCase()]},setImageFormatsSupported:function(u){i.extend(o,u)}});var a=function(u){};i.console=window.console||{log:a,debug:a,info:a,warn:a,error:a,assert:a},i.Browser={vendor:i.BROWSERS.UNKNOWN,version:0,alpha:!0};var o={avif:!0,bmp:!1,jpeg:!0,jpg:!0,png:!0,tif:!1,wdp:!1,webp:!0},l={};(function(){var u=navigator.appVersion,h=navigator.userAgent,f;switch(navigator.appName){case"Microsoft Internet Explorer":window.attachEvent&&window.ActiveXObject&&(i.Browser.vendor=i.BROWSERS.IE,i.Browser.version=parseFloat(h.substring(h.indexOf("MSIE")+5,h.indexOf(";",h.indexOf("MSIE")))));break;case"Netscape":window.addEventListener&&(h.indexOf("Edge")>=0?(i.Browser.vendor=i.BROWSERS.EDGE,i.Browser.version=parseFloat(h.substring(h.indexOf("Edge")+5))):h.indexOf("Edg")>=0?(i.Browser.vendor=i.BROWSERS.CHROMEEDGE,i.Browser.version=parseFloat(h.substring(h.indexOf("Edg")+4))):h.indexOf("Firefox")>=0?(i.Browser.vendor=i.BROWSERS.FIREFOX,i.Browser.version=parseFloat(h.substring(h.indexOf("Firefox")+8))):h.indexOf("Safari")>=0?(i.Browser.vendor=h.indexOf("Chrome")>=0?i.BROWSERS.CHROME:i.BROWSERS.SAFARI,i.Browser.version=parseFloat(h.substring(h.substring(0,h.indexOf("Safari")).lastIndexOf("/")+1,h.indexOf("Safari")))):(f=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})"),f.exec(h)!==null&&(i.Browser.vendor=i.BROWSERS.IE,i.Browser.version=parseFloat(RegExp.$1))));break;case"Opera":i.Browser.vendor=i.BROWSERS.OPERA,i.Browser.version=parseFloat(u);break}var g=window.location.search.substring(1),v=g.split("&"),T,E,_;for(_=0;_<v.length;_++)if(T=v[_],E=T.indexOf("="),E>0){var C=T.substring(0,E),D=T.substring(E+1);try{l[C]=decodeURIComponent(D)}catch{i.console.error("Ignoring malformed URL parameter: %s=%s",C,D)}}i.Browser.alpha=!(i.Browser.vendor===i.BROWSERS.CHROME&&i.Browser.version<2),i.Browser.opacity=!0,i.Browser.vendor===i.BROWSERS.IE&&i.console.error("Internet Explorer is not supported by OpenSeadragon")})(),(function(u){var h=u.requestAnimationFrame||u.mozRequestAnimationFrame||u.webkitRequestAnimationFrame||u.msRequestAnimationFrame,f=u.cancelAnimationFrame||u.mozCancelAnimationFrame||u.webkitCancelAnimationFrame||u.msCancelAnimationFrame;if(h&&f)i.requestAnimationFrame=function(){return h.apply(u,arguments)},i.cancelAnimationFrame=function(){return f.apply(u,arguments)};else{var g=[],v=[],T=0,E;i.requestAnimationFrame=function(_){return g.push([++T,_]),E||(E=setInterval(function(){if(g.length){var C=i.now(),D=v;for(v=g,g=D;v.length;)v.shift()[1](C)}else clearInterval(E),E=void 0},1e3/50)),T},i.cancelAnimationFrame=function(_){var C,D;for(C=0,D=g.length;C<D;C+=1)if(g[C][0]===_){g.splice(C,1);return}for(C=0,D=v.length;C<D;C+=1)if(v[C][0]===_){v.splice(C,1);return}}}})(window);function d(u,h){return h&&u!==document.body?document.body:u.offsetParent}})(M),(function(i,r){L.exports?L.exports=r():i.OpenSeadragon=r()})(vd,function(){return M}),(function(i){class r{constructor(o){o||(o=[0,0,0,0,0,0,0,0,0]),this.values=o}static makeIdentity(){return new r([1,0,0,0,1,0,0,0,1])}static makeTranslation(o,l){return new r([1,0,0,0,1,0,o,l,1])}static makeRotation(o){var l=Math.cos(o),d=Math.sin(o);return new r([l,-d,0,d,l,0,0,0,1])}static makeScaling(o,l){return new r([o,0,0,0,l,0,0,0,1])}multiply(o){let l=this.values,d=o.values;var u=l[0],h=l[1],f=l[2],g=l[3],v=l[4],T=l[5],E=l[6],_=l[7],C=l[8],D=d[0],H=d[1],N=d[2],J=d[3],Q=d[4],ee=d[5],he=d[6],ie=d[7],ue=d[8];return new r([D*u+H*g+N*E,D*h+H*v+N*_,D*f+H*T+N*C,J*u+Q*g+ee*E,J*h+Q*v+ee*_,J*f+Q*T+ee*C,he*u+ie*g+ue*E,he*h+ie*v+ue*_,he*f+ie*T+ue*C])}}i.Mat3=r})(M),(function(i){var r={supportsFullScreen:!1,isFullScreen:function(){return!1},getFullScreenElement:function(){return null},requestFullScreen:function(){},exitFullScreen:function(){},cancelFullScreen:function(){},fullScreenEventName:"",fullScreenErrorEventName:""};document.exitFullscreen?(r.supportsFullScreen=!0,r.getFullScreenElement=function(){return document.fullscreenElement},r.requestFullScreen=function(a){return a.requestFullscreen().catch(function(o){i.console.error("Fullscreen request failed: ",o)})},r.exitFullScreen=function(){document.exitFullscreen().catch(function(a){i.console.error("Error while exiting fullscreen: ",a)})},r.fullScreenEventName="fullscreenchange",r.fullScreenErrorEventName="fullscreenerror"):document.msExitFullscreen?(r.supportsFullScreen=!0,r.getFullScreenElement=function(){return document.msFullscreenElement},r.requestFullScreen=function(a){return a.msRequestFullscreen()},r.exitFullScreen=function(){document.msExitFullscreen()},r.fullScreenEventName="MSFullscreenChange",r.fullScreenErrorEventName="MSFullscreenError"):document.webkitExitFullscreen?(r.supportsFullScreen=!0,r.getFullScreenElement=function(){return document.webkitFullscreenElement},r.requestFullScreen=function(a){return a.webkitRequestFullscreen()},r.exitFullScreen=function(){document.webkitExitFullscreen()},r.fullScreenEventName="webkitfullscreenchange",r.fullScreenErrorEventName="webkitfullscreenerror"):document.webkitCancelFullScreen?(r.supportsFullScreen=!0,r.getFullScreenElement=function(){return document.webkitCurrentFullScreenElement},r.requestFullScreen=function(a){return a.webkitRequestFullScreen()},r.exitFullScreen=function(){document.webkitCancelFullScreen()},r.fullScreenEventName="webkitfullscreenchange",r.fullScreenErrorEventName="webkitfullscreenerror"):document.mozCancelFullScreen&&(r.supportsFullScreen=!0,r.getFullScreenElement=function(){return document.mozFullScreenElement},r.requestFullScreen=function(a){return a.mozRequestFullScreen()},r.exitFullScreen=function(){document.mozCancelFullScreen()},r.fullScreenEventName="mozfullscreenchange",r.fullScreenErrorEventName="mozfullscreenerror"),r.isFullScreen=function(){return r.getFullScreenElement()!==null},r.cancelFullScreen=function(){i.console.error("cancelFullScreen is deprecated. Use exitFullScreen instead."),r.exitFullScreen()},i.extend(i,r)})(M),(function(i){i.EventSource=function(){this.events={},this._rejectedEventList={}},i.EventSource.prototype={addOnceHandler:function(r,a,o,l,d){var u=this;l=l||1;var h=0,f=function(g){return h++,h===l&&u.removeHandler(r,f),a(g)};return this.addHandler(r,f,o,d)},addHandler:function(r,a,o,l){if(Object.prototype.hasOwnProperty.call(this._rejectedEventList,r))return i.console.error(`Error adding handler for ${r}. ${this._rejectedEventList[r]}`),!1;var d=this.events[r];if(d||(this.events[r]=d=[]),a&&i.isFunction(a)){var u=d.length,h={handler:a,userData:o||null,priority:l||0};for(d[u]=h;u>0&&d[u-1].priority<d[u].priority;)d[u]=d[u-1],d[u-1]=h,u--}return!0},removeHandler:function(r,a){var o=this.events[r],l=[],d;if(o&&i.isArray(o)){for(d=0;d<o.length;d++)o[d].handler!==a&&l.push(o[d]);this.events[r]=l}},numberOfHandlers:function(r){var a=this.events[r];return a?a.length:0},removeAllHandlers:function(r){if(r)this.events[r]=[];else for(var a in this.events)this.events[a]=[]},getHandler:function(r){var a=this.events[r];return!a||!a.length?null:(a=a.length===1?[a[0]]:Array.apply(null,a),function(o,l){var d,u=a.length;for(d=0;d<u;d++)a[d]&&(l.eventSource=o,l.userData=a[d].userData,a[d].handler(l))})},raiseEvent:function(r,a){if(Object.prototype.hasOwnProperty.call(this._rejectedEventList,r))return i.console.error(`Error adding handler for ${r}. ${this._rejectedEventList[r]}`),!1;var o=this.getHandler(r);return o&&o(this,a||{}),!0},rejectEventHandler(r,a=""){this._rejectedEventList[r]=a},allowEventHandler(r){delete this._rejectedEventList[r]}}})(M),(function(i){var r={};i.MouseTracker=function(w){var y=arguments;i.isPlainObject(w)||(w={element:y[0],clickTimeThreshold:y[1],clickDistThreshold:y[2]}),this.hash=Math.random(),this.element=i.getElement(w.element),this.clickTimeThreshold=w.clickTimeThreshold||i.DEFAULT_SETTINGS.clickTimeThreshold,this.clickDistThreshold=w.clickDistThreshold||i.DEFAULT_SETTINGS.clickDistThreshold,this.dblClickTimeThreshold=w.dblClickTimeThreshold||i.DEFAULT_SETTINGS.dblClickTimeThreshold,this.dblClickDistThreshold=w.dblClickDistThreshold||i.DEFAULT_SETTINGS.dblClickDistThreshold,this.userData=w.userData||null,this.stopDelay=w.stopDelay||50,this.preProcessEventHandler=w.preProcessEventHandler||null,this.contextMenuHandler=w.contextMenuHandler||null,this.enterHandler=w.enterHandler||null,this.leaveHandler=w.leaveHandler||null,this.exitHandler=w.exitHandler||null,this.overHandler=w.overHandler||null,this.outHandler=w.outHandler||null,this.pressHandler=w.pressHandler||null,this.nonPrimaryPressHandler=w.nonPrimaryPressHandler||null,this.releaseHandler=w.releaseHandler||null,this.nonPrimaryReleaseHandler=w.nonPrimaryReleaseHandler||null,this.moveHandler=w.moveHandler||null,this.scrollHandler=w.scrollHandler||null,this.clickHandler=w.clickHandler||null,this.dblClickHandler=w.dblClickHandler||null,this.dragHandler=w.dragHandler||null,this.dragEndHandler=w.dragEndHandler||null,this.pinchHandler=w.pinchHandler||null,this.stopHandler=w.stopHandler||null,this.keyDownHandler=w.keyDownHandler||null,this.keyUpHandler=w.keyUpHandler||null,this.keyHandler=w.keyHandler||null,this.focusHandler=w.focusHandler||null,this.blurHandler=w.blurHandler||null;var S=this;r[this.hash]={click:function(R){N(S,R)},dblclick:function(R){J(S,R)},keydown:function(R){Q(S,R)},keyup:function(R){ee(S,R)},keypress:function(R){he(S,R)},focus:function(R){ie(S,R)},blur:function(R){ue(S,R)},contextmenu:function(R){se(S,R)},wheel:function(R){pe(S,R)},mousewheel:function(R){re(S,R)},DOMMouseScroll:function(R){re(S,R)},MozMousePixelScroll:function(R){re(S,R)},losecapture:function(R){Me(S,R)},mouseenter:function(R){ne(S,R)},mouseleave:function(R){Re(S,R)},mouseover:function(R){De(S,R)},mouseout:function(R){ke(S,R)},mousedown:function(R){Ne(S,R)},mouseup:function(R){ze(S,R)},mousemove:function(R){Nt(S,R)},touchstart:function(R){Le(S,R)},touchend:function(R){Ce(S,R)},touchmove:function(R){Se(S,R)},touchcancel:function(R){Y(S,R)},gesturestart:function(R){de(S,R)},gesturechange:function(R){oe(S,R)},gotpointercapture:function(R){O(S,R)},lostpointercapture:function(R){j(S,R)},pointerenter:function(R){ne(S,R)},pointerleave:function(R){Re(S,R)},pointerover:function(R){De(S,R)},pointerout:function(R){ke(S,R)},pointerdown:function(R){Ne(S,R)},pointerup:function(R){ze(S,R)},pointermove:function(R){Nt(S,R)},pointercancel:function(R){Yt(S,R)},pointerupcaptured:function(R){He(S,R)},pointermovecaptured:function(R){si(S,R)},tracking:!1,activePointersLists:[],lastClickPos:null,dblClickTimeOut:null,pinchGPoints:[],lastPinchDist:0,currentPinchDist:0,lastPinchCenter:null,currentPinchCenter:null,sentDragEvent:!1},this.hasGestureHandlers=!!(this.pressHandler||this.nonPrimaryPressHandler||this.releaseHandler||this.nonPrimaryReleaseHandler||this.clickHandler||this.dblClickHandler||this.dragHandler||this.dragEndHandler||this.pinchHandler),this.hasScrollHandler=!!this.scrollHandler,i.MouseTracker.havePointerEvents&&i.setElementPointerEvents(this.element,"auto"),this.exitHandler&&i.console.error("MouseTracker.exitHandler is deprecated. Use MouseTracker.leaveHandler instead."),w.startDisabled||this.setTracking(!0)},i.MouseTracker.prototype={destroy:function(){u(this),this.element=null,r[this.hash]=null,delete r[this.hash]},isTracking:function(){return r[this.hash].tracking},setTracking:function(w){return w?d(this):u(this),this},getActivePointersListByType:function(w){var y=r[this.hash],S,R=y?y.activePointersLists.length:0,U;for(S=0;S<R;S++)if(y.activePointersLists[S].type===w)return y.activePointersLists[S];return U=new i.MouseTracker.GesturePointList(w),y&&y.activePointersLists.push(U),U},getActivePointerCount:function(){var w=r[this.hash],y,S=w.activePointersLists.length,R=0;for(y=0;y<S;y++)R+=w.activePointersLists[y].getLength();return R},preProcessEventHandler:function(){},contextMenuHandler:function(){},enterHandler:function(){},leaveHandler:function(){},exitHandler:function(){},overHandler:function(){},outHandler:function(){},pressHandler:function(){},nonPrimaryPressHandler:function(){},releaseHandler:function(){},nonPrimaryReleaseHandler:function(){},moveHandler:function(){},scrollHandler:function(){},clickHandler:function(){},dblClickHandler:function(){},dragHandler:function(){},dragEndHandler:function(){},pinchHandler:function(){},stopHandler:function(){},keyDownHandler:function(){},keyUpHandler:function(){},keyHandler:function(){},focusHandler:function(){},blurHandler:function(){}};var a=(function(){try{return window.self!==window.top}catch{return!0}})();function o(w){try{return w.addEventListener&&w.removeEventListener}catch{return!1}}i.MouseTracker.gesturePointVelocityTracker=(function(){var w=[],y=0,S=0,R=function(Ae,ye){return Ae.hash.toString()+ye.type+ye.id.toString()},U=function(){var Ae,ye=w.length,lt,Qe,Wt=i.now(),Qt,Kt,un;for(Qt=Wt-S,S=Wt,Ae=0;Ae<ye;Ae++)lt=w[Ae],Qe=lt.gPoint,Qe.direction=Math.atan2(Qe.currentPos.y-lt.lastPos.y,Qe.currentPos.x-lt.lastPos.x),Kt=lt.lastPos.distanceTo(Qe.currentPos),lt.lastPos=Qe.currentPos,un=1e3*Kt/(Qt+1),Qe.speed=.75*un+.25*Qe.speed},X=function(Ae,ye){var lt=R(Ae,ye);w.push({guid:lt,gPoint:ye,lastPos:ye.currentPos}),w.length===1&&(S=i.now(),y=window.setInterval(U,50))},ve=function(Ae,ye){var lt=R(Ae,ye),Qe,Wt=w.length;for(Qe=0;Qe<Wt;Qe++)if(w[Qe].guid===lt){w.splice(Qe,1),Wt--,Wt===0&&window.clearInterval(y);break}};return{addPoint:X,removePoint:ve}})(),i.MouseTracker.captureElement=document,i.MouseTracker.wheelEventName="onwheel"in document.createElement("div")?"wheel":document.onmousewheel!==void 0?"mousewheel":"DOMMouseScroll",i.MouseTracker.subscribeEvents=["click","dblclick","keydown","keyup","keypress","focus","blur","contextmenu",i.MouseTracker.wheelEventName],i.MouseTracker.wheelEventName==="DOMMouseScroll"&&i.MouseTracker.subscribeEvents.push("MozMousePixelScroll"),window.PointerEvent?(i.MouseTracker.havePointerEvents=!0,i.MouseTracker.subscribeEvents.push("pointerenter","pointerleave","pointerover","pointerout","pointerdown","pointerup","pointermove","pointercancel"),i.MouseTracker.havePointerCapture=(function(){var w=document.createElement("div");return i.isFunction(w.setPointerCapture)&&i.isFunction(w.releasePointerCapture)})(),i.MouseTracker.havePointerCapture&&i.MouseTracker.subscribeEvents.push("gotpointercapture","lostpointercapture")):(i.MouseTracker.havePointerEvents=!1,i.MouseTracker.subscribeEvents.push("mouseenter","mouseleave","mouseover","mouseout","mousedown","mouseup","mousemove"),i.MouseTracker.mousePointerId="legacy-mouse",i.MouseTracker.havePointerCapture=(function(){var w=document.createElement("div");return i.isFunction(w.setCapture)&&i.isFunction(w.releaseCapture)})(),i.MouseTracker.havePointerCapture&&i.MouseTracker.subscribeEvents.push("losecapture"),"ontouchstart"in window&&i.MouseTracker.subscribeEvents.push("touchstart","touchend","touchmove","touchcancel"),"ongesturestart"in window&&i.MouseTracker.subscribeEvents.push("gesturestart","gesturechange")),i.MouseTracker.GesturePointList=function(w){this._gPoints=[],this.type=w,this.buttons=0,this.contacts=0,this.clicks=0,this.captureCount=0},i.MouseTracker.GesturePointList.prototype={getLength:function(){return this._gPoints.length},asArray:function(){return this._gPoints},add:function(w){return this._gPoints.push(w)},removeById:function(w){var y,S=this._gPoints.length;for(y=0;y<S;y++)if(this._gPoints[y].id===w){this._gPoints.splice(y,1);break}return this._gPoints.length},getByIndex:function(w){return w<this._gPoints.length?this._gPoints[w]:null},getById:function(w){var y,S=this._gPoints.length;for(y=0;y<S;y++)if(this._gPoints[y].id===w)return this._gPoints[y];return null},getPrimary:function(w){var y,S=this._gPoints.length;for(y=0;y<S;y++)if(this._gPoints[y].isPrimary)return this._gPoints[y];return null},addContact:function(){++this.contacts,this.contacts>1&&(this.type==="mouse"||this.type==="pen")&&(i.console.warn("GesturePointList.addContact() Implausible contacts value"),this.contacts=1)},removeContact:function(){--this.contacts,this.contacts<0&&(this.contacts=0)}};function l(w){var y=r[w.hash],S,R,U,X,ve,Ae=y.activePointersLists.length;for(S=0;S<Ae;S++)if(U=y.activePointersLists[S],U.getLength()>0){for(ve=[],X=U.asArray(),R=0;R<X.length;R++)ve.push(X[R]);for(R=0;R<ve.length;R++)yt(w,U,ve[R])}for(S=0;S<Ae;S++)y.activePointersLists.pop();y.sentDragEvent=!1}function d(w){var y=r[w.hash],S,R;if(!y.tracking){for(R=0;R<i.MouseTracker.subscribeEvents.length;R++)S=i.MouseTracker.subscribeEvents[R],i.addEvent(w.element,S,y[S],S===i.MouseTracker.wheelEventName?{passive:!1,capture:!1}:!1);l(w),y.tracking=!0}}function u(w){var y=r[w.hash],S,R;if(y.tracking){for(R=0;R<i.MouseTracker.subscribeEvents.length;R++)S=i.MouseTracker.subscribeEvents[R],i.removeEvent(w.element,S,y[S],!1);l(w),y.tracking=!1}}function h(w,y){var S=r[w.hash];if(y==="pointerevent")return{upName:"pointerup",upHandler:S.pointerupcaptured,moveName:"pointermove",moveHandler:S.pointermovecaptured};if(y==="mouse")return{upName:"pointerup",upHandler:S.pointerupcaptured,moveName:"pointermove",moveHandler:S.pointermovecaptured};if(y==="touch")return{upName:"touchend",upHandler:S.touchendcaptured,moveName:"touchmove",moveHandler:S.touchmovecaptured};throw new Error("MouseTracker.getCaptureEventParams: Unknown pointer type.")}function f(w,y){var S;if(i.MouseTracker.havePointerCapture)if(i.MouseTracker.havePointerEvents)try{w.element.setPointerCapture(y.id)}catch{i.console.warn("setPointerCapture() called on invalid pointer ID");return}else w.element.setCapture(!0);else S=h(w,i.MouseTracker.havePointerEvents?"pointerevent":y.type),a&&o(window.top)&&i.addEvent(window.top,S.upName,S.upHandler,!0),i.addEvent(i.MouseTracker.captureElement,S.upName,S.upHandler,!0),i.addEvent(i.MouseTracker.captureElement,S.moveName,S.moveHandler,!0);A(w,y,!0)}function g(w,y){var S,R,U;if(i.MouseTracker.havePointerCapture)if(i.MouseTracker.havePointerEvents){if(R=w.getActivePointersListByType(y.type),U=R.getById(y.id),!U||!U.captured)return;try{w.element.releasePointerCapture(y.id)}catch{}}else w.element.releaseCapture();else S=h(w,i.MouseTracker.havePointerEvents?"pointerevent":y.type),a&&o(window.top)&&i.removeEvent(window.top,S.upName,S.upHandler,!0),i.removeEvent(i.MouseTracker.captureElement,S.moveName,S.moveHandler,!0),i.removeEvent(i.MouseTracker.captureElement,S.upName,S.upHandler,!0);A(w,y,!1)}function v(w){return i.MouseTracker.havePointerEvents?w.pointerId:i.MouseTracker.mousePointerId}function T(w){return i.MouseTracker.havePointerEvents&&w.pointerType?w.pointerType:"mouse"}function E(w){return i.MouseTracker.havePointerEvents?w.isPrimary:!0}function _(w){return i.getMousePosition(w)}function C(w,y){return D(_(w),y)}function D(w,y){var S=i.getElementOffset(y);return w.minus(S)}function H(w,y){return new i.Point((w.x+y.x)/2,(w.y+y.y)/2)}function N(w,y){var S={originalEvent:y,eventType:"click",pointerType:"mouse",isEmulated:!1};P(w,S),S.preventDefault&&!S.defaultPrevented&&i.cancelEvent(y),S.stopPropagation&&i.stopEvent(y)}function J(w,y){var S={originalEvent:y,eventType:"dblclick",pointerType:"mouse",isEmulated:!1};P(w,S),S.preventDefault&&!S.defaultPrevented&&i.cancelEvent(y),S.stopPropagation&&i.stopEvent(y)}function Q(w,y){var S=null,R={originalEvent:y,eventType:"keydown",pointerType:"",isEmulated:!1};P(w,R),w.keyDownHandler&&!R.preventGesture&&!R.defaultPrevented&&(S={eventSource:w,keyCode:y.keyCode?y.keyCode:y.charCode,ctrl:y.ctrlKey,shift:y.shiftKey,alt:y.altKey,meta:y.metaKey,originalEvent:y,preventDefault:R.preventDefault||R.defaultPrevented,userData:w.userData},w.keyDownHandler(S)),(S&&S.preventDefault||R.preventDefault&&!R.defaultPrevented)&&i.cancelEvent(y),R.stopPropagation&&i.stopEvent(y)}function ee(w,y){var S=null,R={originalEvent:y,eventType:"keyup",pointerType:"",isEmulated:!1};P(w,R),w.keyUpHandler&&!R.preventGesture&&!R.defaultPrevented&&(S={eventSource:w,keyCode:y.keyCode?y.keyCode:y.charCode,ctrl:y.ctrlKey,shift:y.shiftKey,alt:y.altKey,meta:y.metaKey,originalEvent:y,preventDefault:R.preventDefault||R.defaultPrevented,userData:w.userData},w.keyUpHandler(S)),(S&&S.preventDefault||R.preventDefault&&!R.defaultPrevented)&&i.cancelEvent(y),R.stopPropagation&&i.stopEvent(y)}function he(w,y){var S=null,R={originalEvent:y,eventType:"keypress",pointerType:"",isEmulated:!1};P(w,R),w.keyHandler&&!R.preventGesture&&!R.defaultPrevented&&(S={eventSource:w,keyCode:y.keyCode?y.keyCode:y.charCode,ctrl:y.ctrlKey,shift:y.shiftKey,alt:y.altKey,meta:y.metaKey,originalEvent:y,preventDefault:R.preventDefault||R.defaultPrevented,userData:w.userData},w.keyHandler(S)),(S&&S.preventDefault||R.preventDefault&&!R.defaultPrevented)&&i.cancelEvent(y),R.stopPropagation&&i.stopEvent(y)}function ie(w,y){var S={originalEvent:y,eventType:"focus",pointerType:"",isEmulated:!1};P(w,S),w.focusHandler&&!S.preventGesture&&w.focusHandler({eventSource:w,originalEvent:y,userData:w.userData})}function ue(w,y){var S={originalEvent:y,eventType:"blur",pointerType:"",isEmulated:!1};P(w,S),w.blurHandler&&!S.preventGesture&&w.blurHandler({eventSource:w,originalEvent:y,userData:w.userData})}function se(w,y){var S=null,R={originalEvent:y,eventType:"contextmenu",pointerType:"mouse",isEmulated:!1};P(w,R),w.contextMenuHandler&&!R.preventGesture&&!R.defaultPrevented&&(S={eventSource:w,position:D(_(y),w.element),originalEvent:R.originalEvent,preventDefault:R.preventDefault||R.defaultPrevented,userData:w.userData},w.contextMenuHandler(S)),(S&&S.preventDefault||R.preventDefault&&!R.defaultPrevented)&&i.cancelEvent(y),R.stopPropagation&&i.stopEvent(y)}function pe(w,y){Te(w,y,y)}function re(w,y){var S={target:y.target||y.srcElement,type:"wheel",shiftKey:y.shiftKey||!1,clientX:y.clientX,clientY:y.clientY,pageX:y.pageX?y.pageX:y.clientX,pageY:y.pageY?y.pageY:y.clientY,deltaMode:y.type==="MozMousePixelScroll"?0:1,deltaX:0,deltaZ:0};i.MouseTracker.wheelEventName==="mousewheel"?S.deltaY=-y.wheelDelta/i.DEFAULT_SETTINGS.pixelsPerWheelLine:S.deltaY=y.detail,Te(w,S,y)}function Te(w,y,S){var R=0,U,X=null;R=y.deltaY?y.deltaY<0?1:-1:0,U={originalEvent:y,eventType:"wheel",pointerType:"mouse",isEmulated:y!==S},P(w,U),w.scrollHandler&&!U.preventGesture&&!U.defaultPrevented&&(X={eventSource:w,pointerType:"mouse",position:C(y,w.element),scroll:R,shift:y.shiftKey,isTouchEvent:!1,originalEvent:S,preventDefault:U.preventDefault||U.defaultPrevented,userData:w.userData},w.scrollHandler(X)),U.stopPropagation&&i.stopEvent(S),(X&&X.preventDefault||U.preventDefault&&!U.defaultPrevented)&&i.cancelEvent(S)}function Me(w,y){var S={id:i.MouseTracker.mousePointerId,type:"mouse"},R={originalEvent:y,eventType:"lostpointercapture",pointerType:"mouse",isEmulated:!1};P(w,R),y.target===w.element&&A(w,S,!1),R.stopPropagation&&i.stopEvent(y)}function Le(w,y){var S,R,U=y.changedTouches.length,X,ve=w.getActivePointersListByType("touch");S=i.now(),ve.getLength()>y.touches.length-U&&i.console.warn("Tracked touch contact count doesn't match event.touches.length");var Ae={originalEvent:y,eventType:"pointerdown",pointerType:"touch",isEmulated:!1};for(P(w,Ae),R=0;R<U;R++)X={id:y.changedTouches[R].identifier,type:"touch",isPrimary:ve.getLength()===0,currentPos:_(y.changedTouches[R]),currentTime:S},V(w,Ae,X),Ee(w,Ae,X,0),A(w,X,!0);Ae.preventDefault&&!Ae.defaultPrevented&&i.cancelEvent(y),Ae.stopPropagation&&i.stopEvent(y)}function Ce(w,y){var S,R,U=y.changedTouches.length,X;S=i.now();var ve={originalEvent:y,eventType:"pointerup",pointerType:"touch",isEmulated:!1};for(P(w,ve),R=0;R<U;R++)X={id:y.changedTouches[R].identifier,type:"touch",currentPos:_(y.changedTouches[R]),currentTime:S},Ie(w,ve,X,0),A(w,X,!1),$(w,ve,X);ve.preventDefault&&!ve.defaultPrevented&&i.cancelEvent(y),ve.stopPropagation&&i.stopEvent(y)}function Se(w,y){var S,R,U=y.changedTouches.length,X;S=i.now();var ve={originalEvent:y,eventType:"pointermove",pointerType:"touch",isEmulated:!1};for(P(w,ve),R=0;R<U;R++)X={id:y.changedTouches[R].identifier,type:"touch",currentPos:_(y.changedTouches[R]),currentTime:S},je(w,ve,X);ve.preventDefault&&!ve.defaultPrevented&&i.cancelEvent(y),ve.stopPropagation&&i.stopEvent(y)}function Y(w,y){var S=y.changedTouches.length,R,U,X={originalEvent:y,eventType:"pointercancel",pointerType:"touch",isEmulated:!1};for(P(w,X),R=0;R<S;R++)U={id:y.changedTouches[R].identifier,type:"touch"},_e(w,X,U);X.stopPropagation&&i.stopEvent(y)}function de(w,y){return i.eventIsCanceled(y)||y.preventDefault(),!1}function oe(w,y){return i.eventIsCanceled(y)||y.preventDefault(),!1}function O(w,y){var S={originalEvent:y,eventType:"gotpointercapture",pointerType:T(y),isEmulated:!1};P(w,S),y.target===w.element&&A(w,{id:y.pointerId,type:T(y)},!0),S.stopPropagation&&i.stopEvent(y)}function j(w,y){var S={originalEvent:y,eventType:"lostpointercapture",pointerType:T(y),isEmulated:!1};P(w,S),y.target===w.element&&A(w,{id:y.pointerId,type:T(y)},!1),S.stopPropagation&&i.stopEvent(y)}function ne(w,y){var S={id:v(y),type:T(y),isPrimary:E(y),currentPos:_(y),currentTime:i.now()},R={originalEvent:y,eventType:"pointerenter",pointerType:S.type,isEmulated:!1};P(w,R),V(w,R,S)}function Re(w,y){var S={id:v(y),type:T(y),isPrimary:E(y),currentPos:_(y),currentTime:i.now()},R={originalEvent:y,eventType:"pointerleave",pointerType:S.type,isEmulated:!1};P(w,R),$(w,R,S)}function De(w,y){var S={id:v(y),type:T(y),isPrimary:E(y),currentPos:_(y),currentTime:i.now()},R={originalEvent:y,eventType:"pointerover",pointerType:S.type,isEmulated:!1};P(w,R),ge(w,R,S),R.preventDefault&&!R.defaultPrevented&&i.cancelEvent(y),R.stopPropagation&&i.stopEvent(y)}function ke(w,y){var S={id:v(y),type:T(y),isPrimary:E(y),currentPos:_(y),currentTime:i.now()},R={originalEvent:y,eventType:"pointerout",pointerType:S.type,isEmulated:!1};P(w,R),W(w,R,S),R.preventDefault&&!R.defaultPrevented&&i.cancelEvent(y),R.stopPropagation&&i.stopEvent(y)}function Ne(w,y){var S={id:v(y),type:T(y),isPrimary:E(y),currentPos:_(y),currentTime:i.now()},R=i.MouseTracker.havePointerEvents&&S.type==="touch",U={originalEvent:y,eventType:"pointerdown",pointerType:S.type,isEmulated:!1};P(w,U),Ee(w,U,S,y.button),U.preventDefault&&!U.defaultPrevented&&i.cancelEvent(y),U.stopPropagation&&i.stopEvent(y),U.shouldCapture&&(R?A(w,S,!0):f(w,S))}function ze(w,y){Je(w,y)}function He(w,y){var S=w.getActivePointersListByType(T(y));S.getById(y.pointerId)&&Je(w,y),i.stopEvent(y)}function Je(w,y){var S;S={id:v(y),type:T(y),isPrimary:E(y),currentPos:_(y),currentTime:i.now()};var R={originalEvent:y,eventType:"pointerup",pointerType:S.type,isEmulated:!1};P(w,R),Ie(w,R,S,y.button),R.preventDefault&&!R.defaultPrevented&&i.cancelEvent(y),R.stopPropagation&&i.stopEvent(y),R.shouldReleaseCapture&&(y.target===w.element?g(w,S):A(w,S,!1))}function Nt(w,y){vt(w,y)}function si(w,y){var S=w.getActivePointersListByType(T(y));S.getById(y.pointerId)&&vt(w,y),i.stopEvent(y)}function vt(w,y){var S={id:v(y),type:T(y),isPrimary:E(y),currentPos:_(y),currentTime:i.now()},R={originalEvent:y,eventType:"pointermove",pointerType:S.type,isEmulated:!1};P(w,R),je(w,R,S),R.preventDefault&&!R.defaultPrevented&&i.cancelEvent(y),R.stopPropagation&&i.stopEvent(y)}function Yt(w,y){var S={id:y.pointerId,type:T(y)},R={originalEvent:y,eventType:"pointercancel",pointerType:S.type,isEmulated:!1};P(w,R),_e(w,R,S),R.stopPropagation&&i.stopEvent(y)}function rt(w,y){return y.speed=0,y.direction=0,y.contactPos=y.currentPos,y.contactTime=y.currentTime,y.lastPos=y.currentPos,y.lastTime=y.currentTime,w.add(y)}function yt(w,y,S){var R,U=y.getById(S.id);return U?(U.captured&&(i.console.warn("stopTrackingPointer() called on captured pointer"),g(w,U)),y.removeContact(),R=y.removeById(S.id)):R=y.getLength(),R}function m(w,y){switch(y.eventType){case"pointermove":y.isStoppable=!0,y.isCancelable=!0,y.preventDefault=!1,y.preventGesture=!w.hasGestureHandlers,y.stopPropagation=!1;break;case"pointerover":case"pointerout":case"contextmenu":case"keydown":case"keyup":case"keypress":y.isStoppable=!0,y.isCancelable=!0,y.preventDefault=!1,y.preventGesture=!1,y.stopPropagation=!1;break;case"pointerdown":y.isStoppable=!0,y.isCancelable=!0,y.preventDefault=!1,y.preventGesture=!w.hasGestureHandlers,y.stopPropagation=!1;break;case"pointerup":y.isStoppable=!0,y.isCancelable=!0,y.preventDefault=!1,y.preventGesture=!w.hasGestureHandlers,y.stopPropagation=!1;break;case"wheel":y.isStoppable=!0,y.isCancelable=!0,y.preventDefault=!1,y.preventGesture=!w.hasScrollHandler,y.stopPropagation=!1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":y.isStoppable=!0,y.isCancelable=!1,y.preventDefault=!1,y.preventGesture=!1,y.stopPropagation=!1;break;case"click":y.isStoppable=!0,y.isCancelable=!0,y.preventDefault=!!w.clickHandler,y.preventGesture=!1,y.stopPropagation=!1;break;case"dblclick":y.isStoppable=!0,y.isCancelable=!0,y.preventDefault=!!w.dblClickHandler,y.preventGesture=!1,y.stopPropagation=!1;break;case"focus":case"blur":case"pointerenter":case"pointerleave":default:y.isStoppable=!1,y.isCancelable=!1,y.preventDefault=!1,y.preventGesture=!1,y.stopPropagation=!1;break}}function P(w,y){y.eventSource=w,y.eventPhase=y.originalEvent&&typeof y.originalEvent.eventPhase<"u"?y.originalEvent.eventPhase:0,y.defaultPrevented=i.eventIsCanceled(y.originalEvent),y.shouldCapture=!1,y.shouldReleaseCapture=!1,y.userData=w.userData,m(w,y),w.preProcessEventHandler&&w.preProcessEventHandler(y)}function A(w,y,S){var R=w.getActivePointersListByType(y.type),U=R.getById(y.id);U?S&&!U.captured?(U.captured=!0,R.captureCount++):!S&&U.captured&&(U.captured=!1,R.captureCount--,R.captureCount<0&&(R.captureCount=0,i.console.warn("updatePointerCaptured() - pointsList.captureCount went negative"))):i.console.warn("updatePointerCaptured() called on untracked pointer")}function V(w,y,S){var R=w.getActivePointersListByType(S.type),U;U=R.getById(S.id),U?(U.insideElement=!0,U.lastPos=U.currentPos,U.lastTime=U.currentTime,U.currentPos=S.currentPos,U.currentTime=S.currentTime,S=U):(S.captured=!1,S.insideElementPressed=!1,S.insideElement=!0,rt(R,S)),w.enterHandler&&w.enterHandler({eventSource:w,pointerType:S.type,position:D(S.currentPos,w.element),buttons:R.buttons,pointers:w.getActivePointerCount(),insideElementPressed:S.insideElementPressed,buttonDownAny:R.buttons!==0,isTouchEvent:S.type==="touch",originalEvent:y.originalEvent,userData:w.userData})}function $(w,y,S){var R=w.getActivePointersListByType(S.type),U,X;U=R.getById(S.id),U?(U.captured?(U.insideElement=!1,U.lastPos=U.currentPos,U.lastTime=U.currentTime,U.currentPos=S.currentPos,U.currentTime=S.currentTime):yt(w,R,U),S=U):(S.captured=!1,S.insideElementPressed=!1),(w.leaveHandler||w.exitHandler)&&(X={eventSource:w,pointerType:S.type,position:S.currentPos&&D(S.currentPos,w.element),buttons:R.buttons,pointers:w.getActivePointerCount(),insideElementPressed:S.insideElementPressed,buttonDownAny:R.buttons!==0,isTouchEvent:S.type==="touch",originalEvent:y.originalEvent,userData:w.userData},w.leaveHandler&&w.leaveHandler(X),w.exitHandler&&w.exitHandler(X))}function ge(w,y,S){var R,U;R=w.getActivePointersListByType(S.type),U=R.getById(S.id),U?S=U:(S.captured=!1,S.insideElementPressed=!1),w.overHandler&&w.overHandler({eventSource:w,pointerType:S.type,position:D(S.currentPos,w.element),buttons:R.buttons,pointers:w.getActivePointerCount(),insideElementPressed:S.insideElementPressed,buttonDownAny:R.buttons!==0,isTouchEvent:S.type==="touch",originalEvent:y.originalEvent,userData:w.userData})}function W(w,y,S){var R,U;R=w.getActivePointersListByType(S.type),U=R.getById(S.id),U?S=U:(S.captured=!1,S.insideElementPressed=!1),w.outHandler&&w.outHandler({eventSource:w,pointerType:S.type,position:S.currentPos&&D(S.currentPos,w.element),buttons:R.buttons,pointers:w.getActivePointerCount(),insideElementPressed:S.insideElementPressed,buttonDownAny:R.buttons!==0,isTouchEvent:S.type==="touch",originalEvent:y.originalEvent,userData:w.userData})}function Ee(w,y,S,R){var U=r[w.hash],X=w.getActivePointersListByType(S.type),ve;if(typeof y.originalEvent.buttons<"u"?X.buttons=y.originalEvent.buttons:R===0?X.buttons|=1:R===1?X.buttons|=4:R===2?X.buttons|=2:R===3?X.buttons|=8:R===4?X.buttons|=16:R===5&&(X.buttons|=32),R!==0){y.shouldCapture=!1,y.shouldReleaseCapture=!1,w.nonPrimaryPressHandler&&!y.preventGesture&&!y.defaultPrevented&&(y.preventDefault=!0,w.nonPrimaryPressHandler({eventSource:w,pointerType:S.type,position:D(S.currentPos,w.element),button:R,buttons:X.buttons,isTouchEvent:S.type==="touch",originalEvent:y.originalEvent,userData:w.userData}));return}ve=X.getById(S.id),ve?(ve.insideElementPressed=!0,ve.insideElement=!0,ve.originalTarget=y.originalEvent.target,ve.contactPos=S.currentPos,ve.contactTime=S.currentTime,ve.lastPos=ve.currentPos,ve.lastTime=ve.currentTime,ve.currentPos=S.currentPos,ve.currentTime=S.currentTime,S=ve):(S.captured=!1,S.insideElementPressed=!0,S.insideElement=!0,S.originalTarget=y.originalEvent.target,rt(X,S)),X.addContact(),!y.preventGesture&&!y.defaultPrevented?(y.shouldCapture=!0,y.shouldReleaseCapture=!1,y.preventDefault=!0,(w.dragHandler||w.dragEndHandler||w.pinchHandler)&&i.MouseTracker.gesturePointVelocityTracker.addPoint(w,S),X.contacts===1?w.pressHandler&&!y.preventGesture&&w.pressHandler({eventSource:w,pointerType:S.type,position:D(S.contactPos,w.element),buttons:X.buttons,isTouchEvent:S.type==="touch",originalEvent:y.originalEvent,userData:w.userData}):X.contacts===2&&w.pinchHandler&&S.type==="touch"&&(U.pinchGPoints=X.asArray(),U.lastPinchDist=U.currentPinchDist=U.pinchGPoints[0].currentPos.distanceTo(U.pinchGPoints[1].currentPos),U.lastPinchCenter=U.currentPinchCenter=H(U.pinchGPoints[0].currentPos,U.pinchGPoints[1].currentPos))):(y.shouldCapture=!1,y.shouldReleaseCapture=!1)}function Ie(w,y,S,R){var U=r[w.hash],X=w.getActivePointersListByType(S.type),ve,Ae,ye,lt=!1,Qe;if(typeof y.originalEvent.buttons<"u"?X.buttons=y.originalEvent.buttons:R===0?X.buttons^=-2:R===1?X.buttons^=-5:R===2?X.buttons^=-3:R===3?X.buttons^=-9:R===4?X.buttons^=-17:R===5&&(X.buttons^=-33),y.shouldCapture=!1,R!==0){y.shouldReleaseCapture=!1,w.nonPrimaryReleaseHandler&&!y.preventGesture&&!y.defaultPrevented&&(y.preventDefault=!0,w.nonPrimaryReleaseHandler({eventSource:w,pointerType:S.type,position:D(S.currentPos,w.element),button:R,buttons:X.buttons,isTouchEvent:S.type==="touch",originalEvent:y.originalEvent,userData:w.userData}));return}ye=X.getById(S.id),ye?(X.removeContact(),ye.captured&&(lt=!0),ye.lastPos=ye.currentPos,ye.lastTime=ye.currentTime,ye.currentPos=S.currentPos,ye.currentTime=S.currentTime,ye.insideElement||yt(w,X,ye),ve=ye.currentPos,Ae=ye.currentTime):(S.captured=!1,S.insideElementPressed=!1,S.insideElement=!0,rt(X,S),ye=S),!y.preventGesture&&!y.defaultPrevented&&(lt?(y.shouldReleaseCapture=!0,y.preventDefault=!0,(w.dragHandler||w.dragEndHandler||w.pinchHandler)&&i.MouseTracker.gesturePointVelocityTracker.removePoint(w,ye),X.contacts===0?(w.releaseHandler&&ve&&w.releaseHandler({eventSource:w,pointerType:ye.type,position:D(ve,w.element),buttons:X.buttons,insideElementPressed:ye.insideElementPressed,insideElementReleased:ye.insideElement,isTouchEvent:ye.type==="touch",originalEvent:y.originalEvent,userData:w.userData}),w.dragEndHandler&&U.sentDragEvent&&w.dragEndHandler({eventSource:w,pointerType:ye.type,position:D(ye.currentPos,w.element),speed:ye.speed,direction:ye.direction,shift:y.originalEvent.shiftKey,isTouchEvent:ye.type==="touch",originalEvent:y.originalEvent,userData:w.userData}),U.sentDragEvent=!1,(w.clickHandler||w.dblClickHandler)&&ye.insideElement&&(Qe=Ae-ye.contactTime<=w.clickTimeThreshold&&ye.contactPos.distanceTo(ve)<=w.clickDistThreshold,w.clickHandler&&w.clickHandler({eventSource:w,pointerType:ye.type,position:D(ye.currentPos,w.element),quick:Qe,shift:y.originalEvent.shiftKey,isTouchEvent:ye.type==="touch",originalEvent:y.originalEvent,originalTarget:ye.originalTarget,userData:w.userData}),w.dblClickHandler&&Qe&&(X.clicks++,X.clicks===1?(U.lastClickPos=ve,U.dblClickTimeOut=setTimeout(function(){X.clicks=0},w.dblClickTimeThreshold)):X.clicks===2&&(clearTimeout(U.dblClickTimeOut),X.clicks=0,U.lastClickPos.distanceTo(ve)<=w.dblClickDistThreshold&&w.dblClickHandler({eventSource:w,pointerType:ye.type,position:D(ye.currentPos,w.element),shift:y.originalEvent.shiftKey,isTouchEvent:ye.type==="touch",originalEvent:y.originalEvent,userData:w.userData}),U.lastClickPos=null)))):X.contacts===2&&w.pinchHandler&&ye.type==="touch"&&(U.pinchGPoints=X.asArray(),U.lastPinchDist=U.currentPinchDist=U.pinchGPoints[0].currentPos.distanceTo(U.pinchGPoints[1].currentPos),U.lastPinchCenter=U.currentPinchCenter=H(U.pinchGPoints[0].currentPos,U.pinchGPoints[1].currentPos))):(y.shouldReleaseCapture=!1,w.releaseHandler&&ve&&(w.releaseHandler({eventSource:w,pointerType:ye.type,position:D(ve,w.element),buttons:X.buttons,insideElementPressed:ye.insideElementPressed,insideElementReleased:ye.insideElement,isTouchEvent:ye.type==="touch",originalEvent:y.originalEvent,userData:w.userData}),y.preventDefault=!0)))}function je(w,y,S){var R=r[w.hash],U=w.getActivePointersListByType(S.type),X,ve,Ae;if(typeof y.originalEvent.buttons<"u"&&(U.buttons=y.originalEvent.buttons),X=U.getById(S.id),X)X.lastPos=X.currentPos,X.lastTime=X.currentTime,X.currentPos=S.currentPos,X.currentTime=S.currentTime;else return;y.shouldCapture=!1,y.shouldReleaseCapture=!1,w.stopHandler&&S.type==="mouse"&&(clearTimeout(w.stopTimeOut),w.stopTimeOut=setTimeout(function(){We(w,y.originalEvent,S.type)},w.stopDelay)),U.contacts===0?w.moveHandler&&w.moveHandler({eventSource:w,pointerType:S.type,position:D(S.currentPos,w.element),buttons:U.buttons,isTouchEvent:S.type==="touch",originalEvent:y.originalEvent,userData:w.userData}):U.contacts===1?(w.moveHandler&&(X=U.asArray()[0],w.moveHandler({eventSource:w,pointerType:X.type,position:D(X.currentPos,w.element),buttons:U.buttons,isTouchEvent:X.type==="touch",originalEvent:y.originalEvent,userData:w.userData})),w.dragHandler&&!y.preventGesture&&!y.defaultPrevented&&(X=U.asArray()[0],Ae=X.currentPos.minus(X.lastPos),w.dragHandler({eventSource:w,pointerType:X.type,position:D(X.currentPos,w.element),buttons:U.buttons,delta:Ae,speed:X.speed,direction:X.direction,shift:y.originalEvent.shiftKey,isTouchEvent:X.type==="touch",originalEvent:y.originalEvent,userData:w.userData}),y.preventDefault=!0,R.sentDragEvent=!0)):U.contacts===2&&(w.moveHandler&&(ve=U.asArray(),w.moveHandler({eventSource:w,pointerType:ve[0].type,position:D(H(ve[0].currentPos,ve[1].currentPos),w.element),buttons:U.buttons,isTouchEvent:ve[0].type==="touch",originalEvent:y.originalEvent,userData:w.userData})),w.pinchHandler&&S.type==="touch"&&!y.preventGesture&&!y.defaultPrevented&&(Ae=R.pinchGPoints[0].currentPos.distanceTo(R.pinchGPoints[1].currentPos),Ae!==R.currentPinchDist&&(R.lastPinchDist=R.currentPinchDist,R.currentPinchDist=Ae,R.lastPinchCenter=R.currentPinchCenter,R.currentPinchCenter=H(R.pinchGPoints[0].currentPos,R.pinchGPoints[1].currentPos),w.pinchHandler({eventSource:w,pointerType:"touch",gesturePoints:R.pinchGPoints,lastCenter:D(R.lastPinchCenter,w.element),center:D(R.currentPinchCenter,w.element),lastDistance:R.lastPinchDist,distance:R.currentPinchDist,shift:y.originalEvent.shiftKey,originalEvent:y.originalEvent,userData:w.userData}),y.preventDefault=!0)))}function _e(w,y,S){var R=w.getActivePointersListByType(S.type),U;U=R.getById(S.id),U&&yt(w,R,U)}function We(w,y,S){w.stopHandler&&w.stopHandler({eventSource:w,pointerType:S,position:C(y,w.element),buttons:w.getActivePointersListByType(S).buttons,isTouchEvent:S==="touch",originalEvent:y,userData:w.userData})}})(M),(function(i){i.ControlAnchor={NONE:0,TOP_LEFT:1,TOP_RIGHT:2,BOTTOM_RIGHT:3,BOTTOM_LEFT:4,ABSOLUTE:5},i.Control=function(r,a,o){var l=r.parentNode;typeof a=="number"&&(i.console.error("Passing an anchor directly into the OpenSeadragon.Control constructor is deprecated; please use an options object instead.  Support for this deprecated variant is scheduled for removal in December 2013"),a={anchor:a}),a.attachToViewer=typeof a.attachToViewer>"u"?!0:a.attachToViewer,this.autoFade=typeof a.autoFade>"u"?!0:a.autoFade,this.element=r,this.anchor=a.anchor,this.container=o,this.anchor===i.ControlAnchor.ABSOLUTE?(this.wrapper=i.makeNeutralElement("div"),this.wrapper.style.position="absolute",this.wrapper.style.top=typeof a.top=="number"?a.top+"px":a.top,this.wrapper.style.left=typeof a.left=="number"?a.left+"px":a.left,this.wrapper.style.height=typeof a.height=="number"?a.height+"px":a.height,this.wrapper.style.width=typeof a.width=="number"?a.width+"px":a.width,this.wrapper.style.margin="0px",this.wrapper.style.padding="0px",this.element.style.position="relative",this.element.style.top="0px",this.element.style.left="0px",this.element.style.height="100%",this.element.style.width="100%"):(this.wrapper=i.makeNeutralElement("div"),this.wrapper.style.display="inline-block",this.anchor===i.ControlAnchor.NONE&&(this.wrapper.style.width=this.wrapper.style.height="100%")),this.wrapper.appendChild(this.element),a.attachToViewer?this.anchor===i.ControlAnchor.TOP_RIGHT||this.anchor===i.ControlAnchor.BOTTOM_RIGHT?this.container.insertBefore(this.wrapper,this.container.firstChild):this.container.appendChild(this.wrapper):l.appendChild(this.wrapper)},i.Control.prototype={destroy:function(){this.wrapper.removeChild(this.element),this.anchor!==i.ControlAnchor.NONE&&this.container.removeChild(this.wrapper)},isVisible:function(){return this.wrapper.style.display!=="none"},setVisible:function(r){this.wrapper.style.display=r?this.anchor===i.ControlAnchor.ABSOLUTE?"block":"inline-block":"none"},setOpacity:function(r){i.setElementOpacity(this.wrapper,r,!0)}}})(M),(function(i){i.ControlDock=function(a){var o=["topleft","topright","bottomright","bottomleft"],l,d;for(i.extend(!0,this,{id:"controldock-"+i.now()+"-"+Math.floor(Math.random()*1e6),container:i.makeNeutralElement("div"),controls:[]},a),this.container.onsubmit=function(){return!1},this.element&&(this.element=i.getElement(this.element),this.element.appendChild(this.container),i.getElementStyle(this.element).position==="static"&&(this.element.style.position="relative"),this.container.style.width="100%",this.container.style.height="100%"),d=0;d<o.length;d++)l=o[d],this.controls[l]=i.makeNeutralElement("div"),this.controls[l].style.position="absolute",l.match("left")&&(this.controls[l].style.left="0px"),l.match("right")&&(this.controls[l].style.right="0px"),l.match("top")&&(this.controls[l].style.top="0px"),l.match("bottom")&&(this.controls[l].style.bottom="0px");this.container.appendChild(this.controls.topleft),this.container.appendChild(this.controls.topright),this.container.appendChild(this.controls.bottomright),this.container.appendChild(this.controls.bottomleft)},i.ControlDock.prototype={addControl:function(a,o){a=i.getElement(a);var l=null;if(!(r(this,a)>=0)){switch(o.anchor){case i.ControlAnchor.TOP_RIGHT:l=this.controls.topright,a.style.position="relative",a.style.paddingRight="0px",a.style.paddingTop="0px";break;case i.ControlAnchor.BOTTOM_RIGHT:l=this.controls.bottomright,a.style.position="relative",a.style.paddingRight="0px",a.style.paddingBottom="0px";break;case i.ControlAnchor.BOTTOM_LEFT:l=this.controls.bottomleft,a.style.position="relative",a.style.paddingLeft="0px",a.style.paddingBottom="0px";break;case i.ControlAnchor.TOP_LEFT:l=this.controls.topleft,a.style.position="relative",a.style.paddingLeft="0px",a.style.paddingTop="0px";break;case i.ControlAnchor.ABSOLUTE:l=this.container,a.style.margin="0px",a.style.padding="0px";break;default:case i.ControlAnchor.NONE:l=this.container,a.style.margin="0px",a.style.padding="0px";break}this.controls.push(new i.Control(a,o,l)),a.style.display="inline-block"}},removeControl:function(a){a=i.getElement(a);var o=r(this,a);return o>=0&&(this.controls[o].destroy(),this.controls.splice(o,1)),this},clearControls:function(){for(;this.controls.length>0;)this.controls.pop().destroy();return this},areControlsEnabled:function(){var a;for(a=this.controls.length-1;a>=0;a--)if(this.controls[a].isVisible())return!0;return!1},setControlsEnabled:function(a){var o;for(o=this.controls.length-1;o>=0;o--)this.controls[o].setVisible(a);return this}};function r(a,o){var l=a.controls,d;for(d=l.length-1;d>=0;d--)if(l[d].element===o)return d;return-1}})(M),(function(i){i.Placement=i.freezeObject({CENTER:0,TOP_LEFT:1,TOP:2,TOP_RIGHT:3,RIGHT:4,BOTTOM_RIGHT:5,BOTTOM:6,BOTTOM_LEFT:7,LEFT:8,properties:{0:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!1,isVerticallyCentered:!0,isBottom:!1},1:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!0,isVerticallyCentered:!1,isBottom:!1},2:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!0,isVerticallyCentered:!1,isBottom:!1},3:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!0,isVerticallyCentered:!1,isBottom:!1},4:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!1,isVerticallyCentered:!0,isBottom:!1},5:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!1,isVerticallyCentered:!1,isBottom:!0},6:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!1,isVerticallyCentered:!1,isBottom:!0},7:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!1,isVerticallyCentered:!1,isBottom:!0},8:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!1,isVerticallyCentered:!0,isBottom:!1}}})})(M),(function(i){var r={},a=1;i.Viewer=function(m){var P=arguments,A=this,V;i.isPlainObject(m)||(m={id:P[0],xmlPath:P.length>1?P[1]:void 0,prefixUrl:P.length>2?P[2]:void 0,controls:P.length>3?P[3]:void 0,overlays:P.length>4?P[4]:void 0}),m.config&&(i.extend(!0,m,m.config),delete m.config);let $=["useCanvas"];if(m.drawerOptions=Object.assign({},$.reduce((W,Ee)=>(W[Ee]=m[Ee],delete m[Ee],W),{}),m.drawerOptions),i.extend(!0,this,{id:m.id,hash:m.hash||a++,initialPage:0,element:null,container:null,canvas:null,overlays:[],overlaysContainer:null,previousBody:[],customControls:[],source:null,drawer:null,world:null,viewport:null,navigator:null,collectionViewport:null,collectionDrawer:null,navImages:null,buttonGroup:null,profiler:null},i.DEFAULT_SETTINGS,m),typeof this.hash>"u")throw new Error("A hash must be defined, either by specifying options.id or options.hash.");typeof r[this.hash]<"u"&&i.console.warn("Hash "+this.hash+" has already been used."),r[this.hash]={fsBoundsDelta:new i.Point(1,1),prevContainerSize:null,animating:!1,forceRedraw:!1,needsResize:!1,forceResize:!1,mouseInside:!1,group:null,zooming:!1,zoomFactor:null,lastZoomTime:null,fullPage:!1,onfullscreenchange:null,lastClickTime:null,draggingToZoom:!1},this._sequenceIndex=0,this._firstOpen=!0,this._updateRequestId=null,this._loadQueue=[],this.currentOverlays=[],this._updatePixelDensityRatioBind=null,this._lastScrollTime=i.now(),i.EventSource.call(this),this.addHandler("open-failed",function(W){var Ee=i.getString("Errors.OpenFailed",W.eventSource,W.message);A._showMessage(Ee)}),i.ControlDock.call(this,m),this.xmlPath&&(this.tileSources=[this.xmlPath]),this.element=this.element||document.getElementById(this.id),this.canvas=i.makeNeutralElement("div"),this.canvas.className="openseadragon-canvas",(function(W){W.width="100%",W.height="100%",W.overflow="hidden",W.position="absolute",W.top="0px",W.left="0px"})(this.canvas.style),i.setElementTouchActionNone(this.canvas),m.tabIndex!==""&&(this.canvas.tabIndex=m.tabIndex===void 0?0:m.tabIndex),this.container.className="openseadragon-container",(function(W){W.width="100%",W.height="100%",W.position="relative",W.overflow="hidden",W.left="0px",W.top="0px",W.textAlign="left"})(this.container.style),i.setElementTouchActionNone(this.container),this.container.insertBefore(this.canvas,this.container.firstChild),this.element.appendChild(this.container),this.bodyWidth=document.body.style.width,this.bodyHeight=document.body.style.height,this.bodyOverflow=document.body.style.overflow,this.docOverflow=document.documentElement.style.overflow,this.innerTracker=new i.MouseTracker({userData:"Viewer.innerTracker",element:this.canvas,startDisabled:!this.mouseNavEnabled,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,dblClickTimeThreshold:this.dblClickTimeThreshold,dblClickDistThreshold:this.dblClickDistThreshold,contextMenuHandler:i.delegate(this,C),keyDownHandler:i.delegate(this,D),keyHandler:i.delegate(this,H),clickHandler:i.delegate(this,N),dblClickHandler:i.delegate(this,J),dragHandler:i.delegate(this,Q),dragEndHandler:i.delegate(this,ee),enterHandler:i.delegate(this,he),leaveHandler:i.delegate(this,ie),pressHandler:i.delegate(this,ue),releaseHandler:i.delegate(this,se),nonPrimaryPressHandler:i.delegate(this,pe),nonPrimaryReleaseHandler:i.delegate(this,re),scrollHandler:i.delegate(this,Ce),pinchHandler:i.delegate(this,Te),focusHandler:i.delegate(this,Me),blurHandler:i.delegate(this,Le)}),this.outerTracker=new i.MouseTracker({userData:"Viewer.outerTracker",element:this.container,startDisabled:!this.mouseNavEnabled,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,dblClickTimeThreshold:this.dblClickTimeThreshold,dblClickDistThreshold:this.dblClickDistThreshold,enterHandler:i.delegate(this,Se),leaveHandler:i.delegate(this,Y)}),this.toolbar&&(this.toolbar=new i.ControlDock({element:this.toolbar})),this.bindStandardControls(),r[this.hash].prevContainerSize=o(this.container),window.ResizeObserver?(this._autoResizePolling=!1,this._resizeObserver=new ResizeObserver(function(){r[A.hash].needsResize=!0}),this._resizeObserver.observe(this.container,{})):this._autoResizePolling=!0,this.world=new i.World({viewer:this}),this.world.addHandler("add-item",function(W){A.source=A.world.getItemAt(0).source,r[A.hash].forceRedraw=!0,A._updateRequestId||(A._updateRequestId=h(A,de))}),this.world.addHandler("remove-item",function(W){A.world.getItemCount()?A.source=A.world.getItemAt(0).source:A.source=null,r[A.hash].forceRedraw=!0}),this.world.addHandler("metrics-change",function(W){A.viewport&&A.viewport._setContentBounds(A.world.getHomeBounds(),A.world.getContentFactor())}),this.world.addHandler("item-index-change",function(W){A.source=A.world.getItemAt(0).source}),this.viewport=new i.Viewport({containerSize:r[this.hash].prevContainerSize,springStiffness:this.springStiffness,animationTime:this.animationTime,minZoomImageRatio:this.minZoomImageRatio,maxZoomPixelRatio:this.maxZoomPixelRatio,visibilityRatio:this.visibilityRatio,wrapHorizontal:this.wrapHorizontal,wrapVertical:this.wrapVertical,defaultZoomLevel:this.defaultZoomLevel,minZoomLevel:this.minZoomLevel,maxZoomLevel:this.maxZoomLevel,viewer:this,degrees:this.degrees,flipped:this.flipped,overlayPreserveContentDirection:this.overlayPreserveContentDirection,navigatorRotate:this.navigatorRotate,homeFillsViewer:this.homeFillsViewer,margins:this.viewportMargins,silenceMultiImageWarnings:this.silenceMultiImageWarnings}),this.viewport._setContentBounds(this.world.getHomeBounds(),this.world.getContentFactor()),this.imageLoader=new i.ImageLoader({jobLimit:this.imageLoaderLimit,timeout:m.timeout,tileRetryMax:this.tileRetryMax,tileRetryDelay:this.tileRetryDelay}),this.tileCache=new i.TileCache({maxImageCacheCount:this.maxImageCacheCount}),Object.prototype.hasOwnProperty.call(this.drawerOptions,"useCanvas")&&(i.console.error('useCanvas is deprecated, use the "drawer" option to indicate preferred drawer(s)'),this.drawerOptions.useCanvas||(this.drawer=i.HTMLDrawer),delete this.drawerOptions.useCanvas);let ge=Array.isArray(this.drawer)?this.drawer:[this.drawer];ge.length===0&&(ge=[i.DEFAULT_SETTINGS.drawer].flat(),i.console.warn("No valid drawers were selected. Using the default value.")),this.drawer=null;for(const W of ge)if(this.requestDrawer(W,{mainDrawer:!0,redrawImmediately:!1}))break;if(!this.drawer)throw i.console.error("No drawer could be created!"),"Error with creating the selected drawer(s)";for(this.drawer.setImageSmoothingEnabled(this.imageSmoothingEnabled),this.overlaysContainer=i.makeNeutralElement("div"),this.canvas.appendChild(this.overlaysContainer),this.drawer.canRotate()||(this.rotateLeft&&(V=this.buttonGroup.buttons.indexOf(this.rotateLeft),this.buttonGroup.buttons.splice(V,1),this.buttonGroup.element.removeChild(this.rotateLeft.element)),this.rotateRight&&(V=this.buttonGroup.buttons.indexOf(this.rotateRight),this.buttonGroup.buttons.splice(V,1),this.buttonGroup.element.removeChild(this.rotateRight.element))),this._addUpdatePixelDensityRatioEvent(),this.showNavigator&&(this.navigator=new i.Navigator({element:this.navigatorElement,id:this.navigatorId,position:this.navigatorPosition,sizeRatio:this.navigatorSizeRatio,maintainSizeRatio:this.navigatorMaintainSizeRatio,top:this.navigatorTop,left:this.navigatorLeft,width:this.navigatorWidth,height:this.navigatorHeight,autoResize:this.navigatorAutoResize,autoFade:this.navigatorAutoFade,prefixUrl:this.prefixUrl,viewer:this,navigatorRotate:this.navigatorRotate,background:this.navigatorBackground,opacity:this.navigatorOpacity,borderColor:this.navigatorBorderColor,displayRegionColor:this.navigatorDisplayRegionColor,crossOriginPolicy:this.crossOriginPolicy,animationTime:this.animationTime,drawer:this.drawer.getType(),loadTilesWithAjax:this.loadTilesWithAjax,ajaxHeaders:this.ajaxHeaders,ajaxWithCredentials:this.ajaxWithCredentials})),this.sequenceMode&&this.bindSequenceControls(),this.tileSources&&this.open(this.tileSources),V=0;V<this.customControls.length;V++)this.addControl(this.customControls[V].id,{anchor:this.customControls[V].anchor});i.requestAnimationFrame(function(){g(A)}),i._viewers.set(this.element,this)},i.extend(i.Viewer.prototype,i.EventSource.prototype,i.ControlDock.prototype,{isOpen:function(){return!!this.world.getItemCount()},openDzi:function(m){return i.console.error("[Viewer.openDzi] this function is deprecated; use Viewer.open() instead."),this.open(m)},openTileSource:function(m){return i.console.error("[Viewer.openTileSource] this function is deprecated; use Viewer.open() instead."),this.open(m)},get buttons(){return i.console.warn("Viewer.buttons is deprecated; Please use Viewer.buttonGroup"),this.buttonGroup},open:function(m,P){var A=this;if(this.close(),!m)return this;if(this.sequenceMode&&i.isArray(m))return this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null),typeof P<"u"&&!isNaN(P)&&(this.initialPage=P),this.tileSources=m,this._sequenceIndex=Math.max(0,Math.min(this.tileSources.length-1,this.initialPage)),this.tileSources.length&&(this.open(this.tileSources[this._sequenceIndex]),this.showReferenceStrip&&this.addReferenceStrip()),this._updateSequenceButtons(this._sequenceIndex),this;if(i.isArray(m)||(m=[m]),!m.length)return this;this._opening=!0;for(var V=m.length,$=0,ge=0,W,Ee=function(){if($+ge===V)if($){(A._firstOpen||!A.preserveViewport)&&(A.viewport.goHome(!0),A.viewport.update()),A._firstOpen=!1;var _e=m[0];if(_e.tileSource&&(_e=_e.tileSource),A.overlays&&!A.preserveOverlays)for(var We=0;We<A.overlays.length;We++)A.currentOverlays[We]=d(A,A.overlays[We]);A._drawOverlays(),A._opening=!1,A.raiseEvent("open",{source:_e})}else A._opening=!1,A.raiseEvent("open-failed",W)},Ie=function(_e){(!i.isPlainObject(_e)||!_e.tileSource)&&(_e={tileSource:_e}),_e.index!==void 0&&(i.console.error("[Viewer.open] setting indexes here is not supported; use addTiledImage instead"),delete _e.index),_e.collectionImmediately===void 0&&(_e.collectionImmediately=!0);var We=_e.success;_e.success=function(y){if($++,_e.tileSource.overlays)for(var S=0;S<_e.tileSource.overlays.length;S++)A.addOverlay(_e.tileSource.overlays[S]);We&&We(y),Ee()};var w=_e.error;_e.error=function(y){ge++,W||(W=y),w&&w(y),Ee()},A.addTiledImage(_e)},je=0;je<m.length;je++)Ie(m[je]);return this},close:function(){return r[this.hash]?(this._opening=!1,this.navigator&&this.navigator.close(),this.preserveOverlays||(this.clearOverlays(),this.overlaysContainer.innerHTML=""),r[this.hash].animating=!1,this.world.removeAll(),this.imageLoader.clear(),this.raiseEvent("close"),this):this},destroy:function(){if(r[this.hash]){if(this.raiseEvent("before-destroy"),this._removeUpdatePixelDensityRatioEvent(),this.close(),this.clearOverlays(),this.overlaysContainer.innerHTML="",this._resizeObserver&&this._resizeObserver.disconnect(),this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null),this._updateRequestId!==null&&(i.cancelAnimationFrame(this._updateRequestId),this._updateRequestId=null),this.drawer&&this.drawer.destroy(),this.navigator&&(this.navigator.destroy(),r[this.navigator.hash]=null,delete r[this.navigator.hash],this.navigator=null),this.buttonGroup)this.buttonGroup.destroy();else if(this.customButtons)for(;this.customButtons.length;)this.customButtons.pop().destroy();if(this.paging&&this.paging.destroy(),this.element)for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.container.onsubmit=null,this.clearControls(),this.innerTracker&&this.innerTracker.destroy(),this.outerTracker&&this.outerTracker.destroy(),r[this.hash]=null,delete r[this.hash],this.canvas=null,this.container=null,i._viewers.delete(this.element),this.element=null,this.raiseEvent("destroy"),this.removeAllHandlers()}},requestDrawer(m,P){const A={mainDrawer:!0,redrawImmediately:!0,drawerOptions:null};P=i.extend(!0,A,P);const V=P.mainDrawer,$=P.redrawImmediately,ge=P.drawerOptions,W=this.drawer;let Ee=null;if(m&&m.prototype instanceof i.DrawerBase?(Ee=m,m="custom"):typeof m=="string"&&(Ee=i.determineDrawer(m)),Ee||i.console.warn("Unsupported drawer! Drawer must be an existing string type, or a class that extends OpenSeadragon.DrawerBase."),Ee&&Ee.isSupported()){W&&V&&W.destroy();const Ie=new Ee({viewer:this,viewport:this.viewport,element:this.canvas,debugGridColor:this.debugGridColor,options:ge||this.drawerOptions[m]});return V&&(this.drawer=Ie,$&&this.forceRedraw()),Ie}return!1},isMouseNavEnabled:function(){return this.innerTracker.isTracking()},setMouseNavEnabled:function(m){return this.innerTracker.setTracking(m),this.outerTracker.setTracking(m),this.raiseEvent("mouse-enabled",{enabled:m}),this},areControlsEnabled:function(){var m=this.controls.length,P;for(P=0;P<this.controls.length;P++)m=m&&this.controls[P].isVisible();return m},setControlsEnabled:function(m){return m?T(this):g(this),this.raiseEvent("controls-enabled",{enabled:m}),this},setDebugMode:function(m){for(var P=0;P<this.world.getItemCount();P++)this.world.getItemAt(P).debugMode=m;this.debugMode=m,this.forceRedraw()},setAjaxHeaders:function(m,P){if(m===null&&(m={}),!i.isPlainObject(m)){console.error("[Viewer.setAjaxHeaders] Ignoring invalid headers, must be a plain object");return}if(P===void 0&&(P=!0),this.ajaxHeaders=m,P){for(var A=0;A<this.world.getItemCount();A++)this.world.getItemAt(A)._updateAjaxHeaders(!0);if(this.navigator&&this.navigator.setAjaxHeaders(this.ajaxHeaders,!0),this.referenceStrip&&this.referenceStrip.miniViewers)for(var V in this.referenceStrip.miniViewers)this.referenceStrip.miniViewers[V].setAjaxHeaders(this.ajaxHeaders,!0)}},addButton:function(m){this.buttonGroup.addButton(m)},isFullPage:function(){return r[this.hash]&&r[this.hash].fullPage},setFullPage:function(m){var P=document.body,A=P.style,V=document.documentElement.style,$=this,ge,W;if(m===this.isFullPage())return this;var Ee={fullPage:m,preventDefaultAction:!1};if(this.raiseEvent("pre-full-page",Ee),Ee.preventDefaultAction)return this;if(m&&this.element){for(this.elementSize=i.getElementSize(this.element),this.pageScroll=i.getPageScroll(),this.elementMargin=this.element.style.margin,this.element.style.margin="0",this.elementPadding=this.element.style.padding,this.element.style.padding="0",this.bodyMargin=A.margin,this.docMargin=V.margin,A.margin="0",V.margin="0",this.bodyPadding=A.padding,this.docPadding=V.padding,A.padding="0",V.padding="0",this.bodyWidth=A.width,this.docWidth=V.width,A.width="100%",V.width="100%",this.bodyHeight=A.height,this.docHeight=V.height,A.height="100%",V.height="100%",this.bodyDisplay=A.display,A.display="block",this.previousBody=[],r[this.hash].prevElementParent=this.element.parentNode,r[this.hash].prevNextSibling=this.element.nextSibling,r[this.hash].prevElementWidth=this.element.style.width,r[this.hash].prevElementHeight=this.element.style.height,ge=P.childNodes.length,W=0;W<ge;W++)this.previousBody.push(P.childNodes[0]),P.removeChild(P.childNodes[0]);this.toolbar&&this.toolbar.element&&(this.toolbar.parentNode=this.toolbar.element.parentNode,this.toolbar.nextSibling=this.toolbar.element.nextSibling,P.appendChild(this.toolbar.element),i.addClass(this.toolbar.element,"fullpage")),i.addClass(this.element,"fullpage"),P.appendChild(this.element),this.element.style.height="100vh",this.element.style.width="100vw",this.toolbar&&this.toolbar.element&&(this.element.style.height=i.getElementSize(this.element).y-i.getElementSize(this.toolbar.element).y+"px"),r[this.hash].fullPage=!0,i.delegate(this,Se)({})}else{for(this.element.style.margin=this.elementMargin,this.element.style.padding=this.elementPadding,A.margin=this.bodyMargin,V.margin=this.docMargin,A.padding=this.bodyPadding,V.padding=this.docPadding,A.width=this.bodyWidth,V.width=this.docWidth,A.height=this.bodyHeight,V.height=this.docHeight,A.display=this.bodyDisplay,P.removeChild(this.element),ge=this.previousBody.length,W=0;W<ge;W++)P.appendChild(this.previousBody.shift());i.removeClass(this.element,"fullpage"),r[this.hash].prevElementParent.insertBefore(this.element,r[this.hash].prevNextSibling),this.toolbar&&this.toolbar.element&&(P.removeChild(this.toolbar.element),i.removeClass(this.toolbar.element,"fullpage"),this.toolbar.parentNode.insertBefore(this.toolbar.element,this.toolbar.nextSibling),delete this.toolbar.parentNode,delete this.toolbar.nextSibling),this.element.style.width=r[this.hash].prevElementWidth,this.element.style.height=r[this.hash].prevElementHeight;var Ie=0,je=function(){i.setPageScroll($.pageScroll);var _e=i.getPageScroll();Ie++,Ie<10&&(_e.x!==$.pageScroll.x||_e.y!==$.pageScroll.y)&&i.requestAnimationFrame(je)};i.requestAnimationFrame(je),r[this.hash].fullPage=!1,i.delegate(this,Y)({})}return this.navigator&&this.viewport&&this.navigator.update(this.viewport),this.raiseEvent("full-page",{fullPage:m}),this},setFullScreen:function(m){var P=this;if(!i.supportsFullScreen)return this.setFullPage(m);if(i.isFullScreen()===m)return this;var A={fullScreen:m,preventDefaultAction:!1};if(this.raiseEvent("pre-full-screen",A),A.preventDefaultAction)return this;if(m){if(this.setFullPage(!0),!this.isFullPage())return this;this.fullPageStyleWidth=this.element.style.width,this.fullPageStyleHeight=this.element.style.height,this.element.style.width="100%",this.element.style.height="100%";var V=function(){var $=i.isFullScreen();$||(i.removeEvent(document,i.fullScreenEventName,V),i.removeEvent(document,i.fullScreenErrorEventName,V),P.setFullPage(!1),P.isFullPage()&&(P.element.style.width=P.fullPageStyleWidth,P.element.style.height=P.fullPageStyleHeight)),P.navigator&&P.viewport&&setTimeout(function(){P.navigator.update(P.viewport)}),P.raiseEvent("full-screen",{fullScreen:$})};i.addEvent(document,i.fullScreenEventName,V),i.addEvent(document,i.fullScreenErrorEventName,V),i.requestFullScreen(document.body)}else i.exitFullScreen();return this},isVisible:function(){return this.container.style.visibility!=="hidden"},isFullScreen:function(){return i.isFullScreen()&&this.isFullPage()},setVisible:function(m){return this.container.style.visibility=m?"":"hidden",this.raiseEvent("visible",{visible:m}),this},addTiledImage:function(m){i.console.assert(m,"[Viewer.addTiledImage] options is required"),i.console.assert(m.tileSource,"[Viewer.addTiledImage] options.tileSource is required"),i.console.assert(!m.replace||m.index>-1&&m.index<this.world.getItemCount(),"[Viewer.addTiledImage] if options.replace is used, options.index must be a valid index in Viewer.world");var P=this;m.replace&&(m.replaceItem=P.world.getItemAt(m.index)),this._hideMessage(),m.placeholderFillStyle===void 0&&(m.placeholderFillStyle=this.placeholderFillStyle),m.opacity===void 0&&(m.opacity=this.opacity),m.preload===void 0&&(m.preload=this.preload),m.compositeOperation===void 0&&(m.compositeOperation=this.compositeOperation),m.crossOriginPolicy===void 0&&(m.crossOriginPolicy=m.tileSource.crossOriginPolicy!==void 0?m.tileSource.crossOriginPolicy:this.crossOriginPolicy),m.ajaxWithCredentials===void 0&&(m.ajaxWithCredentials=this.ajaxWithCredentials),m.loadTilesWithAjax===void 0&&(m.loadTilesWithAjax=this.loadTilesWithAjax),i.isPlainObject(m.ajaxHeaders)||(m.ajaxHeaders={});var A={options:m};function V(W){for(var Ee=0;Ee<P._loadQueue.length;Ee++)if(P._loadQueue[Ee]===A){P._loadQueue.splice(Ee,1);break}P._loadQueue.length===0&&$(A),P.raiseEvent("add-item-failed",W),m.error&&m.error(W)}function $(W){P.collectionMode&&(P.world.arrange({immediately:W.options.collectionImmediately,rows:P.collectionRows,columns:P.collectionColumns,layout:P.collectionLayout,tileSize:P.collectionTileSize,tileMargin:P.collectionTileMargin}),P.world.setAutoRefigureSizes(!0))}if(i.isArray(m.tileSource)){setTimeout(function(){V({message:"[Viewer.addTiledImage] Sequences can not be added; add them one at a time instead.",source:m.tileSource,options:m})});return}this._loadQueue.push(A);function ge(){for(var W,Ee,Ie;P._loadQueue.length&&(W=P._loadQueue[0],!!W.tileSource);){if(P._loadQueue.splice(0,1),W.options.replace){var je=P.world.getIndexOfItem(W.options.replaceItem);je!==-1&&(W.options.index=je),P.world.removeItem(W.options.replaceItem)}Ee=new i.TiledImage({viewer:P,source:W.tileSource,viewport:P.viewport,drawer:P.drawer,tileCache:P.tileCache,imageLoader:P.imageLoader,x:W.options.x,y:W.options.y,width:W.options.width,height:W.options.height,fitBounds:W.options.fitBounds,fitBoundsPlacement:W.options.fitBoundsPlacement,clip:W.options.clip,placeholderFillStyle:W.options.placeholderFillStyle,opacity:W.options.opacity,preload:W.options.preload,degrees:W.options.degrees,flipped:W.options.flipped,compositeOperation:W.options.compositeOperation,springStiffness:P.springStiffness,animationTime:P.animationTime,minZoomImageRatio:P.minZoomImageRatio,wrapHorizontal:P.wrapHorizontal,wrapVertical:P.wrapVertical,maxTilesPerFrame:P.maxTilesPerFrame,immediateRender:P.immediateRender,blendTime:P.blendTime,alwaysBlend:P.alwaysBlend,minPixelRatio:P.minPixelRatio,smoothTileEdgesMinZoom:P.smoothTileEdgesMinZoom,iOSDevice:P.iOSDevice,crossOriginPolicy:W.options.crossOriginPolicy,ajaxWithCredentials:W.options.ajaxWithCredentials,loadTilesWithAjax:W.options.loadTilesWithAjax,ajaxHeaders:W.options.ajaxHeaders,debugMode:P.debugMode,subPixelRoundingForTransparency:P.subPixelRoundingForTransparency}),P.collectionMode&&P.world.setAutoRefigureSizes(!1),P.navigator&&(Ie=i.extend({},W.options,{replace:!1,originalTiledImage:Ee,tileSource:W.tileSource}),P.navigator.addTiledImage(Ie)),P.world.addItem(Ee,{index:W.options.index}),P._loadQueue.length===0&&$(W),P.world.getItemCount()===1&&!P.preserveViewport&&P.viewport.goHome(!0),W.options.success&&W.options.success({item:Ee})}}l(this,m.tileSource,m,function(W){A.tileSource=W,ge()},function(W){W.options=m,V(W),ge()})},addSimpleImage:function(m){i.console.assert(m,"[Viewer.addSimpleImage] options is required"),i.console.assert(m.url,"[Viewer.addSimpleImage] options.url is required");var P=i.extend({},m,{tileSource:{type:"image",url:m.url}});delete P.url,this.addTiledImage(P)},addLayer:function(m){var P=this;i.console.error("[Viewer.addLayer] this function is deprecated; use Viewer.addTiledImage() instead.");var A=i.extend({},m,{success:function(V){P.raiseEvent("add-layer",{options:m,drawer:V.item})},error:function(V){P.raiseEvent("add-layer-failed",V)}});return this.addTiledImage(A),this},getLayerAtLevel:function(m){return i.console.error("[Viewer.getLayerAtLevel] this function is deprecated; use World.getItemAt() instead."),this.world.getItemAt(m)},getLevelOfLayer:function(m){return i.console.error("[Viewer.getLevelOfLayer] this function is deprecated; use World.getIndexOfItem() instead."),this.world.getIndexOfItem(m)},getLayersCount:function(){return i.console.error("[Viewer.getLayersCount] this function is deprecated; use World.getItemCount() instead."),this.world.getItemCount()},setLayerLevel:function(m,P){return i.console.error("[Viewer.setLayerLevel] this function is deprecated; use World.setItemIndex() instead."),this.world.setItemIndex(m,P)},removeLayer:function(m){return i.console.error("[Viewer.removeLayer] this function is deprecated; use World.removeItem() instead."),this.world.removeItem(m)},forceRedraw:function(){return r[this.hash].forceRedraw=!0,this},forceResize:function(){r[this.hash].needsResize=!0,r[this.hash].forceResize=!0},bindSequenceControls:function(){var m=i.delegate(this,E),P=i.delegate(this,_),A=i.delegate(this,this.goToNextPage),V=i.delegate(this,this.goToPreviousPage),$=this.navImages,ge=!0;return this.showSequenceControl&&((this.previousButton||this.nextButton)&&(ge=!1),this.previousButton=new i.Button({element:this.previousButton?i.getElement(this.previousButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:i.getString("Tooltips.PreviousPage"),srcRest:ne(this.prefixUrl,$.previous.REST),srcGroup:ne(this.prefixUrl,$.previous.GROUP),srcHover:ne(this.prefixUrl,$.previous.HOVER),srcDown:ne(this.prefixUrl,$.previous.DOWN),onRelease:V,onFocus:m,onBlur:P}),this.nextButton=new i.Button({element:this.nextButton?i.getElement(this.nextButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:i.getString("Tooltips.NextPage"),srcRest:ne(this.prefixUrl,$.next.REST),srcGroup:ne(this.prefixUrl,$.next.GROUP),srcHover:ne(this.prefixUrl,$.next.HOVER),srcDown:ne(this.prefixUrl,$.next.DOWN),onRelease:A,onFocus:m,onBlur:P}),this.navPrevNextWrap||this.previousButton.disable(),(!this.tileSources||!this.tileSources.length)&&this.nextButton.disable(),ge&&(this.paging=new i.ButtonGroup({buttons:[this.previousButton,this.nextButton],clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold}),this.pagingControl=this.paging.element,this.toolbar?this.toolbar.addControl(this.pagingControl,{anchor:i.ControlAnchor.BOTTOM_RIGHT}):this.addControl(this.pagingControl,{anchor:this.sequenceControlAnchor||i.ControlAnchor.TOP_LEFT}))),this},bindStandardControls:function(){var m=i.delegate(this,Re),P=i.delegate(this,ke),A=i.delegate(this,He),V=i.delegate(this,De),$=i.delegate(this,Je),ge=i.delegate(this,si),W=i.delegate(this,vt),Ee=i.delegate(this,Yt),Ie=i.delegate(this,rt),je=i.delegate(this,yt),_e=i.delegate(this,E),We=i.delegate(this,_),w=this.navImages,y=[],S=!0;return this.showNavigationControl&&((this.zoomInButton||this.zoomOutButton||this.homeButton||this.fullPageButton||this.rotateLeftButton||this.rotateRightButton||this.flipButton)&&(S=!1),this.showZoomControl&&(y.push(this.zoomInButton=new i.Button({element:this.zoomInButton?i.getElement(this.zoomInButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:i.getString("Tooltips.ZoomIn"),srcRest:ne(this.prefixUrl,w.zoomIn.REST),srcGroup:ne(this.prefixUrl,w.zoomIn.GROUP),srcHover:ne(this.prefixUrl,w.zoomIn.HOVER),srcDown:ne(this.prefixUrl,w.zoomIn.DOWN),onPress:m,onRelease:P,onClick:A,onEnter:m,onExit:P,onFocus:_e,onBlur:We})),y.push(this.zoomOutButton=new i.Button({element:this.zoomOutButton?i.getElement(this.zoomOutButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:i.getString("Tooltips.ZoomOut"),srcRest:ne(this.prefixUrl,w.zoomOut.REST),srcGroup:ne(this.prefixUrl,w.zoomOut.GROUP),srcHover:ne(this.prefixUrl,w.zoomOut.HOVER),srcDown:ne(this.prefixUrl,w.zoomOut.DOWN),onPress:V,onRelease:P,onClick:$,onEnter:V,onExit:P,onFocus:_e,onBlur:We}))),this.showHomeControl&&y.push(this.homeButton=new i.Button({element:this.homeButton?i.getElement(this.homeButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:i.getString("Tooltips.Home"),srcRest:ne(this.prefixUrl,w.home.REST),srcGroup:ne(this.prefixUrl,w.home.GROUP),srcHover:ne(this.prefixUrl,w.home.HOVER),srcDown:ne(this.prefixUrl,w.home.DOWN),onRelease:ge,onFocus:_e,onBlur:We})),this.showFullPageControl&&y.push(this.fullPageButton=new i.Button({element:this.fullPageButton?i.getElement(this.fullPageButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:i.getString("Tooltips.FullPage"),srcRest:ne(this.prefixUrl,w.fullpage.REST),srcGroup:ne(this.prefixUrl,w.fullpage.GROUP),srcHover:ne(this.prefixUrl,w.fullpage.HOVER),srcDown:ne(this.prefixUrl,w.fullpage.DOWN),onRelease:W,onFocus:_e,onBlur:We})),this.showRotationControl&&(y.push(this.rotateLeftButton=new i.Button({element:this.rotateLeftButton?i.getElement(this.rotateLeftButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:i.getString("Tooltips.RotateLeft"),srcRest:ne(this.prefixUrl,w.rotateleft.REST),srcGroup:ne(this.prefixUrl,w.rotateleft.GROUP),srcHover:ne(this.prefixUrl,w.rotateleft.HOVER),srcDown:ne(this.prefixUrl,w.rotateleft.DOWN),onRelease:Ee,onFocus:_e,onBlur:We})),y.push(this.rotateRightButton=new i.Button({element:this.rotateRightButton?i.getElement(this.rotateRightButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:i.getString("Tooltips.RotateRight"),srcRest:ne(this.prefixUrl,w.rotateright.REST),srcGroup:ne(this.prefixUrl,w.rotateright.GROUP),srcHover:ne(this.prefixUrl,w.rotateright.HOVER),srcDown:ne(this.prefixUrl,w.rotateright.DOWN),onRelease:Ie,onFocus:_e,onBlur:We}))),this.showFlipControl&&y.push(this.flipButton=new i.Button({element:this.flipButton?i.getElement(this.flipButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:i.getString("Tooltips.Flip"),srcRest:ne(this.prefixUrl,w.flip.REST),srcGroup:ne(this.prefixUrl,w.flip.GROUP),srcHover:ne(this.prefixUrl,w.flip.HOVER),srcDown:ne(this.prefixUrl,w.flip.DOWN),onRelease:je,onFocus:_e,onBlur:We})),S?(this.buttonGroup=new i.ButtonGroup({buttons:y,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold}),this.navControl=this.buttonGroup.element,this.addHandler("open",i.delegate(this,Nt)),this.toolbar?this.toolbar.addControl(this.navControl,{anchor:this.navigationControlAnchor||i.ControlAnchor.TOP_LEFT}):this.addControl(this.navControl,{anchor:this.navigationControlAnchor||i.ControlAnchor.TOP_LEFT})):this.customButtons=y),this},currentPage:function(){return this._sequenceIndex},goToPage:function(m){return this.tileSources&&m>=0&&m<this.tileSources.length&&(this._sequenceIndex=m,this._updateSequenceButtons(m),this.open(this.tileSources[m]),this.referenceStrip&&this.referenceStrip.setFocus(m),this.raiseEvent("page",{page:m})),this},addOverlay:function(m,P,A,V){var $;if(i.isPlainObject(m)?$=m:$={element:m,location:P,placement:A,onDraw:V},m=i.getElement($.element),u(this.currentOverlays,m)>=0)return this;var ge=d(this,$);return this.currentOverlays.push(ge),ge.drawHTML(this.overlaysContainer,this.viewport),this.raiseEvent("add-overlay",{element:m,location:$.location,placement:$.placement}),this},updateOverlay:function(m,P,A){var V;return m=i.getElement(m),V=u(this.currentOverlays,m),V>=0&&(this.currentOverlays[V].update(P,A),r[this.hash].forceRedraw=!0,this.raiseEvent("update-overlay",{element:m,location:P,placement:A})),this},removeOverlay:function(m){var P;return m=i.getElement(m),P=u(this.currentOverlays,m),P>=0&&(this.currentOverlays[P].destroy(),this.currentOverlays.splice(P,1),r[this.hash].forceRedraw=!0,this.raiseEvent("remove-overlay",{element:m})),this},clearOverlays:function(){for(;this.currentOverlays.length>0;)this.currentOverlays.pop().destroy();return r[this.hash].forceRedraw=!0,this.raiseEvent("clear-overlay",{}),this},getOverlayById:function(m){var P;return m=i.getElement(m),P=u(this.currentOverlays,m),P>=0?this.currentOverlays[P]:null},_updateSequenceButtons:function(m){this.nextButton&&(!this.tileSources||this.tileSources.length-1===m?this.navPrevNextWrap||this.nextButton.disable():this.nextButton.enable()),this.previousButton&&(m>0?this.previousButton.enable():this.navPrevNextWrap||this.previousButton.disable())},_showMessage:function(m){this._hideMessage();var P=i.makeNeutralElement("div");P.appendChild(document.createTextNode(m)),this.messageDiv=i.makeCenteredNode(P),i.addClass(this.messageDiv,"openseadragon-message"),this.container.appendChild(this.messageDiv)},_hideMessage:function(){var m=this.messageDiv;m&&(m.parentNode.removeChild(m),delete this.messageDiv)},gestureSettingsByDeviceType:function(m){switch(m){case"mouse":return this.gestureSettingsMouse;case"touch":return this.gestureSettingsTouch;case"pen":return this.gestureSettingsPen;default:return this.gestureSettingsUnknown}},_drawOverlays:function(){var m,P=this.currentOverlays.length;for(m=0;m<P;m++)this.currentOverlays[m].drawHTML(this.overlaysContainer,this.viewport)},_cancelPendingImages:function(){this._loadQueue=[]},removeReferenceStrip:function(){this.showReferenceStrip=!1,this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null)},addReferenceStrip:function(){if(this.showReferenceStrip=!0,this.sequenceMode){if(this.referenceStrip)return;this.tileSources.length&&this.tileSources.length>1&&(this.referenceStrip=new i.ReferenceStrip({id:this.referenceStripElement,position:this.referenceStripPosition,sizeRatio:this.referenceStripSizeRatio,scroll:this.referenceStripScroll,height:this.referenceStripHeight,width:this.referenceStripWidth,tileSources:this.tileSources,prefixUrl:this.prefixUrl,viewer:this}),this.referenceStrip.setFocus(this._sequenceIndex))}else i.console.warn('Attempting to display a reference strip while "sequenceMode" is off.')},_addUpdatePixelDensityRatioEvent:function(){this._updatePixelDensityRatioBind=this._updatePixelDensityRatio.bind(this),i.addEvent(window,"resize",this._updatePixelDensityRatioBind)},_removeUpdatePixelDensityRatioEvent:function(){i.removeEvent(window,"resize",this._updatePixelDensityRatioBind)},_updatePixelDensityRatio:function(){var m=i.pixelDensityRatio,P=i.getCurrentPixelDensityRatio();m!==P&&(i.pixelDensityRatio=P,this.forceResize())},goToPreviousPage:function(){var m=this._sequenceIndex-1;this.navPrevNextWrap&&m<0&&(m+=this.tileSources.length),this.goToPage(m)},goToNextPage:function(){var m=this._sequenceIndex+1;this.navPrevNextWrap&&m>=this.tileSources.length&&(m=0),this.goToPage(m)},isAnimating:function(){return r[this.hash].animating}});function o(m){return m=i.getElement(m),new i.Point(m.clientWidth===0?1:m.clientWidth,m.clientHeight===0?1:m.clientHeight)}function l(m,P,A,V,$){var ge=m;if(i.type(P)==="string"){if(P.match(/^\s*<.*>\s*$/))P=i.parseXml(P);else if(P.match(/^\s*[{[].*[}\]]\s*$/))try{var W=i.parseJSON(P);P=W}catch{}}function Ee(Ie,je){Ie.ready?V(Ie):(Ie.addHandler("ready",function(){V(Ie)}),Ie.addHandler("open-failed",function(_e){$({message:_e.message,source:je})}))}setTimeout(function(){if(i.type(P)==="string")P=new i.TileSource({url:P,crossOriginPolicy:A.crossOriginPolicy!==void 0?A.crossOriginPolicy:m.crossOriginPolicy,ajaxWithCredentials:m.ajaxWithCredentials,ajaxHeaders:A.ajaxHeaders?A.ajaxHeaders:m.ajaxHeaders,splitHashDataForPost:m.splitHashDataForPost,success:function(We){V(We.tileSource)}}),P.addHandler("open-failed",function(We){$(We)});else if(i.isPlainObject(P)||P.nodeType)if(P.crossOriginPolicy===void 0&&(A.crossOriginPolicy!==void 0||m.crossOriginPolicy!==void 0)&&(P.crossOriginPolicy=A.crossOriginPolicy!==void 0?A.crossOriginPolicy:m.crossOriginPolicy),P.ajaxWithCredentials===void 0&&(P.ajaxWithCredentials=m.ajaxWithCredentials),i.isFunction(P.getTileUrl)){var Ie=new i.TileSource(P);Ie.getTileUrl=P.getTileUrl,V(Ie)}else{var je=i.TileSource.determineType(ge,P);if(!je){$({message:"Unable to load TileSource",source:P});return}var _e=je.prototype.configure.apply(ge,[P]);Ee(new je(_e),P)}else Ee(P,P)})}function d(m,P){if(P instanceof i.Overlay)return P;var A=null;if(P.element)A=i.getElement(P.element);else{var V=P.id?P.id:"openseadragon-overlay-"+Math.floor(Math.random()*1e7);A=i.getElement(P.id),A||(A=document.createElement("a"),A.href="#/overlay/"+V),A.id=V,i.addClass(A,P.className?P.className:"openseadragon-overlay")}var $=P.location,ge=P.width,W=P.height;if(!$){var Ee=P.x,Ie=P.y;if(P.px!==void 0){var je=m.viewport.imageToViewportRectangle(new i.Rect(P.px,P.py,ge||0,W||0));Ee=je.x,Ie=je.y,ge=ge!==void 0?je.width:void 0,W=W!==void 0?je.height:void 0}$=new i.Point(Ee,Ie)}var _e=P.placement;return _e&&i.type(_e)==="string"&&(_e=i.Placement[P.placement.toUpperCase()]),new i.Overlay({element:A,location:$,placement:_e,onDraw:P.onDraw,checkResize:P.checkResize,width:ge,height:W,rotationMode:P.rotationMode})}function u(m,P){var A;for(A=m.length-1;A>=0;A--)if(m[A].element===P)return A;return-1}function h(m,P){return i.requestAnimationFrame(function(){P(m)})}function f(m){i.requestAnimationFrame(function(){v(m)})}function g(m){m.autoHideControls&&(m.controlsShouldFade=!0,m.controlsFadeBeginTime=i.now()+m.controlsFadeDelay,window.setTimeout(function(){f(m)},m.controlsFadeDelay))}function v(m){var P,A,V,$;if(m.controlsShouldFade){for(P=i.now(),A=P-m.controlsFadeBeginTime,V=1-A/m.controlsFadeLength,V=Math.min(1,V),V=Math.max(0,V),$=m.controls.length-1;$>=0;$--)m.controls[$].autoFade&&m.controls[$].setOpacity(V);V>0&&f(m)}}function T(m){var P;for(m.controlsShouldFade=!1,P=m.controls.length-1;P>=0;P--)m.controls[P].setOpacity(1)}function E(){T(this)}function _(){g(this)}function C(m){var P={tracker:m.eventSource,position:m.position,originalEvent:m.originalEvent,preventDefault:m.preventDefault};this.raiseEvent("canvas-contextmenu",P),m.preventDefault=P.preventDefault}function D(m){var P={originalEvent:m.originalEvent,preventDefaultAction:!1,preventVerticalPan:m.preventVerticalPan||!this.panVertical,preventHorizontalPan:m.preventHorizontalPan||!this.panHorizontal};if(this.raiseEvent("canvas-key",P),!P.preventDefaultAction&&!m.ctrl&&!m.alt&&!m.meta)switch(m.keyCode){case 38:P.preventVerticalPan||(m.shift?this.viewport.zoomBy(1.1):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new i.Point(0,-this.pixelsPerArrowPress))),this.viewport.applyConstraints()),m.preventDefault=!0;break;case 40:P.preventVerticalPan||(m.shift?this.viewport.zoomBy(.9):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new i.Point(0,this.pixelsPerArrowPress))),this.viewport.applyConstraints()),m.preventDefault=!0;break;case 37:P.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new i.Point(-this.pixelsPerArrowPress,0))),this.viewport.applyConstraints()),m.preventDefault=!0;break;case 39:P.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new i.Point(this.pixelsPerArrowPress,0))),this.viewport.applyConstraints()),m.preventDefault=!0;break;case 187:this.viewport.zoomBy(1.1),this.viewport.applyConstraints(),m.preventDefault=!0;break;case 189:this.viewport.zoomBy(.9),this.viewport.applyConstraints(),m.preventDefault=!0;break;case 48:this.viewport.goHome(),this.viewport.applyConstraints(),m.preventDefault=!0;break;case 87:P.preventVerticalPan||(m.shift?this.viewport.zoomBy(1.1):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new i.Point(0,-40))),this.viewport.applyConstraints()),m.preventDefault=!0;break;case 83:P.preventVerticalPan||(m.shift?this.viewport.zoomBy(.9):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new i.Point(0,40))),this.viewport.applyConstraints()),m.preventDefault=!0;break;case 65:P.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new i.Point(-40,0))),this.viewport.applyConstraints()),m.preventDefault=!0;break;case 68:P.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new i.Point(40,0))),this.viewport.applyConstraints()),m.preventDefault=!0;break;case 82:m.shift?this.viewport.flipped?this.viewport.setRotation(this.viewport.getRotation()+this.rotationIncrement):this.viewport.setRotation(this.viewport.getRotation()-this.rotationIncrement):this.viewport.flipped?this.viewport.setRotation(this.viewport.getRotation()-this.rotationIncrement):this.viewport.setRotation(this.viewport.getRotation()+this.rotationIncrement),this.viewport.applyConstraints(),m.preventDefault=!0;break;case 70:this.viewport.toggleFlip(),m.preventDefault=!0;break;case 74:this.goToPreviousPage();break;case 75:this.goToNextPage();break;default:m.preventDefault=!1;break}else m.preventDefault=!1}function H(m){var P={originalEvent:m.originalEvent};this.raiseEvent("canvas-key-press",P)}function N(m){var P,A=document.activeElement===this.canvas;A||this.canvas.focus(),this.viewport.flipped&&(m.position.x=this.viewport.getContainerSize().x-m.position.x);var V={tracker:m.eventSource,position:m.position,quick:m.quick,shift:m.shift,originalEvent:m.originalEvent,originalTarget:m.originalTarget,preventDefaultAction:!1};this.raiseEvent("canvas-click",V),!V.preventDefaultAction&&this.viewport&&m.quick&&(P=this.gestureSettingsByDeviceType(m.pointerType),P.clickToZoom===!0&&(this.viewport.zoomBy(m.shift?1/this.zoomPerClick:this.zoomPerClick,P.zoomToRefPoint?this.viewport.pointFromPixel(m.position,!0):null),this.viewport.applyConstraints()),P.dblClickDragToZoom&&(r[this.hash].draggingToZoom===!0?(r[this.hash].lastClickTime=null,r[this.hash].draggingToZoom=!1):r[this.hash].lastClickTime=i.now()))}function J(m){var P,A={tracker:m.eventSource,position:m.position,shift:m.shift,originalEvent:m.originalEvent,preventDefaultAction:!1};this.raiseEvent("canvas-double-click",A),!A.preventDefaultAction&&this.viewport&&(P=this.gestureSettingsByDeviceType(m.pointerType),P.dblClickToZoom&&(this.viewport.zoomBy(m.shift?1/this.zoomPerClick:this.zoomPerClick,P.zoomToRefPoint?this.viewport.pointFromPixel(m.position,!0):null),this.viewport.applyConstraints()))}function Q(m){var P,A={tracker:m.eventSource,pointerType:m.pointerType,position:m.position,delta:m.delta,speed:m.speed,direction:m.direction,shift:m.shift,originalEvent:m.originalEvent,preventDefaultAction:!1};if(this.raiseEvent("canvas-drag",A),P=this.gestureSettingsByDeviceType(m.pointerType),!A.preventDefaultAction&&this.viewport){if(P.dblClickDragToZoom&&r[this.hash].draggingToZoom){var V=Math.pow(this.zoomPerDblClickDrag,m.delta.y/50);this.viewport.zoomBy(V)}else if(P.dragToPan&&!r[this.hash].draggingToZoom){if(this.panHorizontal||(m.delta.x=0),this.panVertical||(m.delta.y=0),this.viewport.flipped&&(m.delta.x=-m.delta.x),this.constrainDuringPan){var $=this.viewport.deltaPointsFromPixels(m.delta.negate());this.viewport.centerSpringX.target.value+=$.x,this.viewport.centerSpringY.target.value+=$.y;var ge=this.viewport.getConstrainedBounds();this.viewport.centerSpringX.target.value-=$.x,this.viewport.centerSpringY.target.value-=$.y,ge.xConstrained&&(m.delta.x=0),ge.yConstrained&&(m.delta.y=0)}this.viewport.panBy(this.viewport.deltaPointsFromPixels(m.delta.negate()),P.flickEnabled&&!this.constrainDuringPan)}}}function ee(m){var P,A={tracker:m.eventSource,pointerType:m.pointerType,position:m.position,speed:m.speed,direction:m.direction,shift:m.shift,originalEvent:m.originalEvent,preventDefaultAction:!1};if(this.raiseEvent("canvas-drag-end",A),P=this.gestureSettingsByDeviceType(m.pointerType),!A.preventDefaultAction&&this.viewport){if(!r[this.hash].draggingToZoom&&P.dragToPan&&P.flickEnabled&&m.speed>=P.flickMinSpeed){var V=0;this.panHorizontal&&(V=P.flickMomentum*m.speed*Math.cos(m.direction));var $=0;this.panVertical&&($=P.flickMomentum*m.speed*Math.sin(m.direction));var ge=this.viewport.pixelFromPoint(this.viewport.getCenter(!0)),W=this.viewport.pointFromPixel(new i.Point(ge.x-V,ge.y-$));this.viewport.panTo(W,!1)}this.viewport.applyConstraints()}P.dblClickDragToZoom&&r[this.hash].draggingToZoom===!0&&(r[this.hash].draggingToZoom=!1)}function he(m){this.raiseEvent("canvas-enter",{tracker:m.eventSource,pointerType:m.pointerType,position:m.position,buttons:m.buttons,pointers:m.pointers,insideElementPressed:m.insideElementPressed,buttonDownAny:m.buttonDownAny,originalEvent:m.originalEvent})}function ie(m){this.raiseEvent("canvas-exit",{tracker:m.eventSource,pointerType:m.pointerType,position:m.position,buttons:m.buttons,pointers:m.pointers,insideElementPressed:m.insideElementPressed,buttonDownAny:m.buttonDownAny,originalEvent:m.originalEvent})}function ue(m){var P;if(this.raiseEvent("canvas-press",{tracker:m.eventSource,pointerType:m.pointerType,position:m.position,insideElementPressed:m.insideElementPressed,insideElementReleased:m.insideElementReleased,originalEvent:m.originalEvent}),P=this.gestureSettingsByDeviceType(m.pointerType),P.dblClickDragToZoom){var A=r[this.hash].lastClickTime,V=i.now();if(A===null)return;V-A<this.dblClickTimeThreshold&&(r[this.hash].draggingToZoom=!0),r[this.hash].lastClickTime=null}}function se(m){this.raiseEvent("canvas-release",{tracker:m.eventSource,pointerType:m.pointerType,position:m.position,insideElementPressed:m.insideElementPressed,insideElementReleased:m.insideElementReleased,originalEvent:m.originalEvent})}function pe(m){this.raiseEvent("canvas-nonprimary-press",{tracker:m.eventSource,position:m.position,pointerType:m.pointerType,button:m.button,buttons:m.buttons,originalEvent:m.originalEvent})}function re(m){this.raiseEvent("canvas-nonprimary-release",{tracker:m.eventSource,position:m.position,pointerType:m.pointerType,button:m.button,buttons:m.buttons,originalEvent:m.originalEvent})}function Te(m){var P,A,V,$,ge={tracker:m.eventSource,pointerType:m.pointerType,gesturePoints:m.gesturePoints,lastCenter:m.lastCenter,center:m.center,lastDistance:m.lastDistance,distance:m.distance,shift:m.shift,originalEvent:m.originalEvent,preventDefaultPanAction:!1,preventDefaultZoomAction:!1,preventDefaultRotateAction:!1};if(this.raiseEvent("canvas-pinch",ge),this.viewport&&(P=this.gestureSettingsByDeviceType(m.pointerType),P.pinchToZoom&&(!ge.preventDefaultPanAction||!ge.preventDefaultZoomAction)&&(A=this.viewport.pointFromPixel(m.center,!0),P.zoomToRefPoint&&!ge.preventDefaultPanAction&&(V=this.viewport.pointFromPixel(m.lastCenter,!0),$=V.minus(A),this.panHorizontal||($.x=0),this.panVertical||($.y=0),this.viewport.panBy($,!0)),ge.preventDefaultZoomAction||this.viewport.zoomBy(m.distance/m.lastDistance,A,!0),this.viewport.applyConstraints()),P.pinchRotate&&!ge.preventDefaultRotateAction)){var W=Math.atan2(m.gesturePoints[0].currentPos.y-m.gesturePoints[1].currentPos.y,m.gesturePoints[0].currentPos.x-m.gesturePoints[1].currentPos.x),Ee=Math.atan2(m.gesturePoints[0].lastPos.y-m.gesturePoints[1].lastPos.y,m.gesturePoints[0].lastPos.x-m.gesturePoints[1].lastPos.x);A=this.viewport.pointFromPixel(m.center,!0),this.viewport.rotateTo(this.viewport.getRotation(!0)+(W-Ee)*(180/Math.PI),A,!0)}}function Me(m){this.raiseEvent("canvas-focus",{tracker:m.eventSource,originalEvent:m.originalEvent})}function Le(m){this.raiseEvent("canvas-blur",{tracker:m.eventSource,originalEvent:m.originalEvent})}function Ce(m){var P,A,V,$,ge;$=i.now(),ge=$-this._lastScrollTime,ge>this.minScrollDeltaTime?(this._lastScrollTime=$,P={tracker:m.eventSource,position:m.position,scroll:m.scroll,shift:m.shift,originalEvent:m.originalEvent,preventDefaultAction:!1,preventDefault:!0},this.raiseEvent("canvas-scroll",P),!P.preventDefaultAction&&this.viewport&&(this.viewport.flipped&&(m.position.x=this.viewport.getContainerSize().x-m.position.x),A=this.gestureSettingsByDeviceType(m.pointerType),A.scrollToZoom&&(V=Math.pow(this.zoomPerScroll,m.scroll),this.viewport.zoomBy(V,A.zoomToRefPoint?this.viewport.pointFromPixel(m.position,!0):null),this.viewport.applyConstraints())),m.preventDefault=P.preventDefault):m.preventDefault=!0}function Se(m){r[this.hash].mouseInside=!0,T(this),this.raiseEvent("container-enter",{tracker:m.eventSource,pointerType:m.pointerType,position:m.position,buttons:m.buttons,pointers:m.pointers,insideElementPressed:m.insideElementPressed,buttonDownAny:m.buttonDownAny,originalEvent:m.originalEvent})}function Y(m){m.pointers<1&&(r[this.hash].mouseInside=!1,r[this.hash].animating||g(this)),this.raiseEvent("container-exit",{tracker:m.eventSource,pointerType:m.pointerType,position:m.position,buttons:m.buttons,pointers:m.pointers,insideElementPressed:m.insideElementPressed,buttonDownAny:m.buttonDownAny,originalEvent:m.originalEvent})}function de(m){O(m),m.isOpen()?m._updateRequestId=h(m,de):m._updateRequestId=!1}function oe(m,P){var A=m.viewport,V=A.getZoom(),$=A.getCenter();A.resize(P,m.preserveImageSizeOnResize),A.panTo($,!0);var ge;if(m.preserveImageSizeOnResize)ge=r[m.hash].prevContainerSize.x/P.x;else{var W=new i.Point(0,0),Ee=new i.Point(r[m.hash].prevContainerSize.x,r[m.hash].prevContainerSize.y).distanceTo(W),Ie=new i.Point(P.x,P.y).distanceTo(W);ge=Ie/Ee*r[m.hash].prevContainerSize.x/P.x}A.zoomTo(V*ge,null,!0),r[m.hash].prevContainerSize=P,r[m.hash].forceRedraw=!0,r[m.hash].needsResize=!1,r[m.hash].forceResize=!1}function O(m){if(!(m._opening||!r[m.hash])){if(m.autoResize||r[m.hash].forceResize){var P;if(m._autoResizePolling){P=o(m.container);var A=r[m.hash].prevContainerSize;P.equals(A)||(r[m.hash].needsResize=!0)}r[m.hash].needsResize&&oe(m,P||o(m.container))}var V=m.viewport.update(),$=m.world.update(V)||V;V&&m.raiseEvent("viewport-change"),m.referenceStrip&&($=m.referenceStrip.update(m.viewport)||$);var ge=r[m.hash].animating;!ge&&$&&(m.raiseEvent("animation-start"),T(m));var W=ge&&!$;W&&(r[m.hash].animating=!1),($||W||r[m.hash].forceRedraw||m.world.needsDraw())&&(j(m),m._drawOverlays(),m.navigator&&m.navigator.update(m.viewport),r[m.hash].forceRedraw=!1,$&&m.raiseEvent("animation")),W&&(m.raiseEvent("animation-finish"),r[m.hash].mouseInside||g(m)),r[m.hash].animating=$}}function j(m){m.imageLoader.clear(),m.world.draw(),m.raiseEvent("update-viewport",{})}function ne(m,P){return m?m+P:P}function Re(){r[this.hash].lastZoomTime=i.now(),r[this.hash].zoomFactor=this.zoomPerSecond,r[this.hash].zooming=!0,Ne(this)}function De(){r[this.hash].lastZoomTime=i.now(),r[this.hash].zoomFactor=1/this.zoomPerSecond,r[this.hash].zooming=!0,Ne(this)}function ke(){r[this.hash].zooming=!1}function Ne(m){i.requestAnimationFrame(i.delegate(m,ze))}function ze(){var m,P,A;r[this.hash].zooming&&this.viewport&&(m=i.now(),P=m-r[this.hash].lastZoomTime,A=Math.pow(r[this.hash].zoomFactor,P/1e3),this.viewport.zoomBy(A),this.viewport.applyConstraints(),r[this.hash].lastZoomTime=m,Ne(this))}function He(){this.viewport&&(r[this.hash].zooming=!1,this.viewport.zoomBy(this.zoomPerClick/1),this.viewport.applyConstraints())}function Je(){this.viewport&&(r[this.hash].zooming=!1,this.viewport.zoomBy(1/this.zoomPerClick),this.viewport.applyConstraints())}function Nt(){this.buttonGroup&&(this.buttonGroup.emulateEnter(),this.buttonGroup.emulateLeave())}function si(){this.viewport&&this.viewport.goHome()}function vt(){this.isFullPage()&&!i.isFullScreen()?this.setFullPage(!1):this.setFullScreen(!this.isFullPage()),this.buttonGroup&&this.buttonGroup.emulateLeave(),this.fullPageButton.element.focus(),this.viewport&&this.viewport.applyConstraints()}function Yt(){if(this.viewport){var m=this.viewport.getRotation();this.viewport.flipped?m+=this.rotationIncrement:m-=this.rotationIncrement,this.viewport.setRotation(m)}}function rt(){if(this.viewport){var m=this.viewport.getRotation();this.viewport.flipped?m-=this.rotationIncrement:m+=this.rotationIncrement,this.viewport.setRotation(m)}}function yt(){this.viewport.toggleFlip()}i.determineDrawer=function(m){for(let P in M){const A=M[P],V=A.prototype;if(V&&V instanceof M.DrawerBase&&i.isFunction(V.getType)&&V.getType.call(A)===m)return A}return null}})(M),(function(i){i.Navigator=function(h){var f=h.viewer,g=this,v,T;h.element||h.id?(h.element?(h.id&&i.console.warn("Given option.id for Navigator was ignored since option.element was provided and is being used instead."),h.element.id?h.id=h.element.id:h.id="navigator-"+i.now(),this.element=h.element):this.element=document.getElementById(h.id),h.controlOptions={anchor:i.ControlAnchor.NONE,attachToViewer:!1,autoFade:!1}):(h.id="navigator-"+i.now(),this.element=i.makeNeutralElement("div"),h.controlOptions={anchor:i.ControlAnchor.TOP_RIGHT,attachToViewer:!0,autoFade:h.autoFade},h.position&&(h.position==="BOTTOM_RIGHT"?h.controlOptions.anchor=i.ControlAnchor.BOTTOM_RIGHT:h.position==="BOTTOM_LEFT"?h.controlOptions.anchor=i.ControlAnchor.BOTTOM_LEFT:h.position==="TOP_RIGHT"?h.controlOptions.anchor=i.ControlAnchor.TOP_RIGHT:h.position==="TOP_LEFT"?h.controlOptions.anchor=i.ControlAnchor.TOP_LEFT:h.position==="ABSOLUTE"&&(h.controlOptions.anchor=i.ControlAnchor.ABSOLUTE,h.controlOptions.top=h.top,h.controlOptions.left=h.left,h.controlOptions.height=h.height,h.controlOptions.width=h.width))),this.element.id=h.id,this.element.className+=" navigator",h=i.extend(!0,{sizeRatio:i.DEFAULT_SETTINGS.navigatorSizeRatio},h,{element:this.element,tabIndex:-1,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1,immediateRender:!0,blendTime:0,animationTime:h.animationTime,autoResize:!1,minZoomImageRatio:1,background:h.background,opacity:h.opacity,borderColor:h.borderColor,displayRegionColor:h.displayRegionColor}),h.minPixelRatio=this.minPixelRatio=f.minPixelRatio,i.setElementTouchActionNone(this.element),this.borderWidth=2,this.fudge=new i.Point(1,1),this.totalBorderWidths=new i.Point(this.borderWidth*2,this.borderWidth*2).minus(this.fudge),h.controlOptions.anchor!==i.ControlAnchor.NONE&&(function(C,D){C.margin="0px",C.border=D+"px solid "+h.borderColor,C.padding="0px",C.background=h.background,C.opacity=h.opacity,C.overflow="hidden"})(this.element.style,this.borderWidth),this.displayRegion=i.makeNeutralElement("div"),this.displayRegion.id=this.element.id+"-displayregion",this.displayRegion.className="displayregion",(function(C,D){C.position="relative",C.top="0px",C.left="0px",C.fontSize="0px",C.overflow="hidden",C.border=D+"px solid "+h.displayRegionColor,C.margin="0px",C.padding="0px",C.background="transparent",C.float="left",C.cssFloat="left",C.zIndex=999999999,C.cursor="default",C.boxSizing="content-box"})(this.displayRegion.style,this.borderWidth),i.setElementPointerEventsNone(this.displayRegion),i.setElementTouchActionNone(this.displayRegion),this.displayRegionContainer=i.makeNeutralElement("div"),this.displayRegionContainer.id=this.element.id+"-displayregioncontainer",this.displayRegionContainer.className="displayregioncontainer",this.displayRegionContainer.style.width="100%",this.displayRegionContainer.style.height="100%",i.setElementPointerEventsNone(this.displayRegionContainer),i.setElementTouchActionNone(this.displayRegionContainer),f.addControl(this.element,h.controlOptions),this._resizeWithViewer=h.controlOptions.anchor!==i.ControlAnchor.ABSOLUTE&&h.controlOptions.anchor!==i.ControlAnchor.NONE,h.width&&h.height?(this.setWidth(h.width),this.setHeight(h.height)):this._resizeWithViewer&&(v=i.getElementSize(f.element),this.element.style.height=Math.round(v.y*h.sizeRatio)+"px",this.element.style.width=Math.round(v.x*h.sizeRatio)+"px",this.oldViewerSize=v,T=i.getElementSize(this.element),this.elementArea=T.x*T.y),this.oldContainerSize=new i.Point(0,0),i.Viewer.apply(this,[h]),this.displayRegionContainer.appendChild(this.displayRegion),this.element.getElementsByTagName("div")[0].appendChild(this.displayRegionContainer);function E(C,D){d(g.displayRegionContainer,C),d(g.displayRegion,-C),g.viewport.setRotation(C,D)}if(h.navigatorRotate){var _=h.viewer.viewport?h.viewer.viewport.getRotation():h.viewer.degrees||0;E(_,!0),h.viewer.addHandler("rotate",function(C){E(C.degrees,C.immediately)})}this.innerTracker.destroy(),this.innerTracker=new i.MouseTracker({userData:"Navigator.innerTracker",element:this.element,dragHandler:i.delegate(this,a),clickHandler:i.delegate(this,r),releaseHandler:i.delegate(this,o),scrollHandler:i.delegate(this,l),preProcessEventHandler:function(C){C.eventType==="wheel"&&(C.preventDefault=!0)}}),this.outerTracker.userData="Navigator.outerTracker",i.setElementPointerEventsNone(this.canvas),i.setElementPointerEventsNone(this.container),this.addHandler("reset-size",function(){g.viewport&&g.viewport.goHome(!0)}),f.world.addHandler("item-index-change",function(C){window.setTimeout(function(){var D=g.world.getItemAt(C.previousIndex);g.world.setItemIndex(D,C.newIndex)},1)}),f.world.addHandler("remove-item",function(C){var D=C.item,H=g._getMatchingItem(D);H&&g.world.removeItem(H)}),this.update(f.viewport)},i.extend(i.Navigator.prototype,i.EventSource.prototype,i.Viewer.prototype,{updateSize:function(){if(this.viewport){var h=new i.Point(this.container.clientWidth===0?1:this.container.clientWidth,this.container.clientHeight===0?1:this.container.clientHeight);h.equals(this.oldContainerSize)||(this.viewport.resize(h,!0),this.viewport.goHome(!0),this.oldContainerSize=h,this.world.update(),this.world.draw(),this.update(this.viewer.viewport))}},setWidth:function(h){this.width=h,this.element.style.width=typeof h=="number"?h+"px":h,this._resizeWithViewer=!1,this.updateSize()},setHeight:function(h){this.height=h,this.element.style.height=typeof h=="number"?h+"px":h,this._resizeWithViewer=!1,this.updateSize()},setFlip:function(h){return this.viewport.setFlip(h),this.setDisplayTransform(this.viewer.viewport.getFlip()?"scale(-1,1)":"scale(1,1)"),this},setDisplayTransform:function(h){u(this.canvas,h),u(this.element,h)},update:function(h){var f,g,v,T,E,_;if(h||(h=this.viewer.viewport),f=i.getElementSize(this.viewer.element),this._resizeWithViewer&&f.x&&f.y&&!f.equals(this.oldViewerSize)&&(this.oldViewerSize=f,this.maintainSizeRatio||!this.elementArea?(g=f.x*this.sizeRatio,v=f.y*this.sizeRatio):(g=Math.sqrt(this.elementArea*(f.x/f.y)),v=this.elementArea/g),this.element.style.width=Math.round(g)+"px",this.element.style.height=Math.round(v)+"px",this.elementArea||(this.elementArea=g*v),this.updateSize()),h&&this.viewport){if(T=h.getBoundsNoRotate(!0),E=this.viewport.pixelFromPointNoRotate(T.getTopLeft(),!1),_=this.viewport.pixelFromPointNoRotate(T.getBottomRight(),!1).minus(this.totalBorderWidths),!this.navigatorRotate){var C=h.getRotation(!0);d(this.displayRegion,-C)}var D=this.displayRegion.style;D.display=this.world.getItemCount()?"block":"none",D.top=E.y.toFixed(2)+"px",D.left=E.x.toFixed(2)+"px";var H=_.x-E.x,N=_.y-E.y;D.width=Math.round(Math.max(H,0))+"px",D.height=Math.round(Math.max(N,0))+"px"}},addTiledImage:function(h){var f=this,g=h.originalTiledImage;delete h.original;var v=i.extend({},h,{success:function(T){var E=T.item;E._originalForNavigator=g,f._matchBounds(E,g,!0),f._matchOpacity(E,g),f._matchCompositeOperation(E,g);function _(){f._matchBounds(E,g)}function C(){f._matchOpacity(E,g)}function D(){f._matchCompositeOperation(E,g)}g.addHandler("bounds-change",_),g.addHandler("clip-change",_),g.addHandler("opacity-change",C),g.addHandler("composite-operation-change",D)}});return i.Viewer.prototype.addTiledImage.apply(this,[v])},destroy:function(){return i.Viewer.prototype.destroy.apply(this)},_getMatchingItem:function(h){for(var f=this.world.getItemCount(),g,v=0;v<f;v++)if(g=this.world.getItemAt(v),g._originalForNavigator===h)return g;return null},_matchBounds:function(h,f,g){var v=f.getBoundsNoRotate();h.setPosition(v.getTopLeft(),g),h.setWidth(v.width,g),h.setRotation(f.getRotation(),g),h.setClip(f.getClip()),h.setFlip(f.getFlip())},_matchOpacity:function(h,f){h.setOpacity(f.opacity)},_matchCompositeOperation:function(h,f){h.setCompositeOperation(f.compositeOperation)}});function r(h){var f={tracker:h.eventSource,position:h.position,quick:h.quick,shift:h.shift,originalEvent:h.originalEvent,preventDefaultAction:!1};if(this.viewer.raiseEvent("navigator-click",f),!f.preventDefaultAction&&h.quick&&this.viewer.viewport&&(this.panVertical||this.panHorizontal)){this.viewer.viewport.flipped&&(h.position.x=this.viewport.getContainerSize().x-h.position.x);var g=this.viewport.pointFromPixel(h.position);this.panVertical?this.panHorizontal||(g.x=this.viewer.viewport.getCenter(!0).x):g.y=this.viewer.viewport.getCenter(!0).y,this.viewer.viewport.panTo(g),this.viewer.viewport.applyConstraints()}}function a(h){var f={tracker:h.eventSource,position:h.position,delta:h.delta,speed:h.speed,direction:h.direction,shift:h.shift,originalEvent:h.originalEvent,preventDefaultAction:!1};this.viewer.raiseEvent("navigator-drag",f),!f.preventDefaultAction&&this.viewer.viewport&&(this.panHorizontal||(h.delta.x=0),this.panVertical||(h.delta.y=0),this.viewer.viewport.flipped&&(h.delta.x=-h.delta.x),this.viewer.viewport.panBy(this.viewport.deltaPointsFromPixels(h.delta)),this.viewer.constrainDuringPan&&this.viewer.viewport.applyConstraints())}function o(h){h.insideElementPressed&&this.viewer.viewport&&this.viewer.viewport.applyConstraints()}function l(h){var f={tracker:h.eventSource,position:h.position,scroll:h.scroll,shift:h.shift,originalEvent:h.originalEvent,preventDefault:h.preventDefault};this.viewer.raiseEvent("navigator-scroll",f),h.preventDefault=f.preventDefault}function d(h,f){u(h,"rotate("+f+"deg)")}function u(h,f){h.style.webkitTransform=f,h.style.mozTransform=f,h.style.msTransform=f,h.style.oTransform=f,h.style.transform=f}})(M),(function(i){var r={Errors:{Dzc:"Sorry, we don't support Deep Zoom Collections!",Dzi:"Hmm, this doesn't appear to be a valid Deep Zoom Image.",Xml:"Hmm, this doesn't appear to be a valid Deep Zoom Image.",ImageFormat:"Sorry, we don't support {0}-based Deep Zoom Images.",Security:"It looks like a security restriction stopped us from loading this Deep Zoom Image.",Status:"This space unintentionally left blank ({0} {1}).",OpenFailed:"Unable to open {0}: {1}"},Tooltips:{FullPage:"Toggle full page",Home:"Go home",ZoomIn:"Zoom in",ZoomOut:"Zoom out",NextPage:"Next page",PreviousPage:"Previous page",RotateLeft:"Rotate left",RotateRight:"Rotate right",Flip:"Flip Horizontally"}};i.extend(i,{getString:function(a){var o=a.split("."),l=null,d=arguments,u=r,h;for(h=0;h<o.length-1;h++)u=u[o[h]]||{};return l=u[o[h]],typeof l!="string"&&(i.console.error("Untranslated source string:",a),l=""),l.replace(/\{\d+\}/g,function(f){var g=parseInt(f.match(/\d+/),10)+1;return g<d.length?d[g]:""})},setString:function(a,o){var l=a.split("."),d=r,u;for(u=0;u<l.length-1;u++)d[l[u]]||(d[l[u]]={}),d=d[l[u]];d[l[u]]=o}})})(M),(function(i){i.Point=function(r,a){this.x=typeof r=="number"?r:0,this.y=typeof a=="number"?a:0},i.Point.prototype={clone:function(){return new i.Point(this.x,this.y)},plus:function(r){return new i.Point(this.x+r.x,this.y+r.y)},minus:function(r){return new i.Point(this.x-r.x,this.y-r.y)},times:function(r){return new i.Point(this.x*r,this.y*r)},divide:function(r){return new i.Point(this.x/r,this.y/r)},negate:function(){return new i.Point(-this.x,-this.y)},distanceTo:function(r){return Math.sqrt(Math.pow(this.x-r.x,2)+Math.pow(this.y-r.y,2))},squaredDistanceTo:function(r){return Math.pow(this.x-r.x,2)+Math.pow(this.y-r.y,2)},apply:function(r){return new i.Point(r(this.x),r(this.y))},equals:function(r){return r instanceof i.Point&&this.x===r.x&&this.y===r.y},rotate:function(r,a){a=a||new i.Point(0,0);var o,l;if(r%90===0){var d=i.positiveModulo(r,360);switch(d){case 0:o=1,l=0;break;case 90:o=0,l=1;break;case 180:o=-1,l=0;break;case 270:o=0,l=-1;break}}else{var u=r*Math.PI/180;o=Math.cos(u),l=Math.sin(u)}var h=o*(this.x-a.x)-l*(this.y-a.y)+a.x,f=l*(this.x-a.x)+o*(this.y-a.y)+a.y;return new i.Point(h,f)},toString:function(){return"("+Math.round(this.x*100)/100+","+Math.round(this.y*100)/100+")"}}})(M),(function(i){i.TileSource=function(a,o,l,d,u,h){var f=this,g=arguments,v,T;if(i.isPlainObject(a)?v=a:v={width:g[0],height:g[1],tileSize:g[2],tileOverlap:g[3],minLevel:g[4],maxLevel:g[5]},i.EventSource.call(this),i.extend(!0,this,v),!this.success){for(T=0;T<arguments.length;T++)if(i.isFunction(arguments[T])){this.success=arguments[T];break}}this.success&&this.addHandler("ready",function(E){f.success(E)}),i.type(arguments[0])==="string"&&(this.url=arguments[0]),this.url?(this.aspectRatio=1,this.dimensions=new i.Point(10,10),this._tileWidth=0,this._tileHeight=0,this.tileOverlap=0,this.minLevel=0,this.maxLevel=0,this.ready=!1,this.getImageInfo(this.url)):(this.ready=!0,this.aspectRatio=v.width&&v.height?v.width/v.height:1,this.dimensions=new i.Point(v.width,v.height),this.tileSize?(this._tileWidth=this._tileHeight=this.tileSize,delete this.tileSize):(this.tileWidth?(this._tileWidth=this.tileWidth,delete this.tileWidth):this._tileWidth=0,this.tileHeight?(this._tileHeight=this.tileHeight,delete this.tileHeight):this._tileHeight=0),this.tileOverlap=v.tileOverlap?v.tileOverlap:0,this.minLevel=v.minLevel?v.minLevel:0,this.maxLevel=v.maxLevel!==void 0&&v.maxLevel!==null?v.maxLevel:v.width&&v.height?Math.ceil(Math.log(Math.max(v.width,v.height))/Math.log(2)):0,this.success&&i.isFunction(this.success)&&this.success(this))},i.TileSource.prototype={getTileSize:function(a){return i.console.error("[TileSource.getTileSize] is deprecated. Use TileSource.getTileWidth() and TileSource.getTileHeight() instead"),this._tileWidth},getTileWidth:function(a){return this._tileWidth?this._tileWidth:this.getTileSize(a)},getTileHeight:function(a){return this._tileHeight?this._tileHeight:this.getTileSize(a)},setMaxLevel:function(a){this.maxLevel=a,this._memoizeLevelScale()},getLevelScale:function(a){return this._memoizeLevelScale(),this.getLevelScale(a)},_memoizeLevelScale:function(){var a={},o;for(o=0;o<=this.maxLevel;o++)a[o]=1/Math.pow(2,this.maxLevel-o);this.getLevelScale=function(l){return a[l]}},getNumTiles:function(a){var o=this.getLevelScale(a),l=Math.ceil(o*this.dimensions.x/this.getTileWidth(a)),d=Math.ceil(o*this.dimensions.y/this.getTileHeight(a));return new i.Point(l,d)},getPixelRatio:function(a){var o=this.dimensions.times(this.getLevelScale(a)),l=1/o.x*i.pixelDensityRatio,d=1/o.y*i.pixelDensityRatio;return new i.Point(l,d)},getClosestLevel:function(){var a,o;for(a=this.minLevel+1;a<=this.maxLevel&&(o=this.getNumTiles(a),!(o.x>1||o.y>1));a++);return a-1},getTileAtPoint:function(a,o){var l=o.x>=0&&o.x<=1&&o.y>=0&&o.y<=1/this.aspectRatio;i.console.assert(l,"[TileSource.getTileAtPoint] must be called with a valid point.");var d=this.dimensions.x*this.getLevelScale(a),u=o.x*d,h=o.y*d,f=Math.floor(u/this.getTileWidth(a)),g=Math.floor(h/this.getTileHeight(a));o.x>=1&&(f=this.getNumTiles(a).x-1);var v=1e-15;return o.y>=1/this.aspectRatio-v&&(g=this.getNumTiles(a).y-1),new i.Point(f,g)},getTileBounds:function(a,o,l,d){var u=this.dimensions.times(this.getLevelScale(a)),h=this.getTileWidth(a),f=this.getTileHeight(a),g=o===0?0:h*o-this.tileOverlap,v=l===0?0:f*l-this.tileOverlap,T=h+(o===0?1:2)*this.tileOverlap,E=f+(l===0?1:2)*this.tileOverlap,_=1/u.x;return T=Math.min(T,u.x-g),E=Math.min(E,u.y-v),d?new i.Rect(0,0,T,E):new i.Rect(g*_,v*_,T*_,E*_)},getImageInfo:function(a){var o=this,l,d,u,h,f,g,v;a&&(f=a.split("/"),g=f[f.length-1],v=g.lastIndexOf("."),v>-1&&(f[f.length-1]=g.slice(0,v)));var T=null;if(this.splitHashDataForPost){var E=a.indexOf("#");E!==-1&&(T=a.substring(E+1),a=a.substr(0,E))}d=function(_){typeof _=="string"&&(_=i.parseXml(_));var C=i.TileSource.determineType(o,_,a);if(!C){o.raiseEvent("open-failed",{message:"Unable to load TileSource",source:a});return}h=C.prototype.configure.apply(o,[_,a,T]),h.ajaxWithCredentials===void 0&&(h.ajaxWithCredentials=o.ajaxWithCredentials),u=new C(h),o.ready=!0,o.raiseEvent("ready",{tileSource:u})},a.match(/\.js$/)?(l=a.split("/").pop().replace(".js",""),i.jsonp({url:a,async:!1,callbackName:l,callback:d})):i.makeAjaxRequest({url:a,postData:T,withCredentials:this.ajaxWithCredentials,headers:this.ajaxHeaders,success:function(_){var C=r(_);d(C)},error:function(_,C){var D;try{D="HTTP "+_.status+" attempting to load TileSource: "+a}catch{var H;typeof C>"u"||!C.toString?H="Unknown error":H=C.toString(),D=H+" attempting to load TileSource: "+a}i.console.error(D),o.raiseEvent("open-failed",{message:D,source:a,postData:T})}})},supports:function(a,o){return!1},configure:function(a,o,l){throw new Error("Method not implemented.")},getTileUrl:function(a,o,l){throw new Error("Method not implemented.")},getTilePostData:function(a,o,l){return null},getTileAjaxHeaders:function(a,o,l){return{}},getTileHashKey:function(a,o,l,d,u,h){function f(g){return u?g+"+"+JSON.stringify(u):g}return f(typeof d!="string"?a+"/"+o+"_"+l:d)},tileExists:function(a,o,l){var d=this.getNumTiles(a);return a>=this.minLevel&&a<=this.maxLevel&&o>=0&&l>=0&&o<d.x&&l<d.y},hasTransparency:function(a,o,l,d){return!!a||o.match(".png")},downloadTileStart:function(a){var o=a.userData,l=new Image;o.image=l,o.request=null;var d=function(u){if(!l){a.finish(null,o.request,"Image load failed: undefined Image instance.");return}l.onload=l.onerror=l.onabort=null,a.finish(u?null:l,o.request,u)};l.onload=function(){d()},l.onabort=l.onerror=function(){d("Image load aborted.")},a.loadWithAjax?o.request=i.makeAjaxRequest({url:a.src,withCredentials:a.ajaxWithCredentials,headers:a.ajaxHeaders,responseType:"arraybuffer",postData:a.postData,success:function(u){var h;try{h=new window.Blob([u.response])}catch(v){var f=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;if(v.name==="TypeError"&&f){var g=new f;g.append(u.response),h=g.getBlob()}}h.size===0?d("Empty image response."):l.src=(window.URL||window.webkitURL).createObjectURL(h)},error:function(u){d("Image load aborted - XHR error")}}):(a.crossOriginPolicy!==!1&&(l.crossOrigin=a.crossOriginPolicy),l.src=a.src)},downloadTileAbort:function(a){a.userData.request&&a.userData.request.abort();var o=a.userData.image;a.userData.image&&(o.onload=o.onerror=o.onabort=null)},createTileCache:function(a,o,l){a._data=o},destroyTileCache:function(a){a._data=null,a._renderedContext=null},getTileCacheData:function(a){return a._data},getTileCacheDataAsImage:function(a){return a._data},getTileCacheDataAsContext2D:function(a){if(!a._renderedContext){var o=document.createElement("canvas");o.width=a._data.width,o.height=a._data.height,a._renderedContext=o.getContext("2d"),a._renderedContext.drawImage(a._data,0,0),a._data=null}return a._renderedContext}},i.extend(!0,i.TileSource.prototype,i.EventSource.prototype);function r(a){var o=a.responseText,l=a.status,d,u;if(a){if(a.status!==200&&a.status!==0)throw l=a.status,d=l===404?"Not Found":a.statusText,new Error(i.getString("Errors.Status",l,d))}else throw new Error(i.getString("Errors.Security"));if(o.match(/^\s*<.*/))try{u=a.responseXML&&a.responseXML.documentElement?a.responseXML:i.parseXml(o)}catch{u=a.responseText}else if(o.match(/\s*[{[].*/))try{u=i.parseJSON(o)}catch{u=o}else u=o;return u}i.TileSource.determineType=function(a,o,l){var d;for(d in M)if(d.match(/.+TileSource$/)&&i.isFunction(M[d])&&i.isFunction(M[d].prototype.supports)&&M[d].prototype.supports.call(a,o,l))return M[d];return i.console.error("No TileSource was able to open %s %s",l,o),null}})(M),(function(i){i.DziTileSource=function(o,l,d,u,h,f,g,v,T){var E,_,C,D;if(i.isPlainObject(o)?D=o:D={width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4],fileFormat:arguments[5],displayRects:arguments[6],minLevel:arguments[7],maxLevel:arguments[8]},this._levelRects={},this.tilesUrl=D.tilesUrl,this.fileFormat=D.fileFormat,this.displayRects=D.displayRects,this.displayRects)for(E=this.displayRects.length-1;E>=0;E--)for(_=this.displayRects[E],C=_.minLevel;C<=_.maxLevel;C++)this._levelRects[C]||(this._levelRects[C]=[]),this._levelRects[C].push(_);i.TileSource.apply(this,[D])},i.extend(i.DziTileSource.prototype,i.TileSource.prototype,{supports:function(o,l){var d;return o.Image?d=o.Image.xmlns:o.documentElement&&(o.documentElement.localName==="Image"||o.documentElement.tagName==="Image")&&(d=o.documentElement.namespaceURI),d=(d||"").toLowerCase(),d.indexOf("schemas.microsoft.com/deepzoom/2008")!==-1||d.indexOf("schemas.microsoft.com/deepzoom/2009")!==-1},configure:function(o,l,d){var u;return i.isPlainObject(o)?u=a(this,o):u=r(this,o),l&&!u.tilesUrl&&(u.tilesUrl=l.replace(/([^/]+?)(\.(dzi|xml|js)?(\?[^/]*)?)?\/?$/,"$1_files/"),l.search(/\.(dzi|xml|js)\?/)!==-1?u.queryParams=l.match(/\?.*/):u.queryParams=""),u},getTileUrl:function(o,l,d){return[this.tilesUrl,o,"/",l,"_",d,".",this.fileFormat,this.queryParams].join("")},tileExists:function(o,l,d){var u=this._levelRects[o],h,f,g,v,T,E,_;if(this.minLevel&&o<this.minLevel||this.maxLevel&&o>this.maxLevel)return!1;if(!u||!u.length)return!0;for(_=u.length-1;_>=0;_--)if(h=u[_],!(o<h.minLevel||o>h.maxLevel)&&(f=this.getLevelScale(o),g=h.x*f,v=h.y*f,T=g+h.width*f,E=v+h.height*f,g=Math.floor(g/this._tileWidth),v=Math.floor(v/this._tileWidth),T=Math.ceil(T/this._tileWidth),E=Math.ceil(E/this._tileWidth),g<=l&&l<T&&v<=d&&d<E))return!0;return!1}});function r(o,l){if(!l||!l.documentElement)throw new Error(i.getString("Errors.Xml"));var d=l.documentElement,u=d.localName||d.tagName,h=l.documentElement.namespaceURI,f=null,g=[],v,T,E,_,C;if(u==="Image")try{if(_=d.getElementsByTagName("Size")[0],_===void 0&&(_=d.getElementsByTagNameNS(h,"Size")[0]),f={Image:{xmlns:"http://schemas.microsoft.com/deepzoom/2008",Url:d.getAttribute("Url"),Format:d.getAttribute("Format"),DisplayRect:null,Overlap:parseInt(d.getAttribute("Overlap"),10),TileSize:parseInt(d.getAttribute("TileSize"),10),Size:{Height:parseInt(_.getAttribute("Height"),10),Width:parseInt(_.getAttribute("Width"),10)}}},!i.imageFormatSupported(f.Image.Format))throw new Error(i.getString("Errors.ImageFormat",f.Image.Format.toUpperCase()));for(v=d.getElementsByTagName("DisplayRect"),v===void 0&&(v=d.getElementsByTagNameNS(h,"DisplayRect")[0]),C=0;C<v.length;C++)T=v[C],E=T.getElementsByTagName("Rect")[0],E===void 0&&(E=T.getElementsByTagNameNS(h,"Rect")[0]),g.push({Rect:{X:parseInt(E.getAttribute("X"),10),Y:parseInt(E.getAttribute("Y"),10),Width:parseInt(E.getAttribute("Width"),10),Height:parseInt(E.getAttribute("Height"),10),MinLevel:parseInt(T.getAttribute("MinLevel"),10),MaxLevel:parseInt(T.getAttribute("MaxLevel"),10)}});return g.length&&(f.Image.DisplayRect=g),a(o,f)}catch(N){throw N instanceof Error?N:new Error(i.getString("Errors.Dzi"))}else{if(u==="Collection")throw new Error(i.getString("Errors.Dzc"));if(u==="Error"){var D=d.getElementsByTagName("Message")[0],H=D.firstChild.nodeValue;throw new Error(H)}}throw new Error(i.getString("Errors.Dzi"))}function a(o,l){var d=l.Image,u=d.Url,h=d.Format,f=d.Size,g=d.DisplayRect||[],v=parseInt(f.Width,10),T=parseInt(f.Height,10),E=parseInt(d.TileSize,10),_=parseInt(d.Overlap,10),C=[],D,H;for(H=0;H<g.length;H++)D=g[H].Rect,C.push(new i.DisplayRect(parseInt(D.X,10),parseInt(D.Y,10),parseInt(D.Width,10),parseInt(D.Height,10),parseInt(D.MinLevel,10),parseInt(D.MaxLevel,10)));return i.extend(!0,{width:v,height:T,tileSize:E,tileOverlap:_,minLevel:null,maxLevel:null,tilesUrl:u,fileFormat:h,displayRects:C},l)}})(M),(function(i){i.IIIFTileSource=function(d){if(i.extend(!0,this,d),this._id=this["@id"]||this.id||this.identifier||null,!(this.height&&this.width&&this._id))throw new Error("IIIF required parameters (width, height, or id) not provided.");if(d.tileSizePerScaleFactor={},this.tileFormat=this.tileFormat||"jpg",this.version=d.version,this.tile_width&&this.tile_height)d.tileWidth=this.tile_width,d.tileHeight=this.tile_height;else if(this.tile_width)d.tileSize=this.tile_width;else if(this.tile_height)d.tileSize=this.tile_height;else if(this.tiles)if(this.tiles.length===1)d.tileWidth=this.tiles[0].width,d.tileHeight=this.tiles[0].height||this.tiles[0].width,this.scale_factors=this.tiles[0].scaleFactors;else{this.scale_factors=[];for(var u=0;u<this.tiles.length;u++)for(var h=0;h<this.tiles[u].scaleFactors.length;h++){var f=this.tiles[u].scaleFactors[h];this.scale_factors.push(f),d.tileSizePerScaleFactor[f]={width:this.tiles[u].width,height:this.tiles[u].height||this.tiles[u].width}}}else if(r(d)){for(var g=Math.min(this.height,this.width),v=[256,512,1024],T=[],E=0;E<v.length;E++)v[E]<=g&&T.push(v[E]);T.length>0?d.tileSize=Math.max.apply(null,T):d.tileSize=g}else this.sizes&&this.sizes.length>0?(this.emulateLegacyImagePyramid=!0,d.levels=a(this),i.extend(!0,d,{width:d.levels[d.levels.length-1].width,height:d.levels[d.levels.length-1].height,tileSize:Math.max(d.height,d.width),tileOverlap:0,minLevel:0,maxLevel:d.levels.length-1}),this.levels=d.levels):i.console.error("Nothing in the info.json to construct image pyramids from");if(!d.maxLevel&&!this.emulateLegacyImagePyramid)if(!this.scale_factors)d.maxLevel=Number(Math.round(Math.log(Math.max(this.width,this.height),2)));else{var _=Math.max.apply(null,this.scale_factors);d.maxLevel=Math.round(Math.log(_)*Math.LOG2E)}if(this.sizes){var C=this.sizes.length;(C===d.maxLevel||C===d.maxLevel+1)&&(this.levelSizes=this.sizes.slice().sort((D,H)=>D.width-H.width),C===d.maxLevel&&this.levelSizes.push({width:this.width,height:this.height}))}i.TileSource.apply(this,[d])},i.extend(i.IIIFTileSource.prototype,i.TileSource.prototype,{supports:function(d,u){return d.protocol&&d.protocol==="http://iiif.io/api/image"||d["@context"]&&(d["@context"]==="http://library.stanford.edu/iiif/image-api/1.1/context.json"||d["@context"]==="http://iiif.io/api/image/1/context.json")||d.profile&&d.profile.indexOf("http://library.stanford.edu/iiif/image-api/compliance.html")===0||d.identifier&&d.width&&d.height?!0:!!(d.documentElement&&d.documentElement.tagName==="info"&&d.documentElement.namespaceURI==="http://library.stanford.edu/iiif/image-api/ns/")},configure:function(d,u,h){if(i.isPlainObject(d)){if(!d["@context"])d["@context"]="http://iiif.io/api/image/1.0/context.json",d["@id"]=u.replace("/info.json",""),d.version=1;else{var g=d["@context"];if(Array.isArray(g)){for(var v=0;v<g.length;v++)if(typeof g[v]=="string"&&(/^http:\/\/iiif\.io\/api\/image\/[1-3]\/context\.json$/.test(g[v])||g[v]==="http://library.stanford.edu/iiif/image-api/1.1/context.json")){g=g[v];break}}switch(g){case"http://iiif.io/api/image/1/context.json":case"http://library.stanford.edu/iiif/image-api/1.1/context.json":d.version=1;break;case"http://iiif.io/api/image/2/context.json":d.version=2;break;case"http://iiif.io/api/image/3/context.json":d.version=3;break;default:i.console.error("Data has a @context property which contains no known IIIF context URI.")}}if(d.preferredFormats){for(var T=0;T<d.preferredFormats.length;T++)if(M.imageFormatSupported(d.preferredFormats[T])){d.tileFormat=d.preferredFormats[T];break}}return d}else{var f=o(d);return f["@context"]="http://iiif.io/api/image/1.0/context.json",f["@id"]=u.replace("/info.xml",""),f.version=1,f}},getTileWidth:function(d){if(this.emulateLegacyImagePyramid)return i.TileSource.prototype.getTileWidth.call(this,d);var u=Math.pow(2,this.maxLevel-d);return this.tileSizePerScaleFactor&&this.tileSizePerScaleFactor[u]?this.tileSizePerScaleFactor[u].width:this._tileWidth},getTileHeight:function(d){if(this.emulateLegacyImagePyramid)return i.TileSource.prototype.getTileHeight.call(this,d);var u=Math.pow(2,this.maxLevel-d);return this.tileSizePerScaleFactor&&this.tileSizePerScaleFactor[u]?this.tileSizePerScaleFactor[u].height:this._tileHeight},getLevelScale:function(d){if(this.emulateLegacyImagePyramid){var u=NaN;return this.levels.length>0&&d>=this.minLevel&&d<=this.maxLevel&&(u=this.levels[d].width/this.levels[this.maxLevel].width),u}return i.TileSource.prototype.getLevelScale.call(this,d)},getNumTiles:function(d){if(this.emulateLegacyImagePyramid){var u=this.getLevelScale(d);return u?new i.Point(1,1):new i.Point(0,0)}if(this.levelSizes){var h=this.levelSizes[d],f=Math.ceil(h.width/this.getTileWidth(d)),g=Math.ceil(h.height/this.getTileHeight(d));return new i.Point(f,g)}else return i.TileSource.prototype.getNumTiles.call(this,d)},getTileAtPoint:function(d,u){if(this.emulateLegacyImagePyramid)return new i.Point(0,0);if(this.levelSizes){var h=u.x>=0&&u.x<=1&&u.y>=0&&u.y<=1/this.aspectRatio;i.console.assert(h,"[TileSource.getTileAtPoint] must be called with a valid point.");var f=this.levelSizes[d].width,g=u.x*f,v=u.y*f,T=Math.floor(g/this.getTileWidth(d)),E=Math.floor(v/this.getTileHeight(d));u.x>=1&&(T=this.getNumTiles(d).x-1);var _=1e-15;return u.y>=1/this.aspectRatio-_&&(E=this.getNumTiles(d).y-1),new i.Point(T,E)}return i.TileSource.prototype.getTileAtPoint.call(this,d,u)},getTileUrl:function(d,u,h){if(this.emulateLegacyImagePyramid){var f=null;return this.levels.length>0&&d>=this.minLevel&&d<=this.maxLevel&&(f=this.levels[d].url),f}var g="0",v=Math.pow(.5,this.maxLevel-d),T,E,_,C,D,H,N,J,Q,ee,he,ie,ue,se,pe,re;return this.levelSizes?(T=this.levelSizes[d].width,E=this.levelSizes[d].height):(T=Math.ceil(this.width*v),E=Math.ceil(this.height*v)),_=this.getTileWidth(d),C=this.getTileHeight(d),D=Math.round(_/v),H=Math.round(C/v),this.version===1?pe="native."+this.tileFormat:pe="default."+this.tileFormat,T<_&&E<C?(this.version===2&&T===this.width?ie="full":this.version===3&&T===this.width&&E===this.height?ie="max":this.version===3?ie=T+","+E:ie=T+",",N="full"):(J=u*D,Q=h*H,ee=Math.min(D,this.width-J),he=Math.min(H,this.height-Q),u===0&&h===0&&ee===this.width&&he===this.height?N="full":N=[J,Q,ee,he].join(","),ue=Math.min(_,T-u*_),se=Math.min(C,E-h*C),this.version===2&&ue===this.width?ie="full":this.version===3&&ue===this.width&&se===this.height?ie="max":this.version===3?ie=ue+","+se:ie=ue+","),re=[this._id,N,ie,g,pe].join("/"),re},__testonly__:{canBeTiled:r,constructLevels:a}});function r(d){var u=["http://library.stanford.edu/iiif/image-api/compliance.html#level0","http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0","http://iiif.io/api/image/2/level0.json","level0","https://iiif.io/api/image/3/level0.json"],h=Array.isArray(d.profile)?d.profile[0]:d.profile,f=u.indexOf(h)!==-1,g=!1;return d.version===2&&d.profile.length>1&&d.profile[1].supports&&(g=d.profile[1].supports.indexOf("sizeByW")!==-1),d.version===3&&d.extraFeatures&&(g=d.extraFeatures.indexOf("sizeByWh")!==-1),!f||g}function a(d){for(var u=[],h=0;h<d.sizes.length;h++)u.push({url:d._id+"/full/"+d.sizes[h].width+","+(d.version===3?d.sizes[h].height:"")+"/0/default."+d.tileFormat,width:d.sizes[h].width,height:d.sizes[h].height});return u.sort(function(f,g){return f.width-g.width})}function o(d){if(!d||!d.documentElement)throw new Error(i.getString("Errors.Xml"));var u=d.documentElement,h=u.tagName,f=null;if(h==="info")try{return f={},l(u,f),f}catch(g){throw g instanceof Error?g:new Error(i.getString("Errors.IIIF"))}throw new Error(i.getString("Errors.IIIF"))}function l(d,u,h){var f,g;if(d.nodeType===3&&h)g=d.nodeValue.trim(),g.match(/^\d*$/)&&(g=Number(g)),u[h]?(i.isArray(u[h])||(u[h]=[u[h]]),u[h].push(g)):u[h]=g;else if(d.nodeType===1)for(f=0;f<d.childNodes.length;f++)l(d.childNodes[f],u,d.nodeName)}})(M),(function(i){i.OsmTileSource=function(r,a,o,l,d){var u;i.isPlainObject(r)?u=r:u={width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4]},(!u.width||!u.height)&&(u.width=65572864,u.height=65572864),u.tileSize||(u.tileSize=256,u.tileOverlap=0),u.tilesUrl||(u.tilesUrl="http://tile.openstreetmap.org/"),u.minLevel=8,i.TileSource.apply(this,[u])},i.extend(i.OsmTileSource.prototype,i.TileSource.prototype,{supports:function(r,a){return r.type&&r.type==="openstreetmaps"},configure:function(r,a,o){return r},getTileUrl:function(r,a,o){return this.tilesUrl+(r-8)+"/"+a+"/"+o+".png"}})})(M),(function(i){i.TmsTileSource=function(r,a,o,l,d){var u;i.isPlainObject(r)?u=r:u={width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4]};var h=Math.ceil(u.width/256)*256,f=Math.ceil(u.height/256)*256,g;h>f?g=h/256:g=f/256,u.maxLevel=Math.ceil(Math.log(g)/Math.log(2))-1,u.tileSize=256,u.width=h,u.height=f,i.TileSource.apply(this,[u])},i.extend(i.TmsTileSource.prototype,i.TileSource.prototype,{supports:function(r,a){return r.type&&r.type==="tiledmapservice"},configure:function(r,a,o){return r},getTileUrl:function(r,a,o){var l=this.getNumTiles(r).y-1;return this.tilesUrl+r+"/"+a+"/"+(l-o)+".png"}})})(M),(function(i){i.ZoomifyTileSource=function(r){typeof r.tileSize>"u"&&(r.tileSize=256),typeof r.fileFormat>"u"&&(r.fileFormat="jpg",this.fileFormat=r.fileFormat);var a={x:r.width,y:r.height};for(r.imageSizes=[{x:r.width,y:r.height}],r.gridSize=[this._getGridSize(r.width,r.height,r.tileSize)];parseInt(a.x,10)>r.tileSize||parseInt(a.y,10)>r.tileSize;)a.x=Math.floor(a.x/2),a.y=Math.floor(a.y/2),r.imageSizes.push({x:a.x,y:a.y}),r.gridSize.push(this._getGridSize(a.x,a.y,r.tileSize));r.imageSizes.reverse(),r.gridSize.reverse(),r.minLevel=0,r.maxLevel=r.gridSize.length-1,M.TileSource.apply(this,[r])},i.extend(i.ZoomifyTileSource.prototype,i.TileSource.prototype,{_getGridSize:function(r,a,o){return{x:Math.ceil(r/o),y:Math.ceil(a/o)}},_calculateAbsoluteTileNumber:function(r,a,o){for(var l=0,d={},u=0;u<r;u++)d=this.gridSize[u],l+=d.x*d.y;return d=this.gridSize[r],l+=d.x*o+a,l},supports:function(r,a){return r.type&&r.type==="zoomifytileservice"},configure:function(r,a,o){return r},getTileUrl:function(r,a,o){var l=0,d=this._calculateAbsoluteTileNumber(r,a,o);return l=Math.floor(d/256),this.tilesUrl+"TileGroup"+l+"/"+r+"-"+a+"-"+o+"."+this.fileFormat}})})(M),(function(i){i.LegacyTileSource=function(l){var d,u,h;i.isArray(l)&&(d={type:"legacy-image-pyramid",levels:l}),d.levels=r(d.levels),d.levels.length>0?(u=d.levels[d.levels.length-1].width,h=d.levels[d.levels.length-1].height):(u=0,h=0,i.console.error("No supported image formats found")),i.extend(!0,d,{width:u,height:h,tileSize:Math.max(h,u),tileOverlap:0,minLevel:0,maxLevel:d.levels.length>0?d.levels.length-1:0}),i.TileSource.apply(this,[d]),this.levels=d.levels},i.extend(i.LegacyTileSource.prototype,i.TileSource.prototype,{supports:function(l,d){return l.type&&l.type==="legacy-image-pyramid"||l.documentElement&&l.documentElement.getAttribute("type")==="legacy-image-pyramid"},configure:function(l,d,u){var h;return i.isPlainObject(l)?h=o(this,l):h=a(this,l),h},getLevelScale:function(l){var d=NaN;return this.levels.length>0&&l>=this.minLevel&&l<=this.maxLevel&&(d=this.levels[l].width/this.levels[this.maxLevel].width),d},getNumTiles:function(l){var d=this.getLevelScale(l);return d?new i.Point(1,1):new i.Point(0,0)},getTileUrl:function(l,d,u){var h=null;return this.levels.length>0&&l>=this.minLevel&&l<=this.maxLevel&&(h=this.levels[l].url),h}});function r(l){var d=[],u,h;for(h=0;h<l.length;h++)u=l[h],u.height&&u.width&&u.url?d.push({url:u.url,width:Number(u.width),height:Number(u.height)}):i.console.error("Unsupported image format: %s",u.url?u.url:"<no URL>");return d.sort(function(f,g){return f.height-g.height})}function a(l,d){if(!d||!d.documentElement)throw new Error(i.getString("Errors.Xml"));var u=d.documentElement,h=u.tagName,f=null,g=[],v,T;if(h==="image")try{for(f={type:u.getAttribute("type"),levels:[]},g=u.getElementsByTagName("level"),T=0;T<g.length;T++)v=g[T],f.levels.push({url:v.getAttribute("url"),width:parseInt(v.getAttribute("width"),10),height:parseInt(v.getAttribute("height"),10)});return o(l,f)}catch(E){throw E instanceof Error?E:new Error("Unknown error parsing Legacy Image Pyramid XML.")}else{if(h==="collection")throw new Error("Legacy Image Pyramid Collections not yet supported.");if(h==="error")throw new Error("Error: "+d)}throw new Error("Unknown element "+h)}function o(l,d){return d.levels}})(M),(function(i){i.ImageTileSource=function(r){r=i.extend({buildPyramid:!0,crossOriginPolicy:!1,ajaxWithCredentials:!1},r),i.TileSource.apply(this,[r])},i.extend(i.ImageTileSource.prototype,i.TileSource.prototype,{supports:function(r,a){return r.type&&r.type==="image"},configure:function(r,a,o){return r},getImageInfo:function(r){var a=this._image=new Image,o=this;this.crossOriginPolicy&&(a.crossOrigin=this.crossOriginPolicy),this.ajaxWithCredentials&&(a.useCredentials=this.ajaxWithCredentials),i.addEvent(a,"load",function(){o.width=a.naturalWidth,o.height=a.naturalHeight,o.aspectRatio=o.width/o.height,o.dimensions=new i.Point(o.width,o.height),o._tileWidth=o.width,o._tileHeight=o.height,o.tileOverlap=0,o.minLevel=0,o.levels=o._buildLevels(),o.maxLevel=o.levels.length-1,o.ready=!0,o.raiseEvent("ready",{tileSource:o})}),i.addEvent(a,"error",function(){o.raiseEvent("open-failed",{message:"Error loading image at "+r,source:r})}),a.src=r},getLevelScale:function(r){var a=NaN;return r>=this.minLevel&&r<=this.maxLevel&&(a=this.levels[r].width/this.levels[this.maxLevel].width),a},getNumTiles:function(r){var a=this.getLevelScale(r);return a?new i.Point(1,1):new i.Point(0,0)},getTileUrl:function(r,a,o){var l=null;return r>=this.minLevel&&r<=this.maxLevel&&(l=this.levels[r].url),l},getContext2D:function(r,a,o){var l=null;return r>=this.minLevel&&r<=this.maxLevel&&(l=this.levels[r].context2D),l},destroy:function(r){this._freeupCanvasMemory(r)},_buildLevels:function(){var r=[{url:this._image.src,width:this._image.naturalWidth,height:this._image.naturalHeight}];if(!this.buildPyramid||!i.supportsCanvas)return delete this._image,r;var a=this._image.naturalWidth,o=this._image.naturalHeight,l=document.createElement("canvas"),d=l.getContext("2d");if(l.width=a,l.height=o,d.drawImage(this._image,0,0,a,o),r[0].context2D=d,delete this._image,i.isCanvasTainted(l))return r;for(;a>=2&&o>=2;){a=Math.floor(a/2),o=Math.floor(o/2);var u=document.createElement("canvas"),h=u.getContext("2d");u.width=a,u.height=o,h.drawImage(l,0,0,a,o),r.splice(0,0,{context2D:h,width:a,height:o}),l=u,d=h}return r},_freeupCanvasMemory:function(r){for(var a=0;a<this.levels.length;a++)this.levels[a].context2D&&(this.levels[a].context2D.canvas.height=0,this.levels[a].context2D.canvas.width=0,r&&r.raiseEvent("image-unloaded",{context2D:this.levels[a].context2D}))}})})(M),(function(i){i.TileSourceCollection=function(r,a,o,l){i.console.error("TileSourceCollection is deprecated; use World instead")}})(M),(function(i){i.ButtonState={REST:0,GROUP:1,HOVER:2,DOWN:3},i.Button=function(h){var f=this;i.EventSource.call(this),i.extend(!0,this,{tooltip:null,srcRest:null,srcGroup:null,srcHover:null,srcDown:null,clickTimeThreshold:i.DEFAULT_SETTINGS.clickTimeThreshold,clickDistThreshold:i.DEFAULT_SETTINGS.clickDistThreshold,fadeDelay:0,fadeLength:2e3,onPress:null,onRelease:null,onClick:null,onEnter:null,onExit:null,onFocus:null,onBlur:null,userData:null},h),this.element=h.element||i.makeNeutralElement("div"),h.element||(this.imgRest=i.makeTransparentImage(this.srcRest),this.imgGroup=i.makeTransparentImage(this.srcGroup),this.imgHover=i.makeTransparentImage(this.srcHover),this.imgDown=i.makeTransparentImage(this.srcDown),this.imgRest.alt=this.imgGroup.alt=this.imgHover.alt=this.imgDown.alt=this.tooltip,i.setElementPointerEventsNone(this.imgRest),i.setElementPointerEventsNone(this.imgGroup),i.setElementPointerEventsNone(this.imgHover),i.setElementPointerEventsNone(this.imgDown),this.element.style.position="relative",i.setElementTouchActionNone(this.element),this.imgGroup.style.position=this.imgHover.style.position=this.imgDown.style.position="absolute",this.imgGroup.style.top=this.imgHover.style.top=this.imgDown.style.top="0px",this.imgGroup.style.left=this.imgHover.style.left=this.imgDown.style.left="0px",this.imgHover.style.visibility=this.imgDown.style.visibility="hidden",this.element.appendChild(this.imgRest),this.element.appendChild(this.imgGroup),this.element.appendChild(this.imgHover),this.element.appendChild(this.imgDown)),this.addHandler("press",this.onPress),this.addHandler("release",this.onRelease),this.addHandler("click",this.onClick),this.addHandler("enter",this.onEnter),this.addHandler("exit",this.onExit),this.addHandler("focus",this.onFocus),this.addHandler("blur",this.onBlur),this.currentState=i.ButtonState.GROUP,this.fadeBeginTime=null,this.shouldFade=!1,this.element.style.display="inline-block",this.element.style.position="relative",this.element.title=this.tooltip,this.tracker=new i.MouseTracker({userData:"Button.tracker",element:this.element,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,enterHandler:function(g){g.insideElementPressed?(d(f,i.ButtonState.DOWN),f.raiseEvent("enter",{originalEvent:g.originalEvent})):g.buttonDownAny||d(f,i.ButtonState.HOVER)},focusHandler:function(g){f.tracker.enterHandler(g),f.raiseEvent("focus",{originalEvent:g.originalEvent})},leaveHandler:function(g){u(f,i.ButtonState.GROUP),g.insideElementPressed&&f.raiseEvent("exit",{originalEvent:g.originalEvent})},blurHandler:function(g){f.tracker.leaveHandler(g),f.raiseEvent("blur",{originalEvent:g.originalEvent})},pressHandler:function(g){d(f,i.ButtonState.DOWN),f.raiseEvent("press",{originalEvent:g.originalEvent})},releaseHandler:function(g){g.insideElementPressed&&g.insideElementReleased?(u(f,i.ButtonState.HOVER),f.raiseEvent("release",{originalEvent:g.originalEvent})):g.insideElementPressed?u(f,i.ButtonState.GROUP):d(f,i.ButtonState.HOVER)},clickHandler:function(g){g.quick&&f.raiseEvent("click",{originalEvent:g.originalEvent})},keyHandler:function(g){g.keyCode===13?(f.raiseEvent("click",{originalEvent:g.originalEvent}),f.raiseEvent("release",{originalEvent:g.originalEvent}),g.preventDefault=!0):g.preventDefault=!1}}),u(this,i.ButtonState.REST)},i.extend(i.Button.prototype,i.EventSource.prototype,{notifyGroupEnter:function(){d(this,i.ButtonState.GROUP)},notifyGroupExit:function(){u(this,i.ButtonState.REST)},disable:function(){this.notifyGroupExit(),this.element.disabled=!0,this.tracker.setTracking(!1),i.setElementOpacity(this.element,.2,!0)},enable:function(){this.element.disabled=!1,this.tracker.setTracking(!0),i.setElementOpacity(this.element,1,!0),this.notifyGroupEnter()},destroy:function(){this.imgRest&&(this.element.removeChild(this.imgRest),this.imgRest=null),this.imgGroup&&(this.element.removeChild(this.imgGroup),this.imgGroup=null),this.imgHover&&(this.element.removeChild(this.imgHover),this.imgHover=null),this.imgDown&&(this.element.removeChild(this.imgDown),this.imgDown=null),this.removeAllHandlers(),this.tracker.destroy(),this.element=null}});function r(h){i.requestAnimationFrame(function(){a(h)})}function a(h){var f,g,v;h.shouldFade&&(f=i.now(),g=f-h.fadeBeginTime,v=1-g/h.fadeLength,v=Math.min(1,v),v=Math.max(0,v),h.imgGroup&&i.setElementOpacity(h.imgGroup,v,!0),v>0&&r(h))}function o(h){h.shouldFade=!0,h.fadeBeginTime=i.now()+h.fadeDelay,window.setTimeout(function(){r(h)},h.fadeDelay)}function l(h){h.shouldFade=!1,h.imgGroup&&i.setElementOpacity(h.imgGroup,1,!0)}function d(h,f){h.element.disabled||(f>=i.ButtonState.GROUP&&h.currentState===i.ButtonState.REST&&(l(h),h.currentState=i.ButtonState.GROUP),f>=i.ButtonState.HOVER&&h.currentState===i.ButtonState.GROUP&&(h.imgHover&&(h.imgHover.style.visibility=""),h.currentState=i.ButtonState.HOVER),f>=i.ButtonState.DOWN&&h.currentState===i.ButtonState.HOVER&&(h.imgDown&&(h.imgDown.style.visibility=""),h.currentState=i.ButtonState.DOWN))}function u(h,f){h.element.disabled||(f<=i.ButtonState.HOVER&&h.currentState===i.ButtonState.DOWN&&(h.imgDown&&(h.imgDown.style.visibility="hidden"),h.currentState=i.ButtonState.HOVER),f<=i.ButtonState.GROUP&&h.currentState===i.ButtonState.HOVER&&(h.imgHover&&(h.imgHover.style.visibility="hidden"),h.currentState=i.ButtonState.GROUP),f<=i.ButtonState.REST&&h.currentState===i.ButtonState.GROUP&&(o(h),h.currentState=i.ButtonState.REST))}})(M),(function(i){i.ButtonGroup=function(r){i.extend(!0,this,{buttons:[],clickTimeThreshold:i.DEFAULT_SETTINGS.clickTimeThreshold,clickDistThreshold:i.DEFAULT_SETTINGS.clickDistThreshold,labelText:""},r);var a=this.buttons.concat([]),o=this,l;if(this.element=r.element||i.makeNeutralElement("div"),!r.group)for(this.element.style.display="inline-block",l=0;l<a.length;l++)this.element.appendChild(a[l].element);i.setElementTouchActionNone(this.element),this.tracker=new i.MouseTracker({userData:"ButtonGroup.tracker",element:this.element,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,enterHandler:function(d){var u;for(u=0;u<o.buttons.length;u++)o.buttons[u].notifyGroupEnter()},leaveHandler:function(d){var u;if(!d.insideElementPressed)for(u=0;u<o.buttons.length;u++)o.buttons[u].notifyGroupExit()}})},i.ButtonGroup.prototype={addButton:function(r){this.buttons.push(r),this.element.appendChild(r.element)},emulateEnter:function(){this.tracker.enterHandler({eventSource:this.tracker})},emulateLeave:function(){this.tracker.leaveHandler({eventSource:this.tracker})},destroy:function(){for(;this.buttons.length;){var r=this.buttons.pop();this.element.removeChild(r.element),r.destroy()}this.tracker.destroy(),this.element=null}}})(M),(function(i){i.Rect=function(r,a,o,l,d){this.x=typeof r=="number"?r:0,this.y=typeof a=="number"?a:0,this.width=typeof o=="number"?o:0,this.height=typeof l=="number"?l:0,this.degrees=typeof d=="number"?d:0,this.degrees=i.positiveModulo(this.degrees,360);var u,h;this.degrees>=270?(u=this.getTopRight(),this.x=u.x,this.y=u.y,h=this.height,this.height=this.width,this.width=h,this.degrees-=270):this.degrees>=180?(u=this.getBottomRight(),this.x=u.x,this.y=u.y,this.degrees-=180):this.degrees>=90&&(u=this.getBottomLeft(),this.x=u.x,this.y=u.y,h=this.height,this.height=this.width,this.width=h,this.degrees-=90)},i.Rect.fromSummits=function(r,a,o){var l=r.distanceTo(a),d=r.distanceTo(o),u=a.minus(r),h=Math.atan(u.y/u.x);return u.x<0?h+=Math.PI:u.y<0&&(h+=2*Math.PI),new i.Rect(r.x,r.y,l,d,h/Math.PI*180)},i.Rect.prototype={clone:function(){return new i.Rect(this.x,this.y,this.width,this.height,this.degrees)},getAspectRatio:function(){return this.width/this.height},getTopLeft:function(){return new i.Point(this.x,this.y)},getBottomRight:function(){return new i.Point(this.x+this.width,this.y+this.height).rotate(this.degrees,this.getTopLeft())},getTopRight:function(){return new i.Point(this.x+this.width,this.y).rotate(this.degrees,this.getTopLeft())},getBottomLeft:function(){return new i.Point(this.x,this.y+this.height).rotate(this.degrees,this.getTopLeft())},getCenter:function(){return new i.Point(this.x+this.width/2,this.y+this.height/2).rotate(this.degrees,this.getTopLeft())},getSize:function(){return new i.Point(this.width,this.height)},equals:function(r){return r instanceof i.Rect&&this.x===r.x&&this.y===r.y&&this.width===r.width&&this.height===r.height&&this.degrees===r.degrees},times:function(r){return new i.Rect(this.x*r,this.y*r,this.width*r,this.height*r,this.degrees)},translate:function(r){return new i.Rect(this.x+r.x,this.y+r.y,this.width,this.height,this.degrees)},union:function(r){var a=this.getBoundingBox(),o=r.getBoundingBox(),l=Math.min(a.x,o.x),d=Math.min(a.y,o.y),u=Math.max(a.x+a.width,o.x+o.width),h=Math.max(a.y+a.height,o.y+o.height);return new i.Rect(l,d,u-l,h-d)},intersection:function(r){var a=1e-10,o=[],l=this.getTopLeft();r.containsPoint(l,a)&&o.push(l);var d=this.getTopRight();r.containsPoint(d,a)&&o.push(d);var u=this.getBottomLeft();r.containsPoint(u,a)&&o.push(u);var h=this.getBottomRight();r.containsPoint(h,a)&&o.push(h);var f=r.getTopLeft();this.containsPoint(f,a)&&o.push(f);var g=r.getTopRight();this.containsPoint(g,a)&&o.push(g);var v=r.getBottomLeft();this.containsPoint(v,a)&&o.push(v);var T=r.getBottomRight();this.containsPoint(T,a)&&o.push(T);for(var E=this._getSegments(),_=r._getSegments(),C=0;C<E.length;C++)for(var D=E[C],H=0;H<_.length;H++){var N=_[H],J=Q(D[0],D[1],N[0],N[1]);J&&o.push(J)}function Q(re,Te,Me,Le){var Ce=Te.minus(re),Se=Le.minus(Me),Y=-Se.x*Ce.y+Ce.x*Se.y;if(Y===0)return null;var de=(Ce.x*(re.y-Me.y)-Ce.y*(re.x-Me.x))/Y,oe=(Se.x*(re.y-Me.y)-Se.y*(re.x-Me.x))/Y;return-a<=de&&de<=1-a&&-a<=oe&&oe<=1-a?new i.Point(re.x+oe*Ce.x,re.y+oe*Ce.y):null}if(o.length===0)return null;for(var ee=o[0].x,he=o[0].x,ie=o[0].y,ue=o[0].y,se=1;se<o.length;se++){var pe=o[se];pe.x<ee&&(ee=pe.x),pe.x>he&&(he=pe.x),pe.y<ie&&(ie=pe.y),pe.y>ue&&(ue=pe.y)}return new i.Rect(ee,ie,he-ee,ue-ie)},_getSegments:function(){var r=this.getTopLeft(),a=this.getTopRight(),o=this.getBottomLeft(),l=this.getBottomRight();return[[r,a],[a,l],[l,o],[o,r]]},rotate:function(r,a){if(r=i.positiveModulo(r,360),r===0)return this.clone();a=a||this.getCenter();var o=this.getTopLeft().rotate(r,a),l=this.getTopRight().rotate(r,a),d=l.minus(o);d=d.apply(function(h){var f=1e-15;return Math.abs(h)<f?0:h});var u=Math.atan(d.y/d.x);return d.x<0?u+=Math.PI:d.y<0&&(u+=2*Math.PI),new i.Rect(o.x,o.y,this.width,this.height,u/Math.PI*180)},getBoundingBox:function(){if(this.degrees===0)return this.clone();var r=this.getTopLeft(),a=this.getTopRight(),o=this.getBottomLeft(),l=this.getBottomRight(),d=Math.min(r.x,a.x,o.x,l.x),u=Math.max(r.x,a.x,o.x,l.x),h=Math.min(r.y,a.y,o.y,l.y),f=Math.max(r.y,a.y,o.y,l.y);return new i.Rect(d,h,u-d,f-h)},getIntegerBoundingBox:function(){var r=this.getBoundingBox(),a=Math.floor(r.x),o=Math.floor(r.y),l=Math.ceil(r.width+r.x-a),d=Math.ceil(r.height+r.y-o);return new i.Rect(a,o,l,d)},containsPoint:function(r,a){a=a||0;var o=this.getTopLeft(),l=this.getTopRight(),d=this.getBottomLeft(),u=l.minus(o),h=d.minus(o);return(r.x-o.x)*u.x+(r.y-o.y)*u.y>=-a&&(r.x-l.x)*u.x+(r.y-l.y)*u.y<=a&&(r.x-o.x)*h.x+(r.y-o.y)*h.y>=-a&&(r.x-d.x)*h.x+(r.y-d.y)*h.y<=a},toString:function(){return"["+Math.round(this.x*100)/100+", "+Math.round(this.y*100)/100+", "+Math.round(this.width*100)/100+"x"+Math.round(this.height*100)/100+", "+Math.round(this.degrees*100)/100+"deg]"}}})(M),(function(i){var r={};i.ReferenceStrip=function(v){var T=this,E=v.viewer,_=i.getElementSize(E.element),C,D,H;for(v.id||(v.id="referencestrip-"+i.now(),this.element=i.makeNeutralElement("div"),this.element.id=v.id,this.element.className="referencestrip"),v=i.extend(!0,{sizeRatio:i.DEFAULT_SETTINGS.referenceStripSizeRatio,position:i.DEFAULT_SETTINGS.referenceStripPosition,scroll:i.DEFAULT_SETTINGS.referenceStripScroll,clickTimeThreshold:i.DEFAULT_SETTINGS.clickTimeThreshold},v,{element:this.element}),i.extend(this,v),r[this.id]={animating:!1},this.minPixelRatio=this.viewer.minPixelRatio,this.element.tabIndex=0,D=this.element.style,D.marginTop="0px",D.marginRight="0px",D.marginBottom="0px",D.marginLeft="0px",D.left="0px",D.bottom="0px",D.border="0px",D.background="#000",D.position="relative",i.setElementTouchActionNone(this.element),i.setElementOpacity(this.element,.8),this.viewer=E,this.tracker=new i.MouseTracker({userData:"ReferenceStrip.tracker",element:this.element,clickHandler:i.delegate(this,a),dragHandler:i.delegate(this,o),scrollHandler:i.delegate(this,l),enterHandler:i.delegate(this,u),leaveHandler:i.delegate(this,h),keyDownHandler:i.delegate(this,f),keyHandler:i.delegate(this,g),preProcessEventHandler:function(N){N.eventType==="wheel"&&(N.preventDefault=!0)}}),v.width&&v.height?(this.element.style.width=v.width+"px",this.element.style.height=v.height+"px",E.addControl(this.element,{anchor:i.ControlAnchor.BOTTOM_LEFT})):v.scroll==="horizontal"?(this.element.style.width=_.x*v.sizeRatio*E.tileSources.length+12*E.tileSources.length+"px",this.element.style.height=_.y*v.sizeRatio+"px",E.addControl(this.element,{anchor:i.ControlAnchor.BOTTOM_LEFT})):(this.element.style.height=_.y*v.sizeRatio*E.tileSources.length+12*E.tileSources.length+"px",this.element.style.width=_.x*v.sizeRatio+"px",E.addControl(this.element,{anchor:i.ControlAnchor.TOP_LEFT})),this.panelWidth=_.x*this.sizeRatio+8,this.panelHeight=_.y*this.sizeRatio+8,this.panels=[],this.miniViewers={},H=0;H<E.tileSources.length;H++)C=i.makeNeutralElement("div"),C.id=this.element.id+"-"+H,C.style.width=T.panelWidth+"px",C.style.height=T.panelHeight+"px",C.style.display="inline",C.style.float="left",C.style.cssFloat="left",C.style.padding="2px",i.setElementTouchActionNone(C),i.setElementPointerEventsNone(C),this.element.appendChild(C),C.activePanel=!1,this.panels.push(C);d(this,this.scroll==="vertical"?_.y:_.x,0),this.setFocus(0)},i.ReferenceStrip.prototype={setFocus:function(v){var T=this.element.querySelector("#"+this.element.id+"-"+v),E=i.getElementSize(this.viewer.canvas),_=Number(this.element.style.width.replace("px","")),C=Number(this.element.style.height.replace("px","")),D=-Number(this.element.style.marginLeft.replace("px","")),H=-Number(this.element.style.marginTop.replace("px","")),N;this.currentSelected!==T&&(this.currentSelected&&(this.currentSelected.style.background="#000"),this.currentSelected=T,this.currentSelected.style.background="#999",this.scroll==="horizontal"?(N=Number(v)*(this.panelWidth+3),N>D+E.x-this.panelWidth?(N=Math.min(N,_-E.x),this.element.style.marginLeft=-N+"px",d(this,E.x,-N)):N<D&&(N=Math.max(0,N-E.x/2),this.element.style.marginLeft=-N+"px",d(this,E.x,-N))):(N=Number(v)*(this.panelHeight+3),N>H+E.y-this.panelHeight?(N=Math.min(N,C-E.y),this.element.style.marginTop=-N+"px",d(this,E.y,-N)):N<H&&(N=Math.max(0,N-E.y/2),this.element.style.marginTop=-N+"px",d(this,E.y,-N))),this.currentPage=v,u.call(this,{eventSource:this.tracker}))},update:function(){return!!r[this.id].animating},destroy:function(){if(this.miniViewers)for(var v in this.miniViewers)this.miniViewers[v].destroy();this.tracker.destroy(),this.element&&this.viewer.removeControl(this.element)}};function a(v){if(v.quick){var T;this.scroll==="horizontal"?T=Math.floor(v.position.x/(this.panelWidth+4)):T=Math.floor(v.position.y/this.panelHeight),this.viewer.goToPage(T)}this.element.focus()}function o(v){if(this.dragging=!0,this.element){var T=Number(this.element.style.marginLeft.replace("px","")),E=Number(this.element.style.marginTop.replace("px","")),_=Number(this.element.style.width.replace("px","")),C=Number(this.element.style.height.replace("px","")),D=i.getElementSize(this.viewer.canvas);this.scroll==="horizontal"?-v.delta.x>0?T>-(_-D.x)&&(this.element.style.marginLeft=T+v.delta.x*2+"px",d(this,D.x,T+v.delta.x*2)):-v.delta.x<0&&T<0&&(this.element.style.marginLeft=T+v.delta.x*2+"px",d(this,D.x,T+v.delta.x*2)):-v.delta.y>0?E>-(C-D.y)&&(this.element.style.marginTop=E+v.delta.y*2+"px",d(this,D.y,E+v.delta.y*2)):-v.delta.y<0&&E<0&&(this.element.style.marginTop=E+v.delta.y*2+"px",d(this,D.y,E+v.delta.y*2))}}function l(v){if(this.element){var T=Number(this.element.style.marginLeft.replace("px","")),E=Number(this.element.style.marginTop.replace("px","")),_=Number(this.element.style.width.replace("px","")),C=Number(this.element.style.height.replace("px","")),D=i.getElementSize(this.viewer.canvas);this.scroll==="horizontal"?v.scroll>0?T>-(_-D.x)&&(this.element.style.marginLeft=T-v.scroll*60+"px",d(this,D.x,T-v.scroll*60)):v.scroll<0&&T<0&&(this.element.style.marginLeft=T-v.scroll*60+"px",d(this,D.x,T-v.scroll*60)):v.scroll<0?E>D.y-C&&(this.element.style.marginTop=E+v.scroll*60+"px",d(this,D.y,E+v.scroll*60)):v.scroll>0&&E<0&&(this.element.style.marginTop=E+v.scroll*60+"px",d(this,D.y,E+v.scroll*60)),v.preventDefault=!0}}function d(v,T,E){var _,C,D,H,N,J;for(v.scroll==="horizontal"?_=v.panelWidth:_=v.panelHeight,C=Math.ceil(T/_)+5,D=Math.ceil((Math.abs(E)+T)/_)+1,C=D-C,C=C<0?0:C,N=C;N<D&&N<v.panels.length;N++)if(J=v.panels[N],!J.activePanel){var Q,ee=v.viewer.tileSources[N];ee.referenceStripThumbnailUrl?Q={type:"image",url:ee.referenceStripThumbnailUrl}:Q=ee,H=new i.Viewer({id:J.id,tileSources:[Q],element:J,navigatorSizeRatio:v.sizeRatio,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1,immediateRender:!0,blendTime:0,animationTime:0,loadTilesWithAjax:v.viewer.loadTilesWithAjax,ajaxHeaders:v.viewer.ajaxHeaders,drawer:"canvas"}),i.setElementPointerEventsNone(H.canvas),i.setElementPointerEventsNone(H.container),H.innerTracker.setTracking(!1),H.outerTracker.setTracking(!1),v.miniViewers[J.id]=H,J.activePanel=!0}}function u(v){var T=v.eventSource.element;this.scroll==="horizontal"?T.style.marginBottom="0px":T.style.marginLeft="0px"}function h(v){var T=v.eventSource.element;this.scroll==="horizontal"?T.style.marginBottom="-"+i.getElementSize(T).y/2+"px":T.style.marginLeft="-"+i.getElementSize(T).x/2+"px"}function f(v){if(!v.ctrl&&!v.alt&&!v.meta)switch(v.keyCode){case 38:l.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),v.preventDefault=!0;break;case 40:l.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),v.preventDefault=!0;break;case 37:l.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),v.preventDefault=!0;break;case 39:l.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),v.preventDefault=!0;break;default:v.preventDefault=!1;break}else v.preventDefault=!1}function g(v){if(!v.ctrl&&!v.alt&&!v.meta)switch(v.keyCode){case 61:l.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),v.preventDefault=!0;break;case 45:l.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),v.preventDefault=!0;break;case 48:case 119:case 87:l.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),v.preventDefault=!0;break;case 115:case 83:l.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),v.preventDefault=!0;break;case 97:l.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),v.preventDefault=!0;break;case 100:l.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),v.preventDefault=!0;break;default:v.preventDefault=!1;break}else v.preventDefault=!1}})(M),(function(i){i.DisplayRect=function(r,a,o,l,d,u){i.Rect.apply(this,[r,a,o,l]),this.minLevel=d,this.maxLevel=u},i.extend(i.DisplayRect.prototype,i.Rect.prototype)})(M),(function(i){i.Spring=function(a){var o=arguments;typeof a!="object"&&(a={initial:o.length&&typeof o[0]=="number"?o[0]:void 0,springStiffness:o.length>1?o[1].springStiffness:5,animationTime:o.length>1?o[1].animationTime:1.5}),i.console.assert(typeof a.springStiffness=="number"&&a.springStiffness!==0,"[OpenSeadragon.Spring] options.springStiffness must be a non-zero number"),i.console.assert(typeof a.animationTime=="number"&&a.animationTime>=0,"[OpenSeadragon.Spring] options.animationTime must be a number greater than or equal to 0"),a.exponential&&(this._exponential=!0,delete a.exponential),i.extend(!0,this,a),this.current={value:typeof this.initial=="number"?this.initial:this._exponential?0:1,time:i.now()},i.console.assert(!this._exponential||this.current.value!==0,"[OpenSeadragon.Spring] value must be non-zero for exponential springs"),this.start={value:this.current.value,time:this.current.time},this.target={value:this.current.value,time:this.current.time},this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},i.Spring.prototype={resetTo:function(a){i.console.assert(!this._exponential||a!==0,"[OpenSeadragon.Spring.resetTo] target must be non-zero for exponential springs"),this.start.value=this.target.value=this.current.value=a,this.start.time=this.target.time=this.current.time=i.now(),this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},springTo:function(a){i.console.assert(!this._exponential||a!==0,"[OpenSeadragon.Spring.springTo] target must be non-zero for exponential springs"),this.start.value=this.current.value,this.start.time=this.current.time,this.target.value=a,this.target.time=this.start.time+1e3*this.animationTime,this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value))},shiftBy:function(a){this.start.value+=a,this.target.value+=a,this._exponential&&(i.console.assert(this.target.value!==0&&this.start.value!==0,"[OpenSeadragon.Spring.shiftBy] spring value must be non-zero for exponential springs"),this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value))},setExponential:function(a){this._exponential=a,this._exponential&&(i.console.assert(this.current.value!==0&&this.target.value!==0&&this.start.value!==0,"[OpenSeadragon.Spring.setExponential] spring value must be non-zero for exponential springs"),this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},update:function(){this.current.time=i.now();let a,o;if(this._exponential?(a=this.start._logValue,o=this.target._logValue):(a=this.start.value,o=this.target.value),this.current.time>=this.target.time)this.current.value=this.target.value;else{let l=a+(o-a)*r(this.springStiffness,(this.current.time-this.start.time)/(this.target.time-this.start.time));this._exponential?this.current.value=Math.exp(l):this.current.value=l}return this.current.value!==this.target.value},isAtTargetValue:function(){return this.current.value===this.target.value}};function r(a,o){return(1-Math.exp(a*-o))/(1-Math.exp(-a))}})(M),(function(i){i.ImageJob=function(a){i.extend(!0,this,{timeout:i.DEFAULT_SETTINGS.timeout,jobId:null,tries:0},a),this.data=null,this.userData={},this.errorMsg=null},i.ImageJob.prototype={start:function(){this.tries++;var a=this,o=this.abort;this.jobId=window.setTimeout(function(){a.finish(null,null,"Image load exceeded timeout ("+a.timeout+" ms)")},this.timeout),this.abort=function(){a.source.downloadTileAbort(a),typeof o=="function"&&o()},this.source.downloadTileStart(this)},finish:function(a,o,l){this.data=a,this.request=o,this.errorMsg=l,this.jobId&&window.clearTimeout(this.jobId),this.callback(this)}},i.ImageLoader=function(a){i.extend(!0,this,{jobLimit:i.DEFAULT_SETTINGS.imageLoaderLimit,timeout:i.DEFAULT_SETTINGS.timeout,jobQueue:[],failedTiles:[],jobsInProgress:0},a)},i.ImageLoader.prototype={addJob:function(a){if(!a.source){i.console.error("ImageLoader.prototype.addJob() requires [options.source]. TileSource since new API defines how images are fetched. Creating a dummy TileSource.");var o=i.TileSource.prototype;a.source={downloadTileStart:o.downloadTileStart,downloadTileAbort:o.downloadTileAbort}}var l=this,d=function(f){r(l,f,a.callback)},u={src:a.src,tile:a.tile||{},source:a.source,loadWithAjax:a.loadWithAjax,ajaxHeaders:a.loadWithAjax?a.ajaxHeaders:null,crossOriginPolicy:a.crossOriginPolicy,ajaxWithCredentials:a.ajaxWithCredentials,postData:a.postData,callback:d,abort:a.abort,timeout:this.timeout},h=new i.ImageJob(u);!this.jobLimit||this.jobsInProgress<this.jobLimit?(h.start(),this.jobsInProgress++):this.jobQueue.push(h)},clear:function(){for(var a=0;a<this.jobQueue.length;a++){var o=this.jobQueue[a];typeof o.abort=="function"&&o.abort()}this.jobQueue=[]}};function r(a,o,l){o.errorMsg!==""&&(o.data===null||o.data===void 0)&&o.tries<1+a.tileRetryMax&&a.failedTiles.push(o);var d;a.jobsInProgress--,(!a.jobLimit||a.jobsInProgress<a.jobLimit)&&a.jobQueue.length>0&&(d=a.jobQueue.shift(),d.start(),a.jobsInProgress++),a.tileRetryMax>0&&a.jobQueue.length===0&&(!a.jobLimit||a.jobsInProgress<a.jobLimit)&&a.failedTiles.length>0&&(d=a.failedTiles.shift(),setTimeout(function(){d.start()},a.tileRetryDelay),a.jobsInProgress++),l(o.data,o.errorMsg,o.request)}})(M),(function(i){i.Tile=function(r,a,o,l,d,u,h,f,g,v,T,E){this.level=r,this.x=a,this.y=o,this.bounds=l,this.positionedBounds=new M.Rect(l.x,l.y,l.width,l.height),this.sourceBounds=v,this.exists=d,this._url=u,this.postData=T,this.context2D=h,this.loadWithAjax=f,this.ajaxHeaders=g,E===void 0&&(i.console.warn("Tile constructor needs 'cacheKey' variable: creation tile cache in Tile class is deprecated. TileSource.prototype.getTileHashKey will be used."),E=i.TileSource.prototype.getTileHashKey(r,a,o,u,g,T)),this.cacheKey=E,this.loaded=!1,this.loading=!1,this.element=null,this.imgElement=null,this.style=null,this.position=null,this.size=null,this.flipped=!1,this.blendStart=null,this.opacity=null,this.squaredDistance=null,this.visibility=null,this.hasTransparency=!1,this.beingDrawn=!1,this.lastTouchTime=0,this.isRightMost=!1,this.isBottomMost=!1},i.Tile.prototype={toString:function(){return this.level+"/"+this.x+"_"+this.y},_hasTransparencyChannel:function(){return console.warn("Tile.prototype._hasTransparencyChannel() has been deprecated and will be removed in the future. Use TileSource.prototype.hasTransparency() instead."),!!this.context2D||this.getUrl().match(".png")},get image(){return i.console.error("[Tile.image] property has been deprecated. Use [Tile.prototype.getImage] instead."),this.getImage()},get url(){return i.console.error("[Tile.url] property has been deprecated. Use [Tile.prototype.getUrl] instead."),this.getUrl()},getImage:function(){return this.cacheImageRecord.getImage()},getUrl:function(){return typeof this._url=="function"?this._url():this._url},getCanvasContext:function(){return this.context2D||this.cacheImageRecord&&this.cacheImageRecord.getRenderedContext()},getScaleForEdgeSmoothing:function(){var r;if(this.cacheImageRecord)r=this.cacheImageRecord.getRenderedContext();else if(this.context2D)r=this.context2D;else return i.console.warn("[Tile.drawCanvas] attempting to get tile scale %s when tile's not cached",this.toString()),1;return r.canvas.width/(this.size.x*i.pixelDensityRatio)},getTranslationForEdgeSmoothing:function(r,a,o){var l=Math.max(1,Math.ceil((o.x-a.x)/2)),d=Math.max(1,Math.ceil((o.y-a.y)/2));return new i.Point(l,d).minus(this.position.times(i.pixelDensityRatio).times(r||1).apply(function(u){return u%1}))},unload:function(){this.imgElement&&this.imgElement.parentNode&&this.imgElement.parentNode.removeChild(this.imgElement),this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.element=null,this.imgElement=null,this.loaded=!1,this.loading=!1}}})(M),(function(i){i.OverlayPlacement=i.Placement,i.OverlayRotationMode=i.freezeObject({NO_ROTATION:1,EXACT:2,BOUNDING_BOX:3}),i.Overlay=function(r,a,o){var l;i.isPlainObject(r)?l=r:l={element:r,location:a,placement:o},this.elementWrapper=document.createElement("div"),this.element=l.element,this.elementWrapper.appendChild(this.element),this.element.id?this.elementWrapper.id="overlay-wrapper-"+this.element.id:this.elementWrapper.id="overlay-wrapper",this.style=this.elementWrapper.style,this._init(l)},i.Overlay.prototype={_init:function(r){this.location=r.location,this.placement=r.placement===void 0?i.Placement.TOP_LEFT:r.placement,this.onDraw=r.onDraw,this.checkResize=r.checkResize===void 0?!0:r.checkResize,this.width=r.width===void 0?null:r.width,this.height=r.height===void 0?null:r.height,this.rotationMode=r.rotationMode||i.OverlayRotationMode.EXACT,this.location instanceof i.Rect&&(this.width=this.location.width,this.height=this.location.height,this.location=this.location.getTopLeft(),this.placement=i.Placement.TOP_LEFT),this.scales=this.width!==null&&this.height!==null,this.bounds=new i.Rect(this.location.x,this.location.y,this.width,this.height),this.position=this.location},adjust:function(r,a){var o=i.Placement.properties[this.placement];o&&(o.isHorizontallyCentered?r.x-=a.x/2:o.isRight&&(r.x-=a.x),o.isVerticallyCentered?r.y-=a.y/2:o.isBottom&&(r.y-=a.y))},destroy:function(){var r=this.elementWrapper,a=this.style;r.parentNode&&(r.parentNode.removeChild(r),r.prevElementParent&&(a.display="none",document.body.appendChild(r))),this.onDraw=null,a.top="",a.left="",a.position="",this.width!==null&&(a.width=""),this.height!==null&&(a.height="");var o=i.getCssPropertyWithVendorPrefix("transformOrigin"),l=i.getCssPropertyWithVendorPrefix("transform");o&&l&&(a[o]="",a[l]="")},drawHTML:function(r,a){var o=this.elementWrapper;o.parentNode!==r&&(o.prevElementParent=o.parentNode,o.prevNextSibling=o.nextSibling,r.appendChild(o),this.style.position="absolute",this.size=i.getElementSize(this.elementWrapper));var l=this._getOverlayPositionAndSize(a),d=l.position,u=this.size=l.size,h="";a.overlayPreserveContentDirection&&(h=a.flipped?" scaleX(-1)":" scaleX(1)");var f=a.flipped?-l.rotate:l.rotate,g=a.flipped?" scaleX(-1)":"";if(this.onDraw)this.onDraw(d,u,this.element);else{var v=this.style,T=this.element.style;T.display="block",v.left=d.x+"px",v.top=d.y+"px",this.width!==null&&(T.width=u.x+"px"),this.height!==null&&(T.height=u.y+"px");var E=i.getCssPropertyWithVendorPrefix("transformOrigin"),_=i.getCssPropertyWithVendorPrefix("transform");E&&_&&(f&&!a.flipped?(T[_]="",v[E]=this._getTransformOrigin(),v[_]="rotate("+f+"deg)"):!f&&a.flipped?(T[_]=h,v[E]=this._getTransformOrigin(),v[_]=g):f&&a.flipped?(T[_]=h,v[E]=this._getTransformOrigin(),v[_]="rotate("+f+"deg)"+g):(T[_]="",v[E]="",v[_]="")),v.display="flex"}},_getOverlayPositionAndSize:function(r){var a=r.pixelFromPoint(this.location,!0),o=this._getSizeInPixels(r);this.adjust(a,o);var l=0;if(r.getRotation(!0)&&this.rotationMode!==i.OverlayRotationMode.NO_ROTATION)if(this.rotationMode===i.OverlayRotationMode.BOUNDING_BOX&&this.width!==null&&this.height!==null){var d=new i.Rect(a.x,a.y,o.x,o.y),u=this._getBoundingBox(d,r.getRotation(!0));a=u.getTopLeft(),o=u.getSize()}else l=r.getRotation(!0);return r.flipped&&(a.x=r.getContainerSize().x-a.x),{position:a,size:o,rotate:l}},_getSizeInPixels:function(r){var a=this.size.x,o=this.size.y;if(this.width!==null||this.height!==null){var l=r.deltaPixelsFromPointsNoRotate(new i.Point(this.width||0,this.height||0),!0);this.width!==null&&(a=l.x),this.height!==null&&(o=l.y)}if(this.checkResize&&(this.width===null||this.height===null)){var d=this.size=i.getElementSize(this.elementWrapper);this.width===null&&(a=d.x),this.height===null&&(o=d.y)}return new i.Point(a,o)},_getBoundingBox:function(r,a){var o=this._getPlacementPoint(r);return r.rotate(a,o).getBoundingBox()},_getPlacementPoint:function(r){var a=new i.Point(r.x,r.y),o=i.Placement.properties[this.placement];return o&&(o.isHorizontallyCentered?a.x+=r.width/2:o.isRight&&(a.x+=r.width),o.isVerticallyCentered?a.y+=r.height/2:o.isBottom&&(a.y+=r.height)),a},_getTransformOrigin:function(){var r="",a=i.Placement.properties[this.placement];return a&&(a.isLeft?r="left":a.isRight&&(r="right"),a.isTop?r+=" top":a.isBottom&&(r+=" bottom")),r},update:function(r,a){var o=i.isPlainObject(r)?r:{location:r,placement:a};this._init({location:o.location||this.location,placement:o.placement!==void 0?o.placement:this.placement,onDraw:o.onDraw||this.onDraw,checkResize:o.checkResize||this.checkResize,width:o.width!==void 0?o.width:this.width,height:o.height!==void 0?o.height:this.height,rotationMode:o.rotationMode||this.rotationMode})},getBounds:function(r){i.console.assert(r,"A viewport must now be passed to Overlay.getBounds.");var a=this.width,o=this.height;if(a===null||o===null){var l=r.deltaPointsFromPixelsNoRotate(this.size,!0);a===null&&(a=l.x),o===null&&(o=l.y)}var d=this.location.clone();return this.adjust(d,new i.Point(a,o)),this._adjustBoundsForRotation(r,new i.Rect(d.x,d.y,a,o))},_adjustBoundsForRotation:function(r,a){if(!r||r.getRotation(!0)===0||this.rotationMode===i.OverlayRotationMode.EXACT)return a;if(this.rotationMode===i.OverlayRotationMode.BOUNDING_BOX){if(this.width===null||this.height===null)return a;var o=this._getOverlayPositionAndSize(r);return r.viewerElementToViewportRectangle(new i.Rect(o.position.x,o.position.y,o.size.x,o.size.y))}return a.rotate(-r.getRotation(!0),this._getPlacementPoint(a))}}})(M),(function(i){const r=i;r.DrawerBase=class{constructor(o){i.console.assert(o.viewer,"[Drawer] options.viewer is required"),i.console.assert(o.viewport,"[Drawer] options.viewport is required"),i.console.assert(o.element,"[Drawer] options.element is required"),this.viewer=o.viewer,this.viewport=o.viewport,this.debugGridColor=typeof o.debugGridColor=="string"?[o.debugGridColor]:o.debugGridColor||i.DEFAULT_SETTINGS.debugGridColor,this.options=o.options||{},this.container=i.getElement(o.element),this._renderingTarget=this._createDrawingElement(),this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.position="absolute",this.canvas.style.left="0",i.setElementOpacity(this.canvas,this.viewer.opacity,!0),i.setElementPointerEventsNone(this.canvas),i.setElementTouchActionNone(this.canvas),this.container.style.textAlign="left",this.container.appendChild(this.canvas),this._checkForAPIOverrides()}get canvas(){return this._renderingTarget}get element(){return i.console.error("Drawer.element is deprecated. Use Drawer.container instead."),this.container}getType(){i.console.error("Drawer.getType must be implemented by child class")}static isSupported(){i.console.error("Drawer.isSupported must be implemented by child class")}_createDrawingElement(){return i.console.error("Drawer._createDrawingElement must be implemented by child class"),null}draw(o){i.console.error("Drawer.draw must be implemented by child class")}canRotate(){i.console.error("Drawer.canRotate must be implemented by child class")}destroy(){i.console.error("Drawer.destroy must be implemented by child class")}minimumOverlapRequired(o){return!1}setImageSmoothingEnabled(o){i.console.error("Drawer.setImageSmoothingEnabled must be implemented by child class")}drawDebuggingRect(o){i.console.warn("[drawer].drawDebuggingRect is not implemented by this drawer")}clear(){i.console.warn("[drawer].clear() is deprecated. The drawer is responsible for clearing itself as needed before drawing tiles.")}_checkForAPIOverrides(){if(this._createDrawingElement===i.DrawerBase.prototype._createDrawingElement)throw new Error("[drawer]._createDrawingElement must be implemented by child class");if(this.draw===i.DrawerBase.prototype.draw)throw new Error("[drawer].draw must be implemented by child class");if(this.canRotate===i.DrawerBase.prototype.canRotate)throw new Error("[drawer].canRotate must be implemented by child class");if(this.destroy===i.DrawerBase.prototype.destroy)throw new Error("[drawer].destroy must be implemented by child class");if(this.setImageSmoothingEnabled===i.DrawerBase.prototype.setImageSmoothingEnabled)throw new Error("[drawer].setImageSmoothingEnabled must be implemented by child class")}viewportToDrawerRectangle(o){var l=this.viewport.pixelFromPointNoRotate(o.getTopLeft(),!0),d=this.viewport.deltaPixelsFromPointsNoRotate(o.getSize(),!0);return new i.Rect(l.x*i.pixelDensityRatio,l.y*i.pixelDensityRatio,d.x*i.pixelDensityRatio,d.y*i.pixelDensityRatio)}viewportCoordToDrawerCoord(o){var l=this.viewport.pixelFromPointNoRotate(o,!0);return new i.Point(l.x*i.pixelDensityRatio,l.y*i.pixelDensityRatio)}_calculateCanvasSize(){var o=i.pixelDensityRatio,l=this.viewport.getContainerSize();return new r.Point(Math.round(l.x*o),Math.round(l.y*o))}_raiseTiledImageDrawnEvent(o,l){this.viewer&&this.viewer.raiseEvent("tiled-image-drawn",{tiledImage:o,tiles:l})}_raiseDrawerErrorEvent(o,l){this.viewer&&this.viewer.raiseEvent("drawer-error",{tiledImage:o,drawer:this,error:l})}}})(M),(function(i){const r=i;class a extends r.DrawerBase{constructor(l){super(l),this.viewer.rejectEventHandler("tile-drawing","The HTMLDrawer does not raise the tile-drawing event"),this.viewer.allowEventHandler("tile-drawn")}static isSupported(){return!0}getType(){return"html"}minimumOverlapRequired(l){return!0}_createDrawingElement(){return i.makeNeutralElement("div")}draw(l){var d=this;this._prepareNewFrame(),l.forEach(function(u){u.opacity!==0&&d._drawTiles(u)})}canRotate(){return!1}destroy(){this.container.removeChild(this.canvas)}setImageSmoothingEnabled(){}_prepareNewFrame(){this.canvas.innerHTML=""}_drawTiles(l){var d=l.getTilesToDraw().map(f=>f.tile);if(!(l.opacity===0||d.length===0&&!l.placeholderFillStyle))for(var u=d.length-1;u>=0;u--){var h=d[u];this._drawTile(h),this.viewer&&this.viewer.raiseEvent("tile-drawn",{tiledImage:l,tile:h})}}_drawTile(l){i.console.assert(l,"[Drawer._drawTile] tile is required");let d=this.canvas;if(!l.cacheImageRecord){i.console.warn("[Drawer._drawTileToHTML] attempting to draw tile %s when it's not cached",l.toString());return}if(!l.loaded){i.console.warn("Attempting to draw tile %s when it's not yet loaded.",l.toString());return}if(!l.element){var u=l.getImage();if(!u)return;l.element=i.makeNeutralElement("div"),l.imgElement=u.cloneNode(),l.imgElement.style.msInterpolationMode="nearest-neighbor",l.imgElement.style.width="100%",l.imgElement.style.height="100%",l.style=l.element.style,l.style.position="absolute"}l.element.parentNode!==d&&d.appendChild(l.element),l.imgElement.parentNode!==l.element&&l.element.appendChild(l.imgElement),l.style.top=l.position.y+"px",l.style.left=l.position.x+"px",l.style.height=l.size.y+"px",l.style.width=l.size.x+"px",l.flipped&&(l.style.transform="scaleX(-1)"),i.setElementOpacity(l.element,l.opacity)}}i.HTMLDrawer=a})(M),(function(i){const r=i;class a extends r.DrawerBase{constructor(f){super(f),this.context=this.canvas.getContext("2d"),this.sketchCanvas=null,this.sketchContext=null,this._imageSmoothingEnabled=!0,this.viewer.allowEventHandler("tile-drawn"),this.viewer.allowEventHandler("tile-drawing")}static isSupported(){return i.supportsCanvas}getType(){return"canvas"}_createDrawingElement(){let f=i.makeNeutralElement("canvas"),g=this._calculateCanvasSize();return f.width=g.x,f.height=g.y,f}draw(f){this._prepareNewFrame(),this.viewer.viewport.getFlip()!==this._viewportFlipped&&this._flip();for(const g of f)g.opacity!==0&&this._drawTiles(g)}canRotate(){return!0}destroy(){this.canvas.width=1,this.canvas.height=1,this.sketchCanvas=null,this.sketchContext=null,this.container.removeChild(this.canvas)}minimumOverlapRequired(f){return!0}setImageSmoothingEnabled(f){this._imageSmoothingEnabled=!!f,this._updateImageSmoothingEnabled(this.context),this.viewer.forceRedraw()}drawDebuggingRect(f){var g=this.context;g.save(),g.lineWidth=2*i.pixelDensityRatio,g.strokeStyle=this.debugGridColor[0],g.fillStyle=this.debugGridColor[0],g.strokeRect(f.x*i.pixelDensityRatio,f.y*i.pixelDensityRatio,f.width*i.pixelDensityRatio,f.height*i.pixelDensityRatio),g.restore()}get _viewportFlipped(){return this.context.getTransform().a<0}_raiseTileDrawingEvent(f,g,v,T){this.viewer.raiseEvent("tile-drawing",{tiledImage:f,context:g,tile:v,rendered:T})}_prepareNewFrame(){var f=this._calculateCanvasSize();if((this.canvas.width!==f.x||this.canvas.height!==f.y)&&(this.canvas.width=f.x,this.canvas.height=f.y,this._updateImageSmoothingEnabled(this.context),this.sketchCanvas!==null)){var g=this._calculateSketchCanvasSize();this.sketchCanvas.width=g.x,this.sketchCanvas.height=g.y,this._updateImageSmoothingEnabled(this.sketchContext)}this._clear()}_clear(f,g){var v=this._getContext(f);if(g)v.clearRect(g.x,g.y,g.width,g.height);else{var T=v.canvas;v.clearRect(0,0,T.width,T.height)}}_drawTiles(f){var g=f.getTilesToDraw().map(re=>re.tile);if(!(f.opacity===0||g.length===0&&!f.placeholderFillStyle)){var v=g[0],T;v&&(T=f.opacity<1||f.compositeOperation&&f.compositeOperation!=="source-over"||!f._isBottomItem()&&f.source.hasTransparency(v.context2D,v.getUrl(),v.ajaxHeaders,v.postData));var E,_,C=this.viewport.getZoom(!0),D=f.viewportToImageZoom(C);g.length>1&&D>f.smoothTileEdgesMinZoom&&!f.iOSDevice&&f.getRotation(!0)%360===0&&(T=!0,E=v.getScaleForEdgeSmoothing(),_=v.getTranslationForEdgeSmoothing(E,this._getCanvasSize(!1),this._getCanvasSize(!0)));var H;T&&(E||(H=this.viewport.viewportToViewerElementRectangle(f.getClippedBounds(!0)).getIntegerBoundingBox(),H=H.times(i.pixelDensityRatio)),this._clear(!0,H)),E||this._setRotations(f,T);var N=!1;if(f._clip){this._saveContext(T);var J=f.imageToViewportRectangle(f._clip,!0);J=J.rotate(-f.getRotation(!0),f._getRotationPoint(!0));var Q=this.viewportToDrawerRectangle(J);E&&(Q=Q.times(E)),_&&(Q=Q.translate(_)),this._setClip(Q,T),N=!0}if(f._croppingPolygons){var ee=this;N||this._saveContext(T);try{var he=f._croppingPolygons.map(function(re){return re.map(function(Te){var Me=f.imageToViewportCoordinates(Te.x,Te.y,!0).rotate(-f.getRotation(!0),f._getRotationPoint(!0)),Le=ee.viewportCoordToDrawerCoord(Me);return E&&(Le=Le.times(E)),_&&(Le=Le.plus(_)),Le})});this._clipWithPolygons(he,T)}catch(re){i.console.error(re)}N=!0}if(f._hasOpaqueTile=!1,f.placeholderFillStyle&&f._hasOpaqueTile===!1){let re=this.viewportToDrawerRectangle(f.getBoundsNoRotate(!0));E&&(re=re.times(E)),_&&(re=re.translate(_));let Te=null;typeof f.placeholderFillStyle=="function"?Te=f.placeholderFillStyle(f,this.context):Te=f.placeholderFillStyle,this._drawRectangle(re,Te,T)}var ie=u(f.subPixelRoundingForTransparency),ue=!1;if(ie===i.SUBPIXEL_ROUNDING_OCCURRENCES.ALWAYS)ue=!0;else if(ie===i.SUBPIXEL_ROUNDING_OCCURRENCES.ONLY_AT_REST){var se=this.viewer&&this.viewer.isAnimating();ue=!se}for(var pe=0;pe<g.length;pe++)v=g[pe],this._drawTile(v,f,T,E,_,ue,f.source),this.viewer&&this.viewer.raiseEvent("tile-drawn",{tiledImage:f,tile:v});N&&this._restoreContext(T),E||(f.getRotation(!0)%360!==0&&this._restoreRotationChanges(T),this.viewport.getRotation(!0)%360!==0&&this._restoreRotationChanges(T)),T&&(E&&this._setRotations(f),this.blendSketch({opacity:f.opacity,scale:E,translate:_,compositeOperation:f.compositeOperation,bounds:H}),E&&(f.getRotation(!0)%360!==0&&this._restoreRotationChanges(!1),this.viewport.getRotation(!0)%360!==0&&this._restoreRotationChanges(!1))),this._drawDebugInfo(f,g),this._raiseTiledImageDrawnEvent(f,g)}}_drawDebugInfo(f,g){if(f.debugMode)for(var v=g.length-1;v>=0;v--){var T=g[v];try{this._drawDebugInfoOnTile(T,g.length,v,f)}catch(E){i.console.error(E)}}}_clipWithPolygons(f,g){var v=this._getContext(g);v.beginPath();for(const T of f)for(const[E,_]of T.entries())v[E===0?"moveTo":"lineTo"](_.x,_.y);v.clip()}_drawTile(f,g,v,T,E,_,C){i.console.assert(f,"[Drawer._drawTile] tile is required"),i.console.assert(g,"[Drawer._drawTile] drawingHandler is required");var D=this._getContext(v);T=T||1,this._drawTileToCanvas(f,D,g,T,E,_,C)}_drawTileToCanvas(f,g,v,T,E,_,C){var D=f.position.times(i.pixelDensityRatio),H=f.size.times(i.pixelDensityRatio),N;if(!f.context2D&&!f.cacheImageRecord){i.console.warn("[Drawer._drawTileToCanvas] attempting to draw tile %s when it's not cached",f.toString());return}if(N=f.getCanvasContext(),!f.loaded||!N){i.console.warn("Attempting to draw tile %s when it's not yet loaded.",f.toString());return}g.save(),typeof T=="number"&&T!==1&&(D=D.times(T),H=H.times(T)),E instanceof i.Point&&(D=D.plus(E)),g.globalAlpha===1&&f.hasTransparency&&(_&&(D.x=Math.round(D.x),D.y=Math.round(D.y),H.x=Math.round(H.x),H.y=Math.round(H.y)),g.clearRect(D.x,D.y,H.x,H.y)),this._raiseTileDrawingEvent(v,g,f,N);var J,Q;f.sourceBounds?(J=Math.min(f.sourceBounds.width,N.canvas.width),Q=Math.min(f.sourceBounds.height,N.canvas.height)):(J=N.canvas.width,Q=N.canvas.height),g.translate(D.x+H.x/2,0),f.flipped&&g.scale(-1,1),g.drawImage(N.canvas,0,0,J,Q,-H.x/2,D.y,H.x,H.y),g.restore()}_getContext(f){var g=this.context;if(f){if(this.sketchCanvas===null){this.sketchCanvas=document.createElement("canvas");var v=this._calculateSketchCanvasSize();if(this.sketchCanvas.width=v.x,this.sketchCanvas.height=v.y,this.sketchContext=this.sketchCanvas.getContext("2d"),this.viewport.getRotation()===0){var T=this;this.viewer.addHandler("rotate",function E(){if(T.viewport.getRotation()!==0){T.viewer.removeHandler("rotate",E);var _=T._calculateSketchCanvasSize();T.sketchCanvas.width=_.x,T.sketchCanvas.height=_.y}})}this._updateImageSmoothingEnabled(this.sketchContext)}g=this.sketchContext}return g}_saveContext(f){this._getContext(f).save()}_restoreContext(f){this._getContext(f).restore()}_setClip(f,g){var v=this._getContext(g);v.beginPath(),v.rect(f.x,f.y,f.width,f.height),v.clip()}_drawRectangle(f,g,v){var T=this._getContext(v);T.save(),T.fillStyle=g,T.fillRect(f.x,f.y,f.width,f.height),T.restore()}blendSketch(f,g,v,T){var E=f;i.isPlainObject(E)||(E={opacity:f,scale:g,translate:v,compositeOperation:T}),f=E.opacity,T=E.compositeOperation;var _=E.bounds;if(this.context.save(),this.context.globalAlpha=f,T&&(this.context.globalCompositeOperation=T),_)_.x<0&&(_.width+=_.x,_.x=0),_.x+_.width>this.canvas.width&&(_.width=this.canvas.width-_.x),_.y<0&&(_.height+=_.y,_.y=0),_.y+_.height>this.canvas.height&&(_.height=this.canvas.height-_.y),this.context.drawImage(this.sketchCanvas,_.x,_.y,_.width,_.height,_.x,_.y,_.width,_.height);else{g=E.scale||1,v=E.translate;var C=v instanceof i.Point?v:new i.Point(0,0),D=0,H=0;if(v){var N=this.sketchCanvas.width-this.canvas.width,J=this.sketchCanvas.height-this.canvas.height;D=Math.round(N/2),H=Math.round(J/2)}this.context.drawImage(this.sketchCanvas,C.x-D*g,C.y-H*g,(this.canvas.width+2*D)*g,(this.canvas.height+2*H)*g,-D,-H,this.canvas.width+2*D,this.canvas.height+2*H)}this.context.restore()}_drawDebugInfoOnTile(f,g,v,T){var E=this.viewer.world.getIndexOfItem(T)%this.debugGridColor.length,_=this.context;_.save(),_.lineWidth=2*i.pixelDensityRatio,_.font="small-caps bold "+13*i.pixelDensityRatio+"px arial",_.strokeStyle=this.debugGridColor[E],_.fillStyle=this.debugGridColor[E],this._setRotations(T),this._viewportFlipped&&this._flip({point:f.position.plus(f.size.divide(2))}),_.strokeRect(f.position.x*i.pixelDensityRatio,f.position.y*i.pixelDensityRatio,f.size.x*i.pixelDensityRatio,f.size.y*i.pixelDensityRatio);var C=(f.position.x+f.size.x/2)*i.pixelDensityRatio,D=(f.position.y+f.size.y/2)*i.pixelDensityRatio;_.translate(C,D);const H=this.viewport.getRotation(!0);_.rotate(Math.PI/180*-H),_.translate(-C,-D),f.x===0&&f.y===0&&(_.fillText("Zoom: "+this.viewport.getZoom(),f.position.x*i.pixelDensityRatio,(f.position.y-30)*i.pixelDensityRatio),_.fillText("Pan: "+this.viewport.getBounds().toString(),f.position.x*i.pixelDensityRatio,(f.position.y-20)*i.pixelDensityRatio)),_.fillText("Level: "+f.level,(f.position.x+10)*i.pixelDensityRatio,(f.position.y+20)*i.pixelDensityRatio),_.fillText("Column: "+f.x,(f.position.x+10)*i.pixelDensityRatio,(f.position.y+30)*i.pixelDensityRatio),_.fillText("Row: "+f.y,(f.position.x+10)*i.pixelDensityRatio,(f.position.y+40)*i.pixelDensityRatio),_.fillText("Order: "+v+" of "+g,(f.position.x+10)*i.pixelDensityRatio,(f.position.y+50)*i.pixelDensityRatio),_.fillText("Size: "+f.size.toString(),(f.position.x+10)*i.pixelDensityRatio,(f.position.y+60)*i.pixelDensityRatio),_.fillText("Position: "+f.position.toString(),(f.position.x+10)*i.pixelDensityRatio,(f.position.y+70)*i.pixelDensityRatio),this.viewport.getRotation(!0)%360!==0&&this._restoreRotationChanges(),T.getRotation(!0)%360!==0&&this._restoreRotationChanges(),_.restore()}_updateImageSmoothingEnabled(f){f.msImageSmoothingEnabled=this._imageSmoothingEnabled,f.imageSmoothingEnabled=this._imageSmoothingEnabled}_getCanvasSize(f){var g=this._getContext(f).canvas;return new i.Point(g.width,g.height)}_getCanvasCenter(){return new i.Point(this.canvas.width/2,this.canvas.height/2)}_setRotations(f,g=!1){var v=!1;this.viewport.getRotation(!0)%360!==0&&(this._offsetForRotation({degrees:this.viewport.getRotation(!0),useSketch:g,saveContext:v}),v=!1),f.getRotation(!0)%360!==0&&this._offsetForRotation({degrees:f.getRotation(!0),point:this.viewport.pixelFromPointNoRotate(f._getRotationPoint(!0),!0),useSketch:g,saveContext:v})}_offsetForRotation(f){var g=f.point?f.point.times(i.pixelDensityRatio):this._getCanvasCenter(),v=this._getContext(f.useSketch);v.save(),v.translate(g.x,g.y),v.rotate(Math.PI/180*f.degrees),v.translate(-g.x,-g.y)}_flip(f){f=f||{};var g=f.point?f.point.times(i.pixelDensityRatio):this._getCanvasCenter(),v=this._getContext(f.useSketch);v.translate(g.x,0),v.scale(-1,1),v.translate(-g.x,0)}_restoreRotationChanges(f){var g=this._getContext(f);g.restore()}_calculateCanvasSize(){var f=i.pixelDensityRatio,g=this.viewport.getContainerSize();return{x:Math.round(g.x*f),y:Math.round(g.y*f)}}_calculateSketchCanvasSize(){var f=this._calculateCanvasSize();if(this.viewport.getRotation()===0)return f;var g=Math.ceil(Math.sqrt(f.x*f.x+f.y*f.y));return{x:g,y:g}}}i.CanvasDrawer=a;var o=i.SUBPIXEL_ROUNDING_OCCURRENCES.NEVER;function l(h){return h!==i.SUBPIXEL_ROUNDING_OCCURRENCES.ALWAYS&&h!==i.SUBPIXEL_ROUNDING_OCCURRENCES.ONLY_AT_REST&&h!==i.SUBPIXEL_ROUNDING_OCCURRENCES.NEVER}function d(h){return l(h)?o:h}function u(h){if(typeof h=="number")return d(h);if(!h||!i.Browser)return o;var f=h[i.Browser.vendor];return l(f)&&(f=h["*"]),d(f)}})(M),(function(i){const r=i;r.WebGLDrawer=class extends r.DrawerBase{constructor(o){super(o),this._destroyed=!1,this._TextureMap=new Map,this._TileMap=new Map,this._gl=null,this._firstPass=null,this._secondPass=null,this._glFrameBuffer=null,this._renderToTexture=null,this._glFramebufferToCanvasTransform=null,this._outputCanvas=null,this._outputContext=null,this._clippingCanvas=null,this._clippingContext=null,this._renderingCanvas=null,this._backupCanvasDrawer=null,this._imageSmoothingEnabled=!0,this._boundToTileReady=l=>this._tileReadyHandler(l),this._boundToImageUnloaded=l=>this._imageUnloadedHandler(l),this.viewer.addHandler("tile-ready",this._boundToTileReady),this.viewer.addHandler("image-unloaded",this._boundToImageUnloaded),this.viewer.rejectEventHandler("tile-drawn","The WebGLDrawer does not raise the tile-drawn event"),this.viewer.rejectEventHandler("tile-drawing","The WebGLDrawer does not raise the tile-drawing event"),this._setupCanvases(),this._setupRenderer(),this.context=this._outputContext}destroy(){if(this._destroyed)return;let o=this._gl;var l=o.getParameter(o.MAX_TEXTURE_IMAGE_UNITS);for(let u=0;u<l;++u)o.activeTexture(o.TEXTURE0+u),o.bindTexture(o.TEXTURE_2D,null),o.bindTexture(o.TEXTURE_CUBE_MAP,null);o.bindBuffer(o.ARRAY_BUFFER,null),o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,null),o.bindRenderbuffer(o.RENDERBUFFER,null),o.bindFramebuffer(o.FRAMEBUFFER,null),this._unloadTextures(),o.deleteBuffer(this._secondPass.bufferOutputPosition),o.deleteFramebuffer(this._glFrameBuffer),this._renderingCanvas.width=this._renderingCanvas.height=1,this._clippingCanvas.width=this._clippingCanvas.height=1,this._outputCanvas.width=this._outputCanvas.height=1,this._renderingCanvas=null,this._clippingCanvas=this._clippingContext=null,this._outputCanvas=this._outputContext=null;let d=o.getExtension("WEBGL_lose_context");d&&d.loseContext(),this.viewer.removeHandler("tile-ready",this._boundToTileReady),this.viewer.removeHandler("image-unloaded",this._boundToImageUnloaded),this.viewer.removeHandler("resize",this._resizeHandler),this._gl=null,this._backupCanvasDrawer&&(this._backupCanvasDrawer.destroy(),this._backupCanvasDrawer=null),this.container.removeChild(this.canvas),this.viewer.drawer===this&&(this.viewer.drawer=null),this._destroyed=!0}canRotate(){return!0}static isSupported(){let o=document.createElement("canvas"),l=i.isFunction(o.getContext)&&o.getContext("webgl"),d=l&&l.getExtension("WEBGL_lose_context");return d&&d.loseContext(),!!l}getType(){return"webgl"}minimumOverlapRequired(o){return o.isTainted()}_createDrawingElement(){let o=i.makeNeutralElement("canvas"),l=this._calculateCanvasSize();return o.width=l.x,o.height=l.y,o}_getBackupCanvasDrawer(){return this._backupCanvasDrawer||(this._backupCanvasDrawer=this.viewer.requestDrawer("canvas",{mainDrawer:!1}),this._backupCanvasDrawer.canvas.style.setProperty("visibility","hidden")),this._backupCanvasDrawer}draw(o){let l=this._gl;const d=this.viewport.getBoundsNoRotateWithMargins(!0);let u={bounds:d,center:new r.Point(d.x+d.width/2,d.y+d.height/2),rotation:this.viewport.getRotation(!0)*Math.PI/180},h=this.viewport.flipped?-1:1,f=i.Mat3.makeTranslation(-u.center.x,-u.center.y),g=i.Mat3.makeScaling(2/u.bounds.width*h,-2/u.bounds.height),v=i.Mat3.makeRotation(-u.rotation),T=g.multiply(v).multiply(f);l.bindFramebuffer(l.FRAMEBUFFER,null),l.clear(l.COLOR_BUFFER_BIT),this._outputContext.clearRect(0,0,this._outputCanvas.width,this._outputCanvas.height);let E=!1;o.forEach((_,C)=>{if(_.isTainted()){E&&(this._outputContext.drawImage(this._renderingCanvas,0,0),l.bindFramebuffer(l.FRAMEBUFFER,null),l.clear(l.COLOR_BUFFER_BIT),E=!1);const D=this._getBackupCanvasDrawer();D.draw([_]),this._outputContext.drawImage(D.canvas,0,0)}else{let D=_.getTilesToDraw();if(_.placeholderFillStyle&&_._hasOpaqueTile===!1&&this._drawPlaceholder(_),D.length===0||_.getOpacity()===0)return;let H=D[0],N=_.compositeOperation||this.viewer.compositeOperation||_._clip||_._croppingPolygons||_.debugMode,J=N||_.opacity<1||H.hasTransparency;N&&(E&&this._outputContext.drawImage(this._renderingCanvas,0,0),l.bindFramebuffer(l.FRAMEBUFFER,null),l.clear(l.COLOR_BUFFER_BIT)),l.useProgram(this._firstPass.shaderProgram),J?(l.bindFramebuffer(l.FRAMEBUFFER,this._glFrameBuffer),l.clear(l.COLOR_BUFFER_BIT)):l.bindFramebuffer(l.FRAMEBUFFER,null);let Q=T,ee=_.getRotation(!0);if(ee%360!==0){let re=i.Mat3.makeRotation(-ee*Math.PI/180),Te=_.getBoundsNoRotate(!0).getCenter(),Me=i.Mat3.makeTranslation(Te.x,Te.y),Le=i.Mat3.makeTranslation(-Te.x,-Te.y),Ce=Me.multiply(re).multiply(Le);Q=T.multiply(Ce)}let he=this._gl.getParameter(this._gl.MAX_TEXTURE_IMAGE_UNITS);if(he<=0)throw new Error(`WegGL error: bad value for gl parameter MAX_TEXTURE_IMAGE_UNITS (${he}). This could happen
                        if too many contexts have been created and not released, or there is another problem with the graphics card.`);let ie=new Float32Array(he*12),ue=new Array(he),se=new Array(he),pe=new Array(he);for(let re=0;re<D.length;re++){let Te=D[re].tile,Me=re%he,Le=Me+1,Ce=Te.getCanvasContext(),Se=Ce?this._TextureMap.get(Ce.canvas):null;if(Se||(this._tileReadyHandler({tile:Te,tiledImage:_}),Se=Ce?this._TextureMap.get(Ce.canvas):null),Se&&this._getTileData(Te,_,Se,Q,Me,ie,ue,se,pe),Le===he||re===D.length-1){for(let Y=0;Y<=Le;Y++)l.activeTexture(l.TEXTURE0+Y),l.bindTexture(l.TEXTURE_2D,ue[Y]);l.bindBuffer(l.ARRAY_BUFFER,this._firstPass.bufferTexturePosition),l.bufferData(l.ARRAY_BUFFER,ie,l.DYNAMIC_DRAW),se.forEach((Y,de)=>{l.uniformMatrix3fv(this._firstPass.uTransformMatrices[de],!1,Y)}),l.uniform1fv(this._firstPass.uOpacities,new Float32Array(pe)),l.bindBuffer(l.ARRAY_BUFFER,this._firstPass.bufferOutputPosition),l.vertexAttribPointer(this._firstPass.aOutputPosition,2,l.FLOAT,!1,0,0),l.bindBuffer(l.ARRAY_BUFFER,this._firstPass.bufferTexturePosition),l.vertexAttribPointer(this._firstPass.aTexturePosition,2,l.FLOAT,!1,0,0),l.bindBuffer(l.ARRAY_BUFFER,this._firstPass.bufferIndex),l.vertexAttribPointer(this._firstPass.aIndex,1,l.FLOAT,!1,0,0),l.drawArrays(l.TRIANGLES,0,6*Le)}}J&&(l.useProgram(this._secondPass.shaderProgram),l.bindFramebuffer(l.FRAMEBUFFER,null),l.activeTexture(l.TEXTURE0),l.bindTexture(l.TEXTURE_2D,this._renderToTexture),this._gl.uniform1f(this._secondPass.uOpacityMultiplier,_.opacity),l.bindBuffer(l.ARRAY_BUFFER,this._secondPass.bufferTexturePosition),l.vertexAttribPointer(this._secondPass.aTexturePosition,2,l.FLOAT,!1,0,0),l.bindBuffer(l.ARRAY_BUFFER,this._secondPass.bufferOutputPosition),l.vertexAttribPointer(this._secondPass.aOutputPosition,2,l.FLOAT,!1,0,0),l.drawArrays(l.TRIANGLES,0,6)),E=!0,N&&(this._applyContext2dPipeline(_,D,C),E=!1,l.bindFramebuffer(l.FRAMEBUFFER,null),l.clear(l.COLOR_BUFFER_BIT)),C===0&&this._raiseTiledImageDrawnEvent(_,D.map(re=>re.tile))}}),E&&this._outputContext.drawImage(this._renderingCanvas,0,0)}setImageSmoothingEnabled(o){this._imageSmoothingEnabled!==o&&(this._imageSmoothingEnabled=o,this._unloadTextures(),this.viewer.world.draw())}drawDebuggingRect(o){let l=this._outputContext;l.save(),l.lineWidth=2*i.pixelDensityRatio,l.strokeStyle=this.debugGridColor[0],l.fillStyle=this.debugGridColor[0],l.strokeRect(o.x*i.pixelDensityRatio,o.y*i.pixelDensityRatio,o.width*i.pixelDensityRatio,o.height*i.pixelDensityRatio),l.restore()}_getTextureDataFromTile(o){return o.getCanvasContext().canvas}_applyContext2dPipeline(o,l,d){if(this._outputContext.save(),this._outputContext.globalCompositeOperation=d===0?null:o.compositeOperation||this.viewer.compositeOperation,o._croppingPolygons||o._clip?(this._renderToClippingCanvas(o),this._outputContext.drawImage(this._clippingCanvas,0,0)):this._outputContext.drawImage(this._renderingCanvas,0,0),this._outputContext.restore(),o.debugMode){const u=this.viewer.viewport.getFlip();u&&this._flip(),this._drawDebugInfo(l,o,u),u&&this._flip()}}_getTileData(o,l,d,u,h,f,g,v,T){let E=d.texture,_=d.position;f.set(_,h*12);let C=this._calculateOverlapFraction(o,l),D=o.positionedBounds.width*C.x,H=o.positionedBounds.height*C.y,N=o.positionedBounds.x+(o.x===0?0:D),J=o.positionedBounds.y+(o.y===0?0:H),Q=o.positionedBounds.x+o.positionedBounds.width-(o.isRightMost?0:D),ee=o.positionedBounds.y+o.positionedBounds.height-(o.isBottomMost?0:H),he=Q-N,ie=ee-J,ue=new i.Mat3([he,0,0,0,ie,0,N,J,1]);if(o.flipped){let pe=i.Mat3.makeTranslation(.5,0),re=i.Mat3.makeTranslation(-.5,0),Te=pe.multiply(i.Mat3.makeScaling(-1,1)).multiply(re);ue=ue.multiply(Te)}let se=u.multiply(ue);T[h]=o.opacity,g[h]=E,v[h]=se.values}_textureFilter(){return this._imageSmoothingEnabled?this._gl.LINEAR:this._gl.NEAREST}_setupRenderer(){let o=this._gl;o||i.console.error("_setupCanvases must be called before _setupRenderer"),this._unitQuad=this._makeQuadVertexBuffer(0,1,0,1),this._makeFirstPassShaderProgram(),this._makeSecondPassShaderProgram(),this._renderToTexture=o.createTexture(),o.activeTexture(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,this._renderToTexture),o.texImage2D(o.TEXTURE_2D,0,o.RGBA,this._renderingCanvas.width,this._renderingCanvas.height,0,o.RGBA,o.UNSIGNED_BYTE,null),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,this._textureFilter()),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),this._glFrameBuffer=o.createFramebuffer(),o.bindFramebuffer(o.FRAMEBUFFER,this._glFrameBuffer),o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,this._renderToTexture,0),o.enable(o.BLEND),o.blendFunc(o.ONE,o.ONE_MINUS_SRC_ALPHA)}_makeFirstPassShaderProgram(){let o=this._glNumTextures=this._gl.getParameter(this._gl.MAX_TEXTURE_IMAGE_UNITS),l=()=>[...Array(o).keys()].map(E=>`uniform mat3 u_matrix_${E};`).join(`
`),d=()=>[...Array(o).keys()].map(E=>`${E>0?"else ":""}if(int(a_index) == ${E}) { transform_matrix = u_matrix_${E}; }`).join(`
`);const u=`
            attribute vec2 a_output_position;
            attribute vec2 a_texture_position;
            attribute float a_index;

            ${l()} // create a uniform mat3 for each potential tile to draw

            varying vec2 v_texture_position;
            varying float v_image_index;

            void main() {

                mat3 transform_matrix; // value will be set by the if/elses in makeConditional()

                ${d()}

                gl_Position = vec4(transform_matrix * vec3(a_output_position, 1), 1);

                v_texture_position = a_texture_position;
                v_image_index = a_index;
            }
            `,h=`
            precision mediump float;

            // our textures
            uniform sampler2D u_images[${o}];
            // our opacities
            uniform float u_opacities[${o}];

            // the varyings passed in from the vertex shader.
            varying vec2 v_texture_position;
            varying float v_image_index;

            void main() {
                // can't index directly with a variable, need to use a loop iterator hack
                for(int i = 0; i < ${o}; ++i){
                    if(i == int(v_image_index)){
                        gl_FragColor = texture2D(u_images[i], v_texture_position) * u_opacities[i];
                    }
                }
            }
            `;let f=this._gl,g=this.constructor.initShaderProgram(f,u,h);f.useProgram(g),this._firstPass={shaderProgram:g,aOutputPosition:f.getAttribLocation(g,"a_output_position"),aTexturePosition:f.getAttribLocation(g,"a_texture_position"),aIndex:f.getAttribLocation(g,"a_index"),uTransformMatrices:[...Array(this._glNumTextures).keys()].map(E=>f.getUniformLocation(g,`u_matrix_${E}`)),uImages:f.getUniformLocation(g,"u_images"),uOpacities:f.getUniformLocation(g,"u_opacities"),bufferOutputPosition:f.createBuffer(),bufferTexturePosition:f.createBuffer(),bufferIndex:f.createBuffer()},f.uniform1iv(this._firstPass.uImages,[...Array(o).keys()]);let v=new Float32Array(o*12);for(let E=0;E<o;++E)v.set(Float32Array.from(this._unitQuad),E*12);f.bindBuffer(f.ARRAY_BUFFER,this._firstPass.bufferOutputPosition),f.bufferData(f.ARRAY_BUFFER,v,f.STATIC_DRAW),f.enableVertexAttribArray(this._firstPass.aOutputPosition),f.bindBuffer(f.ARRAY_BUFFER,this._firstPass.bufferTexturePosition),f.enableVertexAttribArray(this._firstPass.aTexturePosition),f.bindBuffer(f.ARRAY_BUFFER,this._firstPass.bufferIndex);let T=[...Array(this._glNumTextures).keys()].map(E=>Array(6).fill(E)).flat();f.bufferData(f.ARRAY_BUFFER,new Float32Array(T),f.STATIC_DRAW),f.enableVertexAttribArray(this._firstPass.aIndex)}_makeSecondPassShaderProgram(){const o=`
            attribute vec2 a_output_position;
            attribute vec2 a_texture_position;

            uniform mat3 u_matrix;

            varying vec2 v_texture_position;

            void main() {
                gl_Position = vec4(u_matrix * vec3(a_output_position, 1), 1);

                v_texture_position = a_texture_position;
            }
            `,l=`
            precision mediump float;

            // our texture
            uniform sampler2D u_image;

            // the texCoords passed in from the vertex shader.
            varying vec2 v_texture_position;

            // the opacity multiplier for the image
            uniform float u_opacity_multiplier;

            void main() {
                gl_FragColor = texture2D(u_image, v_texture_position);
                gl_FragColor *= u_opacity_multiplier;
            }
            `;let d=this._gl,u=this.constructor.initShaderProgram(d,o,l);d.useProgram(u),this._secondPass={shaderProgram:u,aOutputPosition:d.getAttribLocation(u,"a_output_position"),aTexturePosition:d.getAttribLocation(u,"a_texture_position"),uMatrix:d.getUniformLocation(u,"u_matrix"),uImage:d.getUniformLocation(u,"u_image"),uOpacityMultiplier:d.getUniformLocation(u,"u_opacity_multiplier"),bufferOutputPosition:d.createBuffer(),bufferTexturePosition:d.createBuffer()},d.bindBuffer(d.ARRAY_BUFFER,this._secondPass.bufferOutputPosition),d.bufferData(d.ARRAY_BUFFER,this._unitQuad,d.STATIC_DRAW),d.enableVertexAttribArray(this._secondPass.aOutputPosition),d.bindBuffer(d.ARRAY_BUFFER,this._secondPass.bufferTexturePosition),d.bufferData(d.ARRAY_BUFFER,this._unitQuad,d.DYNAMIC_DRAW),d.enableVertexAttribArray(this._secondPass.aTexturePosition);let h=i.Mat3.makeScaling(2,2).multiply(i.Mat3.makeTranslation(-.5,-.5));d.uniformMatrix3fv(this._secondPass.uMatrix,!1,h.values)}_resizeRenderer(){let o=this._gl,l=this._renderingCanvas.width,d=this._renderingCanvas.height;o.viewport(0,0,l,d),o.deleteTexture(this._renderToTexture),this._renderToTexture=o.createTexture(),o.activeTexture(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,this._renderToTexture),o.texImage2D(o.TEXTURE_2D,0,o.RGBA,l,d,0,o.RGBA,o.UNSIGNED_BYTE,null),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,this._textureFilter()),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),o.bindFramebuffer(o.FRAMEBUFFER,this._glFrameBuffer),o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,this._renderToTexture,0)}_setupCanvases(){let o=this;this._outputCanvas=this.canvas,this._outputContext=this._outputCanvas.getContext("2d"),this._renderingCanvas=document.createElement("canvas"),this._clippingCanvas=document.createElement("canvas"),this._clippingContext=this._clippingCanvas.getContext("2d"),this._renderingCanvas.width=this._clippingCanvas.width=this._outputCanvas.width,this._renderingCanvas.height=this._clippingCanvas.height=this._outputCanvas.height,this._gl=this._renderingCanvas.getContext("webgl"),this._resizeHandler=function(){o._outputCanvas!==o.viewer.drawer.canvas&&(o._outputCanvas.style.width=o.viewer.drawer.canvas.clientWidth+"px",o._outputCanvas.style.height=o.viewer.drawer.canvas.clientHeight+"px");let l=o._calculateCanvasSize();(o._outputCanvas.width!==l.x||o._outputCanvas.height!==l.y)&&(o._outputCanvas.width=l.x,o._outputCanvas.height=l.y),o._renderingCanvas.style.width=o._outputCanvas.clientWidth+"px",o._renderingCanvas.style.height=o._outputCanvas.clientHeight+"px",o._renderingCanvas.width=o._clippingCanvas.width=o._outputCanvas.width,o._renderingCanvas.height=o._clippingCanvas.height=o._outputCanvas.height,o._resizeRenderer()},this.viewer.addHandler("resize",this._resizeHandler)}_makeQuadVertexBuffer(o,l,d,u){return new Float32Array([o,u,l,u,o,d,o,d,l,u,l,d])}_tileReadyHandler(o){let l=o.tile,d=o.tiledImage;if(d.isTainted())return;let u=l.getCanvasContext(),h=u&&u.canvas;if(!h||i.isCanvasTainted(h)){d.isTainted()||(d.setTainted(!0),i.console.warn("WebGL cannot be used to draw this TiledImage because it has tainted data. Does crossOriginPolicy need to be set?"),this._raiseDrawerErrorEvent(d,"Tainted data cannot be used by the WebGLDrawer. Falling back to CanvasDrawer for this TiledImage."));return}if(!this._TextureMap.get(h)){let g=this._gl,v=g.createTexture(),T,E=d.source.tileOverlap,_,C;if(l.sourceBounds?(_=Math.min(l.sourceBounds.width,h.width)/h.width,C=Math.min(l.sourceBounds.height,h.height)/h.height):(_=1,C=1),E>0){let H=this._calculateOverlapFraction(l,d),N=(l.x===0?0:H.x)*_,J=(l.y===0?0:H.y)*C,Q=(l.isRightMost?1:1-H.x)*_,ee=(l.isBottomMost?1:1-H.y)*C;T=this._makeQuadVertexBuffer(N,Q,J,ee)}else _===1&&C===1?T=this._unitQuad:T=this._makeQuadVertexBuffer(0,_,0,C);let D={texture:v,position:T};this._TextureMap.set(h,D),g.activeTexture(g.TEXTURE0),g.bindTexture(g.TEXTURE_2D,v),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,g.CLAMP_TO_EDGE),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,g.CLAMP_TO_EDGE),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,this._textureFilter()),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,this._textureFilter()),this._uploadImageData(u)}}_calculateOverlapFraction(o,l){let d=l.source.tileOverlap,u=o.sourceBounds.width,h=o.sourceBounds.height,f=(o.x===0?0:d)+(o.isRightMost?0:d),g=(o.y===0?0:d)+(o.isBottomMost?0:d),v=d/(u+f),T=d/(h+g);return{x:v,y:T}}_unloadTextures(){Array.from(this._TextureMap.keys()).forEach(l=>{this._cleanupImageData(l)})}_uploadImageData(o){let l=this._gl,d=o.canvas;try{if(!d)throw o;l.texImage2D(l.TEXTURE_2D,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,d)}catch(u){i.console.error("Error uploading image data to WebGL",u)}}_imageUnloadedHandler(o){let l=o.context2D.canvas;this._cleanupImageData(l)}_cleanupImageData(o){let l=this._TextureMap.get(o);this._TextureMap.delete(o),l&&this._gl.deleteTexture(l.texture)}_setClip(){}_renderToClippingCanvas(o){if(this._clippingContext.clearRect(0,0,this._clippingCanvas.width,this._clippingCanvas.height),this._clippingContext.save(),this.viewer.viewport.getFlip()){const l=new i.Point(this.canvas.width/2,this.canvas.height/2);this._clippingContext.translate(l.x,0),this._clippingContext.scale(-1,1),this._clippingContext.translate(-l.x,0)}if(o._clip){let d=[{x:o._clip.x,y:o._clip.y},{x:o._clip.x+o._clip.width,y:o._clip.y},{x:o._clip.x+o._clip.width,y:o._clip.y+o._clip.height},{x:o._clip.x,y:o._clip.y+o._clip.height}].map(u=>{let h=o.imageToViewportCoordinates(u.x,u.y,!0).rotate(this.viewer.viewport.getRotation(!0),this.viewer.viewport.getCenter(!0));return this.viewportCoordToDrawerCoord(h)});this._clippingContext.beginPath(),d.forEach((u,h)=>{this._clippingContext[h===0?"moveTo":"lineTo"](u.x,u.y)}),this._clippingContext.clip(),this._setClip()}if(o._croppingPolygons){let l=o._croppingPolygons.map(d=>d.map(u=>{let h=o.imageToViewportCoordinates(u.x,u.y,!0).rotate(this.viewer.viewport.getRotation(!0),this.viewer.viewport.getCenter(!0));return this.viewportCoordToDrawerCoord(h)}));this._clippingContext.beginPath(),l.forEach(d=>{d.forEach((u,h)=>{this._clippingContext[h===0?"moveTo":"lineTo"](u.x,u.y)})}),this._clippingContext.clip()}if(this.viewer.viewport.getFlip()){const l=new i.Point(this.canvas.width/2,this.canvas.height/2);this._clippingContext.translate(l.x,0),this._clippingContext.scale(-1,1),this._clippingContext.translate(-l.x,0)}this._clippingContext.drawImage(this._renderingCanvas,0,0),this._clippingContext.restore()}_setRotations(o){var l=!1;this.viewport.getRotation(!0)%360!==0&&(this._offsetForRotation({degrees:this.viewport.getRotation(!0),saveContext:l}),l=!1),o.getRotation(!0)%360!==0&&this._offsetForRotation({degrees:o.getRotation(!0),point:this.viewport.pixelFromPointNoRotate(o._getRotationPoint(!0),!0),saveContext:l})}_offsetForRotation(o){var l=o.point?o.point.times(i.pixelDensityRatio):this._getCanvasCenter(),d=this._outputContext;d.save(),d.translate(l.x,l.y),d.rotate(Math.PI/180*o.degrees),d.translate(-l.x,-l.y)}_flip(o){o=o||{};var l=o.point?o.point.times(i.pixelDensityRatio):this._getCanvasCenter(),d=this._outputContext;d.translate(l.x,0),d.scale(-1,1),d.translate(-l.x,0)}_drawDebugInfo(o,l,d){for(var u=o.length-1;u>=0;u--){var h=o[u].tile;try{this._drawDebugInfoOnTile(h,o.length,u,l,d)}catch(f){i.console.error(f)}}}_drawDebugInfoOnTile(o,l,d,u,h){var f=this.viewer.world.getIndexOfItem(u)%this.debugGridColor.length,g=this.context;g.save(),g.lineWidth=2*i.pixelDensityRatio,g.font="small-caps bold "+13*i.pixelDensityRatio+"px arial",g.strokeStyle=this.debugGridColor[f],g.fillStyle=this.debugGridColor[f],this._setRotations(u),h&&this._flip({point:o.position.plus(o.size.divide(2))}),g.strokeRect(o.position.x*i.pixelDensityRatio,o.position.y*i.pixelDensityRatio,o.size.x*i.pixelDensityRatio,o.size.y*i.pixelDensityRatio);var v=(o.position.x+o.size.x/2)*i.pixelDensityRatio,T=(o.position.y+o.size.y/2)*i.pixelDensityRatio;g.translate(v,T);const E=this.viewport.getRotation(!0);g.rotate(Math.PI/180*-E),g.translate(-v,-T),o.x===0&&o.y===0&&(g.fillText("Zoom: "+this.viewport.getZoom(),o.position.x*i.pixelDensityRatio,(o.position.y-30)*i.pixelDensityRatio),g.fillText("Pan: "+this.viewport.getBounds().toString(),o.position.x*i.pixelDensityRatio,(o.position.y-20)*i.pixelDensityRatio)),g.fillText("Level: "+o.level,(o.position.x+10)*i.pixelDensityRatio,(o.position.y+20)*i.pixelDensityRatio),g.fillText("Column: "+o.x,(o.position.x+10)*i.pixelDensityRatio,(o.position.y+30)*i.pixelDensityRatio),g.fillText("Row: "+o.y,(o.position.x+10)*i.pixelDensityRatio,(o.position.y+40)*i.pixelDensityRatio),g.fillText("Order: "+d+" of "+l,(o.position.x+10)*i.pixelDensityRatio,(o.position.y+50)*i.pixelDensityRatio),g.fillText("Size: "+o.size.toString(),(o.position.x+10)*i.pixelDensityRatio,(o.position.y+60)*i.pixelDensityRatio),g.fillText("Position: "+o.position.toString(),(o.position.x+10)*i.pixelDensityRatio,(o.position.y+70)*i.pixelDensityRatio),this.viewport.getRotation(!0)%360!==0&&this._restoreRotationChanges(),u.getRotation(!0)%360!==0&&this._restoreRotationChanges(),g.restore()}_drawPlaceholder(o){const l=o.getBounds(!0),d=this.viewportToDrawerRectangle(o.getBounds(!0)),u=this._outputContext;let h;typeof o.placeholderFillStyle=="function"?h=o.placeholderFillStyle(o,u):h=o.placeholderFillStyle,this._offsetForRotation({degrees:this.viewer.viewport.getRotation(!0)}),u.fillStyle=h,u.translate(d.x,d.y),u.rotate(Math.PI/180*l.degrees),u.translate(-d.x,-d.y),u.fillRect(d.x,d.y,d.width,d.height),this._restoreRotationChanges()}_getCanvasCenter(){return new i.Point(this.canvas.width/2,this.canvas.height/2)}_restoreRotationChanges(){var o=this._outputContext;o.restore()}static initShaderProgram(o,l,d){function u(v,T,E){const _=v.createShader(T);return v.shaderSource(_,E),v.compileShader(_),v.getShaderParameter(_,v.COMPILE_STATUS)?_:(i.console.error(`An error occurred compiling the shaders: ${v.getShaderInfoLog(_)}`),v.deleteShader(_),null)}const h=u(o,o.VERTEX_SHADER,l),f=u(o,o.FRAGMENT_SHADER,d),g=o.createProgram();return o.attachShader(g,h),o.attachShader(g,f),o.linkProgram(g),o.getProgramParameter(g,o.LINK_STATUS)?g:(i.console.error(`Unable to initialize the shader program: ${o.getProgramInfoLog(g)}`),null)}}})(M),(function(i){i.Viewport=function(r){var a=arguments;a.length&&a[0]instanceof i.Point&&(r={containerSize:a[0],contentSize:a[1],config:a[2]}),r.config&&(i.extend(!0,r,r.config),delete r.config),this._margins=i.extend({left:0,top:0,right:0,bottom:0},r.margins||{}),delete r.margins,r.initialDegrees=r.degrees,delete r.degrees,i.extend(!0,this,{containerSize:null,contentSize:null,zoomPoint:null,rotationPivot:null,viewer:null,springStiffness:i.DEFAULT_SETTINGS.springStiffness,animationTime:i.DEFAULT_SETTINGS.animationTime,minZoomImageRatio:i.DEFAULT_SETTINGS.minZoomImageRatio,maxZoomPixelRatio:i.DEFAULT_SETTINGS.maxZoomPixelRatio,visibilityRatio:i.DEFAULT_SETTINGS.visibilityRatio,wrapHorizontal:i.DEFAULT_SETTINGS.wrapHorizontal,wrapVertical:i.DEFAULT_SETTINGS.wrapVertical,defaultZoomLevel:i.DEFAULT_SETTINGS.defaultZoomLevel,minZoomLevel:i.DEFAULT_SETTINGS.minZoomLevel,maxZoomLevel:i.DEFAULT_SETTINGS.maxZoomLevel,initialDegrees:i.DEFAULT_SETTINGS.degrees,flipped:i.DEFAULT_SETTINGS.flipped,homeFillsViewer:i.DEFAULT_SETTINGS.homeFillsViewer,silenceMultiImageWarnings:i.DEFAULT_SETTINGS.silenceMultiImageWarnings},r),this._updateContainerInnerSize(),this.centerSpringX=new i.Spring({initial:0,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.centerSpringY=new i.Spring({initial:0,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.zoomSpring=new i.Spring({exponential:!0,initial:1,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.degreesSpring=new i.Spring({initial:r.initialDegrees,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._oldCenterX=this.centerSpringX.current.value,this._oldCenterY=this.centerSpringY.current.value,this._oldZoom=this.zoomSpring.current.value,this._oldDegrees=this.degreesSpring.current.value,this._setContentBounds(new i.Rect(0,0,1,1),1),this.goHome(!0),this.update()},i.Viewport.prototype={get degrees(){return i.console.warn("Accessing [Viewport.degrees] is deprecated. Use viewport.getRotation instead."),this.getRotation()},set degrees(r){i.console.warn("Setting [Viewport.degrees] is deprecated. Use viewport.rotateTo, viewport.rotateBy, or viewport.setRotation instead."),this.rotateTo(r)},resetContentSize:function(r){return i.console.assert(r,"[Viewport.resetContentSize] contentSize is required"),i.console.assert(r instanceof i.Point,"[Viewport.resetContentSize] contentSize must be an OpenSeadragon.Point"),i.console.assert(r.x>0,"[Viewport.resetContentSize] contentSize.x must be greater than 0"),i.console.assert(r.y>0,"[Viewport.resetContentSize] contentSize.y must be greater than 0"),this._setContentBounds(new i.Rect(0,0,1,r.y/r.x),r.x),this},setHomeBounds:function(r,a){i.console.error("[Viewport.setHomeBounds] this function is deprecated; The content bounds should not be set manually."),this._setContentBounds(r,a)},_setContentBounds:function(r,a){i.console.assert(r,"[Viewport._setContentBounds] bounds is required"),i.console.assert(r instanceof i.Rect,"[Viewport._setContentBounds] bounds must be an OpenSeadragon.Rect"),i.console.assert(r.width>0,"[Viewport._setContentBounds] bounds.width must be greater than 0"),i.console.assert(r.height>0,"[Viewport._setContentBounds] bounds.height must be greater than 0"),this._contentBoundsNoRotate=r.clone(),this._contentSizeNoRotate=this._contentBoundsNoRotate.getSize().times(a),this._contentBounds=r.rotate(this.getRotation()).getBoundingBox(),this._contentSize=this._contentBounds.getSize().times(a),this._contentAspectRatio=this._contentSize.x/this._contentSize.y,this.viewer&&this.viewer.raiseEvent("reset-size",{contentSize:this._contentSizeNoRotate.clone(),contentFactor:a,homeBounds:this._contentBoundsNoRotate.clone(),contentBounds:this._contentBounds.clone()})},getHomeZoom:function(){if(this.defaultZoomLevel)return this.defaultZoomLevel;var r=this._contentAspectRatio/this.getAspectRatio(),a;return this.homeFillsViewer?a=r>=1?r:1:a=r>=1?1:r,a/this._contentBounds.width},getHomeBounds:function(){return this.getHomeBoundsNoRotate().rotate(-this.getRotation())},getHomeBoundsNoRotate:function(){var r=this._contentBounds.getCenter(),a=1/this.getHomeZoom(),o=a/this.getAspectRatio();return new i.Rect(r.x-a/2,r.y-o/2,a,o)},goHome:function(r){return this.viewer&&this.viewer.raiseEvent("home",{immediately:r}),this.fitBounds(this.getHomeBounds(),r)},getMinZoom:function(){var r=this.getHomeZoom(),a=this.minZoomLevel?this.minZoomLevel:this.minZoomImageRatio*r;return a},getMaxZoom:function(){var r=this.maxZoomLevel;return r||(r=this._contentSize.x*this.maxZoomPixelRatio/this._containerInnerSize.x,r/=this._contentBounds.width),Math.max(r,this.getHomeZoom())},getAspectRatio:function(){return this._containerInnerSize.x/this._containerInnerSize.y},getContainerSize:function(){return new i.Point(this.containerSize.x,this.containerSize.y)},getMargins:function(){return i.extend({},this._margins)},setMargins:function(r){i.console.assert(i.type(r)==="object","[Viewport.setMargins] margins must be an object"),this._margins=i.extend({left:0,top:0,right:0,bottom:0},r),this._updateContainerInnerSize(),this.viewer&&this.viewer.forceRedraw()},getBounds:function(r){return this.getBoundsNoRotate(r).rotate(-this.getRotation(r))},getBoundsNoRotate:function(r){var a=this.getCenter(r),o=1/this.getZoom(r),l=o/this.getAspectRatio();return new i.Rect(a.x-o/2,a.y-l/2,o,l)},getBoundsWithMargins:function(r){return this.getBoundsNoRotateWithMargins(r).rotate(-this.getRotation(r),this.getCenter(r))},getBoundsNoRotateWithMargins:function(r){var a=this.getBoundsNoRotate(r),o=this._containerInnerSize.x*this.getZoom(r);return a.x-=this._margins.left/o,a.y-=this._margins.top/o,a.width+=(this._margins.left+this._margins.right)/o,a.height+=(this._margins.top+this._margins.bottom)/o,a},getCenter:function(r){var a=new i.Point(this.centerSpringX.current.value,this.centerSpringY.current.value),o=new i.Point(this.centerSpringX.target.value,this.centerSpringY.target.value),l,d,u,h,f,g,v,T;return r?a:this.zoomPoint?(l=this.pixelFromPoint(this.zoomPoint,!0),d=this.getZoom(),u=1/d,h=u/this.getAspectRatio(),f=new i.Rect(a.x-u/2,a.y-h/2,u,h),g=this._pixelFromPoint(this.zoomPoint,f),v=g.minus(l).rotate(-this.getRotation(!0)),T=v.divide(this._containerInnerSize.x*d),o.plus(T)):o},getZoom:function(r){return r?this.zoomSpring.current.value:this.zoomSpring.target.value},_applyZoomConstraints:function(r){return Math.max(Math.min(r,this.getMaxZoom()),this.getMinZoom())},_applyBoundaryConstraints:function(r){var a=this.viewportToViewerElementRectangle(r).getBoundingBox(),o=this.viewportToViewerElementRectangle(this._contentBoundsNoRotate).getBoundingBox(),l=!1,d=!1;if(!this.wrapHorizontal){var u=a.x+a.width,h=o.x+o.width,f,g,v;a.width>o.width?f=this.visibilityRatio*o.width:f=this.visibilityRatio*a.width,g=o.x-u+f,v=h-a.x-f,f>o.width?(a.x+=(g+v)/2,l=!0):v<0?(a.x+=v,l=!0):g>0&&(a.x+=g,l=!0)}if(!this.wrapVertical){var T=a.y+a.height,E=o.y+o.height,_,C,D;a.height>o.height?_=this.visibilityRatio*o.height:_=this.visibilityRatio*a.height,C=o.y-T+_,D=E-a.y-_,_>o.height?(a.y+=(C+D)/2,d=!0):D<0?(a.y+=D,d=!0):C>0&&(a.y+=C,d=!0)}var H=l||d,N=H?this.viewerElementToViewportRectangle(a):r.clone();return N.xConstrained=l,N.yConstrained=d,N.constraintApplied=H,N},_raiseConstraintsEvent:function(r){this.viewer&&this.viewer.raiseEvent("constrain",{immediately:r})},applyConstraints:function(r){var a=this.getZoom(),o=this._applyZoomConstraints(a);a!==o&&this.zoomTo(o,this.zoomPoint,r);var l=this.getConstrainedBounds(!1);return l.constraintApplied&&(this.fitBounds(l,r),this._raiseConstraintsEvent(r)),this},ensureVisible:function(r){return this.applyConstraints(r)},_fitBounds:function(r,a){a=a||{};var o=a.immediately||!1,l=a.constraints||!1,d=this.getAspectRatio(),u=r.getCenter(),h=new i.Rect(r.x,r.y,r.width,r.height,r.degrees+this.getRotation()).getBoundingBox();h.getAspectRatio()>=d?h.height=h.width/d:h.width=h.height*d,h.x=u.x-h.width/2,h.y=u.y-h.height/2;var f=1/h.width;if(o)return this.panTo(u,!0),this.zoomTo(f,null,!0),l&&this.applyConstraints(!0),this;var g=this.getCenter(!0),v=this.getZoom(!0);this.panTo(g,!0),this.zoomTo(v,null,!0);var T=this.getBounds(),E=this.getZoom();if(E===0||Math.abs(f/E-1)<1e-8)return this.zoomTo(f,null,!0),this.panTo(u,o),l&&this.applyConstraints(!1),this;if(l){this.panTo(u,!1),f=this._applyZoomConstraints(f),this.zoomTo(f,null,!1);var _=this.getConstrainedBounds();this.panTo(g,!0),this.zoomTo(v,null,!0),this.fitBounds(_)}else{var C=h.rotate(-this.getRotation()),D=C.getTopLeft().times(f).minus(T.getTopLeft().times(E)).divide(f-E);this.zoomTo(f,D,o)}return this},fitBounds:function(r,a){return this._fitBounds(r,{immediately:a,constraints:!1})},fitBoundsWithConstraints:function(r,a){return this._fitBounds(r,{immediately:a,constraints:!0})},fitVertically:function(r){var a=new i.Rect(this._contentBounds.x+this._contentBounds.width/2,this._contentBounds.y,0,this._contentBounds.height);return this.fitBounds(a,r)},fitHorizontally:function(r){var a=new i.Rect(this._contentBounds.x,this._contentBounds.y+this._contentBounds.height/2,this._contentBounds.width,0);return this.fitBounds(a,r)},getConstrainedBounds:function(r){var a,o;return a=this.getBounds(r),o=this._applyBoundaryConstraints(a),o},panBy:function(r,a){var o=new i.Point(this.centerSpringX.target.value,this.centerSpringY.target.value);return this.panTo(o.plus(r),a)},panTo:function(r,a){return a?(this.centerSpringX.resetTo(r.x),this.centerSpringY.resetTo(r.y)):(this.centerSpringX.springTo(r.x),this.centerSpringY.springTo(r.y)),this.viewer&&this.viewer.raiseEvent("pan",{center:r,immediately:a}),this},zoomBy:function(r,a,o){return this.zoomTo(this.zoomSpring.target.value*r,a,o)},zoomTo:function(r,a,o){var l=this;return this.zoomPoint=a instanceof i.Point&&!isNaN(a.x)&&!isNaN(a.y)?a:null,o?this._adjustCenterSpringsForZoomPoint(function(){l.zoomSpring.resetTo(r)}):this.zoomSpring.springTo(r),this.viewer&&this.viewer.raiseEvent("zoom",{zoom:r,refPoint:a,immediately:o}),this},setRotation:function(r,a){return this.rotateTo(r,null,a)},getRotation:function(r){return r?this.degreesSpring.current.value:this.degreesSpring.target.value},setRotationWithPivot:function(r,a,o){return this.rotateTo(r,a,o)},rotateTo:function(r,a,o){if(!this.viewer||!this.viewer.drawer.canRotate())return this;if(this.degreesSpring.target.value===r&&this.degreesSpring.isAtTargetValue())return this;if(this.rotationPivot=a instanceof i.Point&&!isNaN(a.x)&&!isNaN(a.y)?a:null,o)if(this.rotationPivot){var l=r-this._oldDegrees;if(!l)return this.rotationPivot=null,this;this._rotateAboutPivot(r)}else this.degreesSpring.resetTo(r);else{var d=i.positiveModulo(this.degreesSpring.current.value,360),u=i.positiveModulo(r,360),h=u-d;h>180?u-=360:h<-180&&(u+=360);var f=d-u;this.degreesSpring.resetTo(r+f),this.degreesSpring.springTo(r)}return this._setContentBounds(this.viewer.world.getHomeBounds(),this.viewer.world.getContentFactor()),this.viewer.forceRedraw(),this.viewer.raiseEvent("rotate",{degrees:r,immediately:!!o,pivot:this.rotationPivot||this.getCenter()}),this},rotateBy:function(r,a,o){return this.rotateTo(this.degreesSpring.target.value+r,a,o)},resize:function(r,a){var o=this.getBoundsNoRotate(),l=o,d;this.containerSize.x=r.x,this.containerSize.y=r.y,this._updateContainerInnerSize(),a&&(d=r.x/this.containerSize.x,l.width=o.width*d,l.height=l.width/this.getAspectRatio()),this.viewer&&this.viewer.raiseEvent("resize",{newContainerSize:r,maintain:a});var u=this.fitBounds(l,!0);return this.viewer&&this.viewer.raiseEvent("after-resize",{newContainerSize:r,maintain:a}),u},_updateContainerInnerSize:function(){this._containerInnerSize=new i.Point(Math.max(1,this.containerSize.x-(this._margins.left+this._margins.right)),Math.max(1,this.containerSize.y-(this._margins.top+this._margins.bottom)))},update:function(){var r=this;this._adjustCenterSpringsForZoomPoint(function(){r.zoomSpring.update()}),this.degreesSpring.isAtTargetValue()&&(this.rotationPivot=null),this.centerSpringX.update(),this.centerSpringY.update(),this.rotationPivot?this._rotateAboutPivot(!0):this.degreesSpring.update();var a=this.centerSpringX.current.value!==this._oldCenterX||this.centerSpringY.current.value!==this._oldCenterY||this.zoomSpring.current.value!==this._oldZoom||this.degreesSpring.current.value!==this._oldDegrees;this._oldCenterX=this.centerSpringX.current.value,this._oldCenterY=this.centerSpringY.current.value,this._oldZoom=this.zoomSpring.current.value,this._oldDegrees=this.degreesSpring.current.value;var o=a||!this.zoomSpring.isAtTargetValue()||!this.centerSpringX.isAtTargetValue()||!this.centerSpringY.isAtTargetValue()||!this.degreesSpring.isAtTargetValue();return o},_rotateAboutPivot:function(r){var a=r===!0,o=this.rotationPivot.minus(this.getCenter());this.centerSpringX.shiftBy(o.x),this.centerSpringY.shiftBy(o.y),a?this.degreesSpring.update():this.degreesSpring.resetTo(r);var l=this.degreesSpring.current.value-this._oldDegrees,d=o.rotate(l*-1).times(-1);this.centerSpringX.shiftBy(d.x),this.centerSpringY.shiftBy(d.y)},_adjustCenterSpringsForZoomPoint:function(r){if(this.zoomPoint){var a=this.pixelFromPoint(this.zoomPoint,!0);r();var o=this.pixelFromPoint(this.zoomPoint,!0),l=o.minus(a),d=this.deltaPointsFromPixels(l,!0);this.centerSpringX.shiftBy(d.x),this.centerSpringY.shiftBy(d.y),this.zoomSpring.isAtTargetValue()&&(this.zoomPoint=null)}else r()},deltaPixelsFromPointsNoRotate:function(r,a){return r.times(this._containerInnerSize.x*this.getZoom(a))},deltaPixelsFromPoints:function(r,a){return this.deltaPixelsFromPointsNoRotate(r.rotate(this.getRotation(a)),a)},deltaPointsFromPixelsNoRotate:function(r,a){return r.divide(this._containerInnerSize.x*this.getZoom(a))},deltaPointsFromPixels:function(r,a){return this.deltaPointsFromPixelsNoRotate(r,a).rotate(-this.getRotation(a))},pixelFromPointNoRotate:function(r,a){return this._pixelFromPointNoRotate(r,this.getBoundsNoRotate(a))},pixelFromPoint:function(r,a){return this._pixelFromPoint(r,this.getBoundsNoRotate(a))},_pixelFromPointNoRotate:function(r,a){return r.minus(a.getTopLeft()).times(this._containerInnerSize.x/a.width).plus(new i.Point(this._margins.left,this._margins.top))},_pixelFromPoint:function(r,a){return this._pixelFromPointNoRotate(r.rotate(this.getRotation(!0),this.getCenter(!0)),a)},pointFromPixelNoRotate:function(r,a){var o=this.getBoundsNoRotate(a);return r.minus(new i.Point(this._margins.left,this._margins.top)).divide(this._containerInnerSize.x/o.width).plus(o.getTopLeft())},pointFromPixel:function(r,a){return this.pointFromPixelNoRotate(r,a).rotate(-this.getRotation(a),this.getCenter(a))},_viewportToImageDelta:function(r,a){var o=this._contentBoundsNoRotate.width;return new i.Point(r*this._contentSizeNoRotate.x/o,a*this._contentSizeNoRotate.x/o)},viewportToImageCoordinates:function(r,a){if(r instanceof i.Point)return this.viewportToImageCoordinates(r.x,r.y);if(this.viewer){var o=this.viewer.world.getItemCount();if(o>1)this.silenceMultiImageWarnings||i.console.error("[Viewport.viewportToImageCoordinates] is not accurate with multi-image; use TiledImage.viewportToImageCoordinates instead.");else if(o===1){var l=this.viewer.world.getItemAt(0);return l.viewportToImageCoordinates(r,a,!0)}}return this._viewportToImageDelta(r-this._contentBoundsNoRotate.x,a-this._contentBoundsNoRotate.y)},_imageToViewportDelta:function(r,a){var o=this._contentBoundsNoRotate.width;return new i.Point(r/this._contentSizeNoRotate.x*o,a/this._contentSizeNoRotate.x*o)},imageToViewportCoordinates:function(r,a){if(r instanceof i.Point)return this.imageToViewportCoordinates(r.x,r.y);if(this.viewer){var o=this.viewer.world.getItemCount();if(o>1)this.silenceMultiImageWarnings||i.console.error("[Viewport.imageToViewportCoordinates] is not accurate with multi-image; use TiledImage.imageToViewportCoordinates instead.");else if(o===1){var l=this.viewer.world.getItemAt(0);return l.imageToViewportCoordinates(r,a,!0)}}var d=this._imageToViewportDelta(r,a);return d.x+=this._contentBoundsNoRotate.x,d.y+=this._contentBoundsNoRotate.y,d},imageToViewportRectangle:function(r,a,o,l){var d=r;if(d instanceof i.Rect||(d=new i.Rect(r,a,o,l)),this.viewer){var u=this.viewer.world.getItemCount();if(u>1)this.silenceMultiImageWarnings||i.console.error("[Viewport.imageToViewportRectangle] is not accurate with multi-image; use TiledImage.imageToViewportRectangle instead.");else if(u===1){var h=this.viewer.world.getItemAt(0);return h.imageToViewportRectangle(r,a,o,l,!0)}}var f=this.imageToViewportCoordinates(d.x,d.y),g=this._imageToViewportDelta(d.width,d.height);return new i.Rect(f.x,f.y,g.x,g.y,d.degrees)},viewportToImageRectangle:function(r,a,o,l){var d=r;if(d instanceof i.Rect||(d=new i.Rect(r,a,o,l)),this.viewer){var u=this.viewer.world.getItemCount();if(u>1)this.silenceMultiImageWarnings||i.console.error("[Viewport.viewportToImageRectangle] is not accurate with multi-image; use TiledImage.viewportToImageRectangle instead.");else if(u===1){var h=this.viewer.world.getItemAt(0);return h.viewportToImageRectangle(r,a,o,l,!0)}}var f=this.viewportToImageCoordinates(d.x,d.y),g=this._viewportToImageDelta(d.width,d.height);return new i.Rect(f.x,f.y,g.x,g.y,d.degrees)},viewerElementToImageCoordinates:function(r){var a=this.pointFromPixel(r,!0);return this.viewportToImageCoordinates(a)},imageToViewerElementCoordinates:function(r){var a=this.imageToViewportCoordinates(r);return this.pixelFromPoint(a,!0)},windowToImageCoordinates:function(r){i.console.assert(this.viewer,"[Viewport.windowToImageCoordinates] the viewport must have a viewer.");var a=r.minus(i.getElementPosition(this.viewer.element));return this.viewerElementToImageCoordinates(a)},imageToWindowCoordinates:function(r){i.console.assert(this.viewer,"[Viewport.imageToWindowCoordinates] the viewport must have a viewer.");var a=this.imageToViewerElementCoordinates(r);return a.plus(i.getElementPosition(this.viewer.element))},viewerElementToViewportCoordinates:function(r){return this.pointFromPixel(r,!0)},viewportToViewerElementCoordinates:function(r){return this.pixelFromPoint(r,!0)},viewerElementToViewportRectangle:function(r){return i.Rect.fromSummits(this.pointFromPixel(r.getTopLeft(),!0),this.pointFromPixel(r.getTopRight(),!0),this.pointFromPixel(r.getBottomLeft(),!0))},viewportToViewerElementRectangle:function(r){return i.Rect.fromSummits(this.pixelFromPoint(r.getTopLeft(),!0),this.pixelFromPoint(r.getTopRight(),!0),this.pixelFromPoint(r.getBottomLeft(),!0))},windowToViewportCoordinates:function(r){i.console.assert(this.viewer,"[Viewport.windowToViewportCoordinates] the viewport must have a viewer.");var a=r.minus(i.getElementPosition(this.viewer.element));return this.viewerElementToViewportCoordinates(a)},viewportToWindowCoordinates:function(r){i.console.assert(this.viewer,"[Viewport.viewportToWindowCoordinates] the viewport must have a viewer.");var a=this.viewportToViewerElementCoordinates(r);return a.plus(i.getElementPosition(this.viewer.element))},viewportToImageZoom:function(r){if(this.viewer){var a=this.viewer.world.getItemCount();if(a>1)this.silenceMultiImageWarnings||i.console.error("[Viewport.viewportToImageZoom] is not accurate with multi-image.");else if(a===1){var o=this.viewer.world.getItemAt(0);return o.viewportToImageZoom(r)}}var l=this._contentSizeNoRotate.x,d=this._containerInnerSize.x,u=this._contentBoundsNoRotate.width,h=d/l*u;return r*h},imageToViewportZoom:function(r){if(this.viewer){var a=this.viewer.world.getItemCount();if(a>1)this.silenceMultiImageWarnings||i.console.error("[Viewport.imageToViewportZoom] is not accurate with multi-image. Instead, use [TiledImage.imageToViewportZoom] for the specific image of interest");else if(a===1){var o=this.viewer.world.getItemAt(0);return o.imageToViewportZoom(r)}}var l=this._contentSizeNoRotate.x,d=this._containerInnerSize.x,u=this._contentBoundsNoRotate.width,h=l/d/u;return r*h},toggleFlip:function(){return this.setFlip(!this.getFlip()),this},getFlip:function(){return this.flipped},setFlip:function(r){return this.flipped===r?this:(this.flipped=r,this.viewer.navigator&&this.viewer.navigator.setFlip(this.getFlip()),this.viewer.forceRedraw(),this.viewer.raiseEvent("flip",{flipped:r}),this)},getMaxZoomPixelRatio:function(){return this.maxZoomPixelRatio},setMaxZoomPixelRatio:function(r,a=!0,o=!1){i.console.assert(!isNaN(r),"[Viewport.setMaxZoomPixelRatio] ratio must be a number"),!isNaN(r)&&(this.maxZoomPixelRatio=r,a&&this.getZoom()>this.getMaxZoom()&&this.applyConstraints(o))}}})(M),(function(i){i.TiledImage=function(r){this._initialized=!1,i.console.assert(r.tileCache,"[TiledImage] options.tileCache is required"),i.console.assert(r.drawer,"[TiledImage] options.drawer is required"),i.console.assert(r.viewer,"[TiledImage] options.viewer is required"),i.console.assert(r.imageLoader,"[TiledImage] options.imageLoader is required"),i.console.assert(r.source,"[TiledImage] options.source is required"),i.console.assert(!r.clip||r.clip instanceof i.Rect,"[TiledImage] options.clip must be an OpenSeadragon.Rect if present"),i.EventSource.call(this),this._tileCache=r.tileCache,delete r.tileCache,this._drawer=r.drawer,delete r.drawer,this._imageLoader=r.imageLoader,delete r.imageLoader,r.clip instanceof i.Rect&&(this._clip=r.clip.clone()),delete r.clip;var a=r.x||0;delete r.x;var o=r.y||0;delete r.y,this.normHeight=r.source.dimensions.y/r.source.dimensions.x,this.contentAspectX=r.source.dimensions.x/r.source.dimensions.y;var l=1;r.width?(l=r.width,delete r.width,r.height&&(i.console.error("specifying both width and height to a tiledImage is not supported"),delete r.height)):r.height&&(l=r.height/this.normHeight,delete r.height);var d=r.fitBounds;delete r.fitBounds;var u=r.fitBoundsPlacement||M.Placement.CENTER;delete r.fitBoundsPlacement;var h=r.degrees||0;delete r.degrees;var f=r.ajaxHeaders;delete r.ajaxHeaders,i.extend(!0,this,{viewer:null,tilesMatrix:{},coverage:{},loadingCoverage:{},lastDrawn:[],lastResetTime:0,_needsDraw:!0,_needsUpdate:!0,_hasOpaqueTile:!1,_tilesLoading:0,_tilesToDraw:[],_lastDrawn:[],_isBlending:!1,_wasBlending:!1,_isTainted:!1,springStiffness:i.DEFAULT_SETTINGS.springStiffness,animationTime:i.DEFAULT_SETTINGS.animationTime,minZoomImageRatio:i.DEFAULT_SETTINGS.minZoomImageRatio,wrapHorizontal:i.DEFAULT_SETTINGS.wrapHorizontal,wrapVertical:i.DEFAULT_SETTINGS.wrapVertical,immediateRender:i.DEFAULT_SETTINGS.immediateRender,blendTime:i.DEFAULT_SETTINGS.blendTime,alwaysBlend:i.DEFAULT_SETTINGS.alwaysBlend,minPixelRatio:i.DEFAULT_SETTINGS.minPixelRatio,smoothTileEdgesMinZoom:i.DEFAULT_SETTINGS.smoothTileEdgesMinZoom,iOSDevice:i.DEFAULT_SETTINGS.iOSDevice,debugMode:i.DEFAULT_SETTINGS.debugMode,crossOriginPolicy:i.DEFAULT_SETTINGS.crossOriginPolicy,ajaxWithCredentials:i.DEFAULT_SETTINGS.ajaxWithCredentials,placeholderFillStyle:i.DEFAULT_SETTINGS.placeholderFillStyle,opacity:i.DEFAULT_SETTINGS.opacity,preload:i.DEFAULT_SETTINGS.preload,compositeOperation:i.DEFAULT_SETTINGS.compositeOperation,subPixelRoundingForTransparency:i.DEFAULT_SETTINGS.subPixelRoundingForTransparency,maxTilesPerFrame:i.DEFAULT_SETTINGS.maxTilesPerFrame},r),this._preload=this.preload,delete this.preload,this._fullyLoaded=!1,this._xSpring=new i.Spring({initial:a,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._ySpring=new i.Spring({initial:o,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._scaleSpring=new i.Spring({initial:l,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._degreesSpring=new i.Spring({initial:h,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._updateForScale(),d&&this.fitBounds(d,u,!0),this._ownAjaxHeaders={},this.setAjaxHeaders(f,!1),this._initialized=!0},i.extend(i.TiledImage.prototype,i.EventSource.prototype,{needsDraw:function(){return this._needsDraw},redraw:function(){this._needsDraw=!0},getFullyLoaded:function(){return this._fullyLoaded},_setFullyLoaded:function(r){r!==this._fullyLoaded&&(this._fullyLoaded=r,this.raiseEvent("fully-loaded-change",{fullyLoaded:this._fullyLoaded}))},reset:function(){this._tileCache.clearTilesFor(this),this.lastResetTime=i.now(),this._needsDraw=!0},update:function(r){let a=this._xSpring.update(),o=this._ySpring.update(),l=this._scaleSpring.update(),d=this._degreesSpring.update(),u=a||o||l||d||this._needsUpdate;if(u||r||!this._fullyLoaded){let h=this._updateLevelsForViewport();this._setFullyLoaded(h)}return this._needsUpdate=!1,u?(this._updateForScale(),this._raiseBoundsChange(),this._needsDraw=!0,!0):!1},setDrawn:function(){return this._needsDraw=this._isBlending||this._wasBlending,this._needsDraw},setTainted(r){this._isTainted=r},isTainted(){return this._isTainted},destroy:function(){this.reset(),this.source.destroy&&this.source.destroy(this.viewer)},getBounds:function(r){return this.getBoundsNoRotate(r).rotate(this.getRotation(r),this._getRotationPoint(r))},getBoundsNoRotate:function(r){return r?new i.Rect(this._xSpring.current.value,this._ySpring.current.value,this._worldWidthCurrent,this._worldHeightCurrent):new i.Rect(this._xSpring.target.value,this._ySpring.target.value,this._worldWidthTarget,this._worldHeightTarget)},getWorldBounds:function(){return i.console.error("[TiledImage.getWorldBounds] is deprecated; use TiledImage.getBounds instead"),this.getBounds()},getClippedBounds:function(r){var a=this.getBoundsNoRotate(r);if(this._clip){var o=r?this._worldWidthCurrent:this._worldWidthTarget,l=o/this.source.dimensions.x,d=this._clip.times(l);a=new i.Rect(a.x+d.x,a.y+d.y,d.width,d.height)}return a.rotate(this.getRotation(r),this._getRotationPoint(r))},getTileBounds:function(r,a,o){var l=this.source.getNumTiles(r),d=(l.x+a%l.x)%l.x,u=(l.y+o%l.y)%l.y,h=this.source.getTileBounds(r,d,u);return this.getFlip()&&(h.x=Math.max(0,1-h.x-h.width)),h.x+=(a-d)/l.x,h.y+=this._worldHeightCurrent/this._worldWidthCurrent*((o-u)/l.y),h},getContentSize:function(){return new i.Point(this.source.dimensions.x,this.source.dimensions.y)},getSizeInWindowCoordinates:function(){var r=this.imageToWindowCoordinates(new i.Point(0,0)),a=this.imageToWindowCoordinates(this.getContentSize());return new i.Point(a.x-r.x,a.y-r.y)},_viewportToImageDelta:function(r,a,o){var l=o?this._scaleSpring.current.value:this._scaleSpring.target.value;return new i.Point(r*(this.source.dimensions.x/l),a*(this.source.dimensions.y*this.contentAspectX/l))},viewportToImageCoordinates:function(r,a,o){var l;return r instanceof i.Point?(o=a,l=r):l=new i.Point(r,a),l=l.rotate(-this.getRotation(o),this._getRotationPoint(o)),o?this._viewportToImageDelta(l.x-this._xSpring.current.value,l.y-this._ySpring.current.value):this._viewportToImageDelta(l.x-this._xSpring.target.value,l.y-this._ySpring.target.value)},_imageToViewportDelta:function(r,a,o){var l=o?this._scaleSpring.current.value:this._scaleSpring.target.value;return new i.Point(r/this.source.dimensions.x*l,a/this.source.dimensions.y/this.contentAspectX*l)},imageToViewportCoordinates:function(r,a,o){r instanceof i.Point&&(o=a,a=r.y,r=r.x);var l=this._imageToViewportDelta(r,a,o);return o?(l.x+=this._xSpring.current.value,l.y+=this._ySpring.current.value):(l.x+=this._xSpring.target.value,l.y+=this._ySpring.target.value),l.rotate(this.getRotation(o),this._getRotationPoint(o))},imageToViewportRectangle:function(r,a,o,l,d){var u=r;u instanceof i.Rect?d=a:u=new i.Rect(r,a,o,l);var h=this.imageToViewportCoordinates(u.getTopLeft(),d),f=this._imageToViewportDelta(u.width,u.height,d);return new i.Rect(h.x,h.y,f.x,f.y,u.degrees+this.getRotation(d))},viewportToImageRectangle:function(r,a,o,l,d){var u=r;r instanceof i.Rect?d=a:u=new i.Rect(r,a,o,l);var h=this.viewportToImageCoordinates(u.getTopLeft(),d),f=this._viewportToImageDelta(u.width,u.height,d);return new i.Rect(h.x,h.y,f.x,f.y,u.degrees-this.getRotation(d))},viewerElementToImageCoordinates:function(r){var a=this.viewport.pointFromPixel(r,!0);return this.viewportToImageCoordinates(a)},imageToViewerElementCoordinates:function(r){var a=this.imageToViewportCoordinates(r);return this.viewport.pixelFromPoint(a,!0)},windowToImageCoordinates:function(r){var a=r.minus(M.getElementPosition(this.viewer.element));return this.viewerElementToImageCoordinates(a)},imageToWindowCoordinates:function(r){var a=this.imageToViewerElementCoordinates(r);return a.plus(M.getElementPosition(this.viewer.element))},_viewportToTiledImageRectangle:function(r){var a=this._scaleSpring.current.value;return r=r.rotate(-this.getRotation(!0),this._getRotationPoint(!0)),new i.Rect((r.x-this._xSpring.current.value)/a,(r.y-this._ySpring.current.value)/a,r.width/a,r.height/a,r.degrees)},viewportToImageZoom:function(r){var a=this._scaleSpring.current.value*this.viewport._containerInnerSize.x/this.source.dimensions.x;return a*r},imageToViewportZoom:function(r){var a=this._scaleSpring.current.value*this.viewport._containerInnerSize.x/this.source.dimensions.x;return r/a},setPosition:function(r,a){var o=this._xSpring.target.value===r.x&&this._ySpring.target.value===r.y;if(a){if(o&&this._xSpring.current.value===r.x&&this._ySpring.current.value===r.y)return;this._xSpring.resetTo(r.x),this._ySpring.resetTo(r.y),this._needsDraw=!0,this._needsUpdate=!0}else{if(o)return;this._xSpring.springTo(r.x),this._ySpring.springTo(r.y),this._needsDraw=!0,this._needsUpdate=!0}o||this._raiseBoundsChange()},setWidth:function(r,a){this._setScale(r,a)},setHeight:function(r,a){this._setScale(r/this.normHeight,a)},setCroppingPolygons:function(r){var a=function(l){return l instanceof i.Point||typeof l.x=="number"&&typeof l.y=="number"},o=function(l){return l.map(function(d){try{if(a(d))return{x:d.x,y:d.y};throw new Error}catch{throw new Error("A Provided cropping polygon point is not supported")}})};try{if(!i.isArray(r))throw new Error("Provided cropping polygon is not an array");this._croppingPolygons=r.map(function(l){return o(l)}),this._needsDraw=!0}catch(l){i.console.error("[TiledImage.setCroppingPolygons] Cropping polygon format not supported"),i.console.error(l),this.resetCroppingPolygons()}},resetCroppingPolygons:function(){this._croppingPolygons=null,this._needsDraw=!0},fitBounds:function(r,a,o){a=a||i.Placement.CENTER;var l=i.Placement.properties[a],d=this.contentAspectX,u=0,h=0,f=1,g=1;if(this._clip&&(d=this._clip.getAspectRatio(),f=this._clip.width/this.source.dimensions.x,g=this._clip.height/this.source.dimensions.y,r.getAspectRatio()>d?(u=this._clip.x/this._clip.height*r.height,h=this._clip.y/this._clip.height*r.height):(u=this._clip.x/this._clip.width*r.width,h=this._clip.y/this._clip.width*r.width)),r.getAspectRatio()>d){var v=r.height/g,T=0;l.isHorizontallyCentered?T=(r.width-r.height*d)/2:l.isRight&&(T=r.width-r.height*d),this.setPosition(new i.Point(r.x-u+T,r.y-h),o),this.setHeight(v,o)}else{var E=r.width/f,_=0;l.isVerticallyCentered?_=(r.height-r.width/d)/2:l.isBottom&&(_=r.height-r.width/d),this.setPosition(new i.Point(r.x-u,r.y-h+_),o),this.setWidth(E,o)}},getClip:function(){return this._clip?this._clip.clone():null},setClip:function(r){i.console.assert(!r||r instanceof i.Rect,"[TiledImage.setClip] newClip must be an OpenSeadragon.Rect or null"),r instanceof i.Rect?this._clip=r.clone():this._clip=null,this._needsUpdate=!0,this._needsDraw=!0,this.raiseEvent("clip-change")},getFlip:function(){return this.flipped},setFlip:function(r){this.flipped=r},get flipped(){return this._flipped},set flipped(r){let a=this._flipped!==!!r;this._flipped=!!r,a&&(this.update(!0),this._needsDraw=!0,this._raiseBoundsChange())},get wrapHorizontal(){return this._wrapHorizontal},set wrapHorizontal(r){let a=this._wrapHorizontal!==!!r;this._wrapHorizontal=!!r,this._initialized&&a&&(this.update(!0),this._needsDraw=!0)},get wrapVertical(){return this._wrapVertical},set wrapVertical(r){let a=this._wrapVertical!==!!r;this._wrapVertical=!!r,this._initialized&&a&&(this.update(!0),this._needsDraw=!0)},get debugMode(){return this._debugMode},set debugMode(r){this._debugMode=!!r,this._needsDraw=!0},getOpacity:function(){return this.opacity},setOpacity:function(r){this.opacity=r},get opacity(){return this._opacity},set opacity(r){r!==this.opacity&&(this._opacity=r,this._needsDraw=!0,this.raiseEvent("opacity-change",{opacity:this.opacity}))},getPreload:function(){return this._preload},setPreload:function(r){this._preload=!!r,this._needsDraw=!0},getRotation:function(r){return r?this._degreesSpring.current.value:this._degreesSpring.target.value},setRotation:function(r,a){this._degreesSpring.target.value===r&&this._degreesSpring.isAtTargetValue()||(a?this._degreesSpring.resetTo(r):this._degreesSpring.springTo(r),this._needsDraw=!0,this._needsUpdate=!0,this._raiseBoundsChange())},getDrawArea:function(){if(this._opacity===0&&!this._preload)return!1;var r=this._viewportToTiledImageRectangle(this.viewport.getBoundsWithMargins(!0));if(!this.wrapHorizontal&&!this.wrapVertical){var a=this._viewportToTiledImageRectangle(this.getClippedBounds(!0));r=r.intersection(a)}return r},getTilesToDraw:function(){let r=this._tilesToDraw.flat();return this._updateTilesInViewport(r),r=this._tilesToDraw.flat(),r.forEach(a=>{a.tile.beingDrawn=!0}),this._lastDrawn=r,r},_getRotationPoint:function(r){return this.getBoundsNoRotate(r).getCenter()},get compositeOperation(){return this._compositeOperation},set compositeOperation(r){r!==this._compositeOperation&&(this._compositeOperation=r,this._needsDraw=!0,this.raiseEvent("composite-operation-change",{compositeOperation:this._compositeOperation}))},getCompositeOperation:function(){return this._compositeOperation},setCompositeOperation:function(r){this.compositeOperation=r},setAjaxHeaders:function(r,a){if(r===null&&(r={}),!i.isPlainObject(r)){console.error("[TiledImage.setAjaxHeaders] Ignoring invalid headers, must be a plain object");return}this._ownAjaxHeaders=r,this._updateAjaxHeaders(a)},_updateAjaxHeaders:function(r){if(r===void 0&&(r=!0),i.isPlainObject(this.viewer.ajaxHeaders)?this.ajaxHeaders=i.extend({},this.viewer.ajaxHeaders,this._ownAjaxHeaders):this.ajaxHeaders=this._ownAjaxHeaders,r){var a,o,l,d;for(var u in this.tilesMatrix){a=this.source.getNumTiles(u);for(var h in this.tilesMatrix[u]){o=(a.x+h%a.x)%a.x;for(var f in this.tilesMatrix[u][h])if(l=(a.y+f%a.y)%a.y,d=this.tilesMatrix[u][h][f],d.loadWithAjax=this.loadTilesWithAjax,d.loadWithAjax){var g=this.source.getTileAjaxHeaders(u,o,l);d.ajaxHeaders=i.extend({},this.ajaxHeaders,g)}else d.ajaxHeaders=null}}for(var v=0;v<this._imageLoader.jobQueue.length;v++){var T=this._imageLoader.jobQueue[v];T.loadWithAjax=T.tile.loadWithAjax,T.ajaxHeaders=T.tile.loadWithAjax?T.tile.ajaxHeaders:null}}},_setScale:function(r,a){var o=this._scaleSpring.target.value===r;if(a){if(o&&this._scaleSpring.current.value===r)return;this._scaleSpring.resetTo(r),this._updateForScale(),this._needsDraw=!0,this._needsUpdate=!0}else{if(o)return;this._scaleSpring.springTo(r),this._updateForScale(),this._needsDraw=!0,this._needsUpdate=!0}o||this._raiseBoundsChange()},_updateForScale:function(){this._worldWidthTarget=this._scaleSpring.target.value,this._worldHeightTarget=this.normHeight*this._scaleSpring.target.value,this._worldWidthCurrent=this._scaleSpring.current.value,this._worldHeightCurrent=this.normHeight*this._scaleSpring.current.value},_raiseBoundsChange:function(){this.raiseEvent("bounds-change")},_isBottomItem:function(){return this.viewer.world.getItemAt(0)===this},_getLevelsInterval:function(){var r=Math.max(this.source.minLevel,Math.floor(Math.log(this.minZoomImageRatio)/Math.log(2))),a=this.viewport.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(0),!0).x*this._scaleSpring.current.value,o=Math.min(Math.abs(this.source.maxLevel),Math.abs(Math.floor(Math.log(a/this.minPixelRatio)/Math.log(2))));return o=Math.max(o,this.source.minLevel||0),r=Math.min(r,o),{lowestLevel:r,highestLevel:o}},_updateLevelsForViewport:function(){var r=this._getLevelsInterval(),a=r.lowestLevel,o=r.highestLevel,l=[],d=this.getDrawArea(),u=i.now();if(this._lastDrawn.forEach(Q=>{Q.tile.beingDrawn=!1}),this._tilesToDraw=[],this._tilesLoading=0,this.loadingCoverage={},!d)return this._needsDraw=!1,this._fullyLoaded;var h=new Array(o-a+1);for(let Q=0,ee=o;ee>=a;ee--,Q++)h[Q]=ee;for(let Q=o+1;Q<=this.source.maxLevel;Q++){var f=this.tilesMatrix[Q]&&this.tilesMatrix[Q][0]&&this.tilesMatrix[Q][0][0];if(f&&f.isBottomMost&&f.isRightMost&&f.loaded){h.push(Q);break}}let g=!1;for(let Q=0;Q<h.length;Q++){let ee=h[Q];var v=this.viewport.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(ee),!0).x*this._scaleSpring.current.value;if(Q===h.length-1||v>=this.minPixelRatio)g=!0;else if(!g)continue;var T=this.viewport.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(ee),!1).x*this._scaleSpring.current.value,E=this.viewport.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(Math.max(this.source.getClosestLevel(),0)),!1).x*this._scaleSpring.current.value,_=this.immediateRender?1:E,C=Math.min(1,(v-.5)/.5),D=_/Math.abs(_-T),H=this._updateLevel(ee,C,D,d,u,l);l=H.bestTiles;var N=H.updatedTiles.filter(he=>he.loaded),J=(function(he,ie,ue){return function(se){return{tile:se,level:he,levelOpacity:ie,currentTime:ue}}})(ee,C,u);if(this._tilesToDraw[ee]=N.map(J),this._providesCoverage(this.coverage,ee))break}return l&&l.length>0?(l.forEach(function(Q){Q&&!Q.context2D&&this._loadTile(Q,u)},this),this._needsDraw=!0,!1):this._tilesLoading===0},_updateTilesInViewport:function(r){let a=i.now(),o=this;this._tilesLoading=0,this._wasBlending=this._isBlending,this._isBlending=!1,this.loadingCoverage={};let l=r.length?r[0].level:0;if(!this.getDrawArea())return;function u(f){let g=f.tile;if(g&&g.loaded){let v=o._blendTile(g,g.x,g.y,f.level,f.levelOpacity,a,l);o._isBlending=o._isBlending||v,o._needsDraw=o._needsDraw||v||o._wasBlending}}let h=0;for(let f=0;f<r.length;f++){let g=r[f];u(g),this._providesCoverage(this.coverage,g.level)&&(h=Math.max(h,g.level))}if(h>0)for(let f in this._tilesToDraw)f<h&&delete this._tilesToDraw[f]},_blendTile:function(r,a,o,l,d,u,h){let f=1e3*this.blendTime,g,v;return r.blendStart||(r.blendStart=u),g=u-r.blendStart,v=f?Math.min(1,g/f):1,l===h&&(v=1,g=f),this.alwaysBlend&&(v*=d),r.opacity=v,v===1&&(this._setCoverage(this.coverage,l,a,o,!0),this._hasOpaqueTile=!0),g<f},_updateLevel:function(r,a,o,l,d,u){var h=l.getBoundingBox().getTopLeft(),f=l.getBoundingBox().getBottomRight();this.viewer&&this.viewer.raiseEvent("update-level",{tiledImage:this,havedrawn:!0,level:r,opacity:a,visibility:o,drawArea:l,topleft:h,bottomright:f,currenttime:d,best:u}),this._resetCoverage(this.coverage,r),this._resetCoverage(this.loadingCoverage,r);var g=this._getCornerTiles(r,h,f),v=g.topLeft,T=g.bottomRight,E=this.source.getNumTiles(r),_=this.viewport.pixelFromPoint(this.viewport.getCenter());this.getFlip()&&(T.x+=1,this.wrapHorizontal||(T.x=Math.min(T.x,E.x-1)));for(var C=Math.max(0,(T.x-v.x)*(T.y-v.y)),D=new Array(C),H=0,N=v.x;N<=T.x;N++)for(var J=v.y;J<=T.y;J++){var Q;if(this.getFlip()){var ee=(E.x+N%E.x)%E.x;Q=N+E.x-ee-ee-1}else Q=N;if(l.intersection(this.getTileBounds(r,Q,J))!==null){var he=this._updateTile(Q,J,r,o,_,E,d,u);u=he.bestTiles,D[H]=he.tile,H+=1}}return{bestTiles:u,updatedTiles:D}},_positionTile:function(r,a,o,l,d){var u=r.bounds.getTopLeft();u.x*=this._scaleSpring.current.value,u.y*=this._scaleSpring.current.value,u.x+=this._xSpring.current.value,u.y+=this._ySpring.current.value;var h=r.bounds.getSize();h.x*=this._scaleSpring.current.value,h.y*=this._scaleSpring.current.value,r.positionedBounds.x=u.x,r.positionedBounds.y=u.y,r.positionedBounds.width=h.x,r.positionedBounds.height=h.y;var f=o.pixelFromPointNoRotate(u,!0),g=o.pixelFromPointNoRotate(u,!1),v=o.deltaPixelsFromPointsNoRotate(h,!0),T=o.deltaPixelsFromPointsNoRotate(h,!1),E=g.plus(T.divide(2)),_=l.squaredDistanceTo(E);this.viewer.drawer.minimumOverlapRequired(this)&&(a||(v=v.plus(new i.Point(1,1))),r.isRightMost&&this.wrapHorizontal&&(v.x+=.75),r.isBottomMost&&this.wrapVertical&&(v.y+=.75)),r.position=f,r.size=v,r.squaredDistance=_,r.visibility=d},_updateTile:function(r,a,o,l,d,u,h,f){var g=this._getTile(r,a,o,h,u);this.viewer&&this.viewer.raiseEvent("update-tile",{tiledImage:this,tile:g}),this._setCoverage(this.coverage,o,r,a,!1);var v=g.loaded||g.loading||this._isCovered(this.loadingCoverage,o,r,a);if(this._setCoverage(this.loadingCoverage,o,r,a,v),!g.exists)return{bestTiles:f,tile:g};if(g.loaded&&g.opacity===1&&this._setCoverage(this.coverage,o,r,a,!0),this._positionTile(g,this.source.tileOverlap,this.viewport,d,l),!g.loaded)if(g.context2D)this._setTileLoaded(g);else{var T=this._tileCache.getImageRecord(g.cacheKey);T&&this._setTileLoaded(g,T.getData())}return g.loading?this._tilesLoading++:v||(f=this._compareTiles(f,g,this.maxTilesPerFrame)),{bestTiles:f,tile:g}},_getCornerTiles:function(r,a,o){var l,d;this.wrapHorizontal?(l=i.positiveModulo(a.x,1),d=i.positiveModulo(o.x,1)):(l=Math.max(0,a.x),d=Math.min(1,o.x));var u,h,f=1/this.source.aspectRatio;this.wrapVertical?(u=i.positiveModulo(a.y,f),h=i.positiveModulo(o.y,f)):(u=Math.max(0,a.y),h=Math.min(f,o.y));var g=this.source.getTileAtPoint(r,new i.Point(l,u)),v=this.source.getTileAtPoint(r,new i.Point(d,h)),T=this.source.getNumTiles(r);return this.wrapHorizontal&&(g.x+=T.x*Math.floor(a.x),v.x+=T.x*Math.floor(o.x)),this.wrapVertical&&(g.y+=T.y*Math.floor(a.y/f),v.y+=T.y*Math.floor(o.y/f)),{topLeft:g,bottomRight:v}},_getTile:function(r,a,o,l,d){var u,h,f,g,v,T,E,_,C,D,H=this.tilesMatrix,N=this.source;return H[o]||(H[o]={}),H[o][r]||(H[o][r]={}),(!H[o][r][a]||!H[o][r][a].flipped!=!this.flipped)&&(u=(d.x+r%d.x)%d.x,h=(d.y+a%d.y)%d.y,f=this.getTileBounds(o,r,a),g=N.getTileBounds(o,u,h,!0),v=N.tileExists(o,u,h),T=N.getTileUrl(o,u,h),E=N.getTilePostData(o,u,h),this.loadTilesWithAjax?(_=N.getTileAjaxHeaders(o,u,h),i.isPlainObject(this.ajaxHeaders)&&(_=i.extend({},this.ajaxHeaders,_))):_=null,C=N.getContext2D?N.getContext2D(o,u,h):void 0,D=new i.Tile(o,r,a,f,v,T,C,this.loadTilesWithAjax,_,g,E,N.getTileHashKey(o,u,h,T,_,E)),this.getFlip()?u===0&&(D.isRightMost=!0):u===d.x-1&&(D.isRightMost=!0),h===d.y-1&&(D.isBottomMost=!0),D.flipped=this.flipped,H[o][r][a]=D),D=H[o][r][a],D.lastTouchTime=l,D},_loadTile:function(r,a){var o=this;r.loading=!0,this._imageLoader.addJob({src:r.getUrl(),tile:r,source:this.source,postData:r.postData,loadWithAjax:r.loadWithAjax,ajaxHeaders:r.ajaxHeaders,crossOriginPolicy:this.crossOriginPolicy,ajaxWithCredentials:this.ajaxWithCredentials,callback:function(l,d,u){o._onTileLoad(r,a,l,d,u)},abort:function(){r.loading=!1}})},_onTileLoad:function(r,a,o,l,d){if(o)r.exists=!0;else{i.console.error("Tile %s failed to load: %s - error: %s",r,r.getUrl(),l),this.viewer.raiseEvent("tile-load-failed",{tile:r,tiledImage:this,time:a,message:l,tileRequest:d}),r.loading=!1,r.exists=!1;return}if(a<this.lastResetTime){i.console.warn("Ignoring tile %s loaded before reset: %s",r,r.getUrl()),r.loading=!1;return}var u=this,h=function(){var f=u.source,g=f.getClosestLevel();u._setTileLoaded(r,o,g,d)};h()},_setTileLoaded:function(r,a,o,l){var d=0,u=!1,h=this;function f(){return u&&i.console.error("Event 'tile-loaded' argument getCompletionCallback must be called synchronously. Its return value should be called asynchronously."),d++,g}function g(){d--,d===0&&(r.loading=!1,r.loaded=!0,r.hasTransparency=h.source.hasTransparency(r.context2D,r.getUrl(),r.ajaxHeaders,r.postData),r.context2D||h._tileCache.cacheTile({data:a,tile:r,cutoff:o,tiledImage:h}),h.viewer.raiseEvent("tile-ready",{tile:r,tiledImage:h,tileRequest:l}),h._needsDraw=!0)}var v=f();this.viewer.raiseEvent("tile-loaded",{tile:r,tiledImage:this,tileRequest:l,get image(){return i.console.error("[tile-loaded] event 'image' has been deprecated. Use 'data' property instead."),a},data:a,getCompletionCallback:f}),u=!0,v()},_compareTiles:function(r,a,o){return r?(r.push(a),this._sortTiles(r),r.length>o&&r.pop(),r):[a]},_sortTiles:function(r){r.sort(function(a,o){return a===null?1:o===null?-1:a.visibility===o.visibility?a.squaredDistance-o.squaredDistance:o.visibility-a.visibility})},_providesCoverage:function(r,a,o,l){var d,u,h,f;if(!r[a])return!1;if(o===void 0||l===void 0){d=r[a];for(h in d)if(Object.prototype.hasOwnProperty.call(d,h)){u=d[h];for(f in u)if(Object.prototype.hasOwnProperty.call(u,f)&&!u[f])return!1}return!0}return r[a][o]===void 0||r[a][o][l]===void 0||r[a][o][l]===!0},_isCovered:function(r,a,o,l){return o===void 0||l===void 0?this._providesCoverage(r,a+1):this._providesCoverage(r,a+1,2*o,2*l)&&this._providesCoverage(r,a+1,2*o,2*l+1)&&this._providesCoverage(r,a+1,2*o+1,2*l)&&this._providesCoverage(r,a+1,2*o+1,2*l+1)},_setCoverage:function(r,a,o,l,d){if(!r[a]){i.console.warn("Setting coverage for a tile before its level's coverage has been reset: %s",a);return}r[a][o]||(r[a][o]={}),r[a][o][l]=d},_resetCoverage:function(r,a){r[a]={}}})})(M),(function(i){var r=function(o){i.console.assert(o,"[TileCache.cacheTile] options is required"),i.console.assert(o.tile,"[TileCache.cacheTile] options.tile is required"),i.console.assert(o.tiledImage,"[TileCache.cacheTile] options.tiledImage is required"),this.tile=o.tile,this.tiledImage=o.tiledImage},a=function(o){i.console.assert(o,"[ImageRecord] options is required"),i.console.assert(o.data,"[ImageRecord] options.data is required"),this._tiles=[],o.create.apply(null,[this,o.data,o.ownerTile]),this._destroyImplementation=o.destroy.bind(null,this),this.getImage=o.getImage.bind(null,this),this.getData=o.getData.bind(null,this),this.getRenderedContext=o.getRenderedContext.bind(null,this)};a.prototype={destroy:function(){this._destroyImplementation(),this._tiles=null},addTile:function(o){i.console.assert(o,"[ImageRecord.addTile] tile is required"),this._tiles.push(o)},removeTile:function(o){for(var l=0;l<this._tiles.length;l++)if(this._tiles[l]===o){this._tiles.splice(l,1);return}i.console.warn("[ImageRecord.removeTile] trying to remove unknown tile",o)},getTileCount:function(){return this._tiles.length}},i.TileCache=function(o){o=o||{},this._maxImageCacheCount=o.maxImageCacheCount||i.DEFAULT_SETTINGS.maxImageCacheCount,this._tilesLoaded=[],this._imagesLoaded=[],this._imagesLoadedCount=0},i.TileCache.prototype={numTilesLoaded:function(){return this._tilesLoaded.length},cacheTile:function(o){i.console.assert(o,"[TileCache.cacheTile] options is required"),i.console.assert(o.tile,"[TileCache.cacheTile] options.tile is required"),i.console.assert(o.tile.cacheKey,"[TileCache.cacheTile] options.tile.cacheKey is required"),i.console.assert(o.tiledImage,"[TileCache.cacheTile] options.tiledImage is required");var l=o.cutoff||0,d=this._tilesLoaded.length,u=this._imagesLoaded[o.tile.cacheKey];if(u||(o.data||(i.console.error("[TileCache.cacheTile] options.image was renamed to options.data. '.image' attribute has been deprecated and will be removed in the future."),o.data=o.image),i.console.assert(o.data,"[TileCache.cacheTile] options.data is required to create an ImageRecord"),u=this._imagesLoaded[o.tile.cacheKey]=new a({data:o.data,ownerTile:o.tile,create:o.tiledImage.source.createTileCache,destroy:o.tiledImage.source.destroyTileCache,getImage:o.tiledImage.source.getTileCacheDataAsImage,getData:o.tiledImage.source.getTileCacheData,getRenderedContext:o.tiledImage.source.getTileCacheDataAsContext2D}),this._imagesLoadedCount++),u.addTile(o.tile),o.tile.cacheImageRecord=u,this._imagesLoadedCount>this._maxImageCacheCount){for(var h=null,f=-1,g=null,v,T,E,_,C,D,H=this._tilesLoaded.length-1;H>=0;H--)if(D=this._tilesLoaded[H],v=D.tile,!(v.level<=l||v.beingDrawn)){if(!h){h=v,f=H,g=D;continue}_=v.lastTouchTime,T=h.lastTouchTime,C=v.level,E=h.level,(_<T||_===T&&C>E)&&(h=v,f=H,g=D)}h&&f>=0&&(this._unloadTile(g),d=f)}this._tilesLoaded[d]=new r({tile:o.tile,tiledImage:o.tiledImage})},clearTilesFor:function(o){i.console.assert(o,"[TileCache.clearTilesFor] tiledImage is required");for(var l,d=0;d<this._tilesLoaded.length;++d)l=this._tilesLoaded[d],l.tiledImage===o&&(this._unloadTile(l),this._tilesLoaded.splice(d,1),d--)},getImageRecord:function(o){return i.console.assert(o,"[TileCache.getImageRecord] cacheKey is required"),this._imagesLoaded[o]},_unloadTile:function(o){i.console.assert(o,"[TileCache._unloadTile] tileRecord is required");var l=o.tile,d=o.tiledImage;let u=l.getCanvasContext&&l.getCanvasContext();l.unload(),l.cacheImageRecord=null;var h=this._imagesLoaded[l.cacheKey];h&&(h.removeTile(l),h.getTileCount()||(h.destroy(),delete this._imagesLoaded[l.cacheKey],this._imagesLoadedCount--,u&&(u.canvas.width=0,u.canvas.height=0,d.viewer.raiseEvent("image-unloaded",{context2D:u,tile:l}))),d.viewer.raiseEvent("tile-unloaded",{tile:l,tiledImage:d}))}}})(M),(function(i){i.World=function(r){var a=this;i.console.assert(r.viewer,"[World] options.viewer is required"),i.EventSource.call(this),this.viewer=r.viewer,this._items=[],this._needsDraw=!1,this._autoRefigureSizes=!0,this._needsSizesFigured=!1,this._delegatedFigureSizes=function(o){a._autoRefigureSizes?a._figureSizes():a._needsSizesFigured=!0},this._figureSizes()},i.extend(i.World.prototype,i.EventSource.prototype,{addItem:function(r,a){if(i.console.assert(r,"[World.addItem] item is required"),i.console.assert(r instanceof i.TiledImage,"[World.addItem] only TiledImages supported at this time"),a=a||{},a.index!==void 0){var o=Math.max(0,Math.min(this._items.length,a.index));this._items.splice(o,0,r)}else this._items.push(r);this._autoRefigureSizes?this._figureSizes():this._needsSizesFigured=!0,this._needsDraw=!0,r.addHandler("bounds-change",this._delegatedFigureSizes),r.addHandler("clip-change",this._delegatedFigureSizes),this.raiseEvent("add-item",{item:r})},getItemAt:function(r){return i.console.assert(r!==void 0,"[World.getItemAt] index is required"),this._items[r]},getIndexOfItem:function(r){return i.console.assert(r,"[World.getIndexOfItem] item is required"),i.indexOf(this._items,r)},getItemCount:function(){return this._items.length},setItemIndex:function(r,a){i.console.assert(r,"[World.setItemIndex] item is required"),i.console.assert(a!==void 0,"[World.setItemIndex] index is required");var o=this.getIndexOfItem(r);if(a>=this._items.length)throw new Error("Index bigger than number of layers.");a===o||o===-1||(this._items.splice(o,1),this._items.splice(a,0,r),this._needsDraw=!0,this.raiseEvent("item-index-change",{item:r,previousIndex:o,newIndex:a}))},removeItem:function(r){i.console.assert(r,"[World.removeItem] item is required");var a=i.indexOf(this._items,r);a!==-1&&(r.removeHandler("bounds-change",this._delegatedFigureSizes),r.removeHandler("clip-change",this._delegatedFigureSizes),r.destroy(),this._items.splice(a,1),this._figureSizes(),this._needsDraw=!0,this._raiseRemoveItem(r))},removeAll:function(){this.viewer._cancelPendingImages();var r,a;for(a=0;a<this._items.length;a++)r=this._items[a],r.removeHandler("bounds-change",this._delegatedFigureSizes),r.removeHandler("clip-change",this._delegatedFigureSizes),r.destroy();var o=this._items;for(this._items=[],this._figureSizes(),this._needsDraw=!0,a=0;a<o.length;a++)r=o[a],this._raiseRemoveItem(r)},resetItems:function(){for(var r=0;r<this._items.length;r++)this._items[r].reset()},update:function(r){for(var a=!1,o=0;o<this._items.length;o++)a=this._items[o].update(r)||a;return a},draw:function(){this.viewer.drawer.draw(this._items),this._needsDraw=!1,this._items.forEach(r=>{this._needsDraw=r.setDrawn()||this._needsDraw})},needsDraw:function(){for(var r=0;r<this._items.length;r++)if(this._items[r].needsDraw())return!0;return this._needsDraw},getHomeBounds:function(){return this._homeBounds.clone()},getContentFactor:function(){return this._contentFactor},setAutoRefigureSizes:function(r){this._autoRefigureSizes=r,r&this._needsSizesFigured&&(this._figureSizes(),this._needsSizesFigured=!1)},arrange:function(r){r=r||{};var a=r.immediately||!1,o=r.layout||i.DEFAULT_SETTINGS.collectionLayout,l=r.rows||i.DEFAULT_SETTINGS.collectionRows,d=r.columns||i.DEFAULT_SETTINGS.collectionColumns,u=r.tileSize||i.DEFAULT_SETTINGS.collectionTileSize,h=r.tileMargin||i.DEFAULT_SETTINGS.collectionTileMargin,f=u+h,g;!r.rows&&d?g=d:g=Math.ceil(this._items.length/l);var v=0,T=0,E,_,C,D,H;this.setAutoRefigureSizes(!1);for(var N=0;N<this._items.length;N++)N&&N%g===0&&(o==="horizontal"?(T+=f,v=0):(v+=f,T=0)),E=this._items[N],_=E.getBounds(),_.width>_.height?C=u:C=u*(_.width/_.height),D=C*(_.height/_.width),H=new i.Point(v+(u-C)/2,T+(u-D)/2),E.setPosition(H,a),E.setWidth(C,a),o==="horizontal"?v+=f:T+=f;this.setAutoRefigureSizes(!0)},_figureSizes:function(){var r=this._homeBounds?this._homeBounds.clone():null,a=this._contentSize?this._contentSize.clone():null,o=this._contentFactor||0;if(!this._items.length)this._homeBounds=new i.Rect(0,0,1,1),this._contentSize=new i.Point(1,1),this._contentFactor=1;else{var l=this._items[0],d=l.getBounds();this._contentFactor=l.getContentSize().x/d.width;for(var u=l.getClippedBounds().getBoundingBox(),h=u.x,f=u.y,g=u.x+u.width,v=u.y+u.height,T=1;T<this._items.length;T++)l=this._items[T],d=l.getBounds(),this._contentFactor=Math.max(this._contentFactor,l.getContentSize().x/d.width),u=l.getClippedBounds().getBoundingBox(),h=Math.min(h,u.x),f=Math.min(f,u.y),g=Math.max(g,u.x+u.width),v=Math.max(v,u.y+u.height);this._homeBounds=new i.Rect(h,f,g-h,v-f),this._contentSize=new i.Point(this._homeBounds.width*this._contentFactor,this._homeBounds.height*this._contentFactor)}(this._contentFactor!==o||!this._homeBounds.equals(r)||!this._contentSize.equals(a))&&this.raiseEvent("metrics-change",{})},_raiseRemoveItem:function(r){this.raiseEvent("remove-item",{item:r})}})})(M)})(no)),no.exports}var wd=yd();const Ys=Ku(wd),xd=`
  attribute vec2 a_position;
  attribute vec2 a_texCoord;
  
  varying vec2 v_texCoord;
  
  void main() {
    gl_Position = vec4(a_position, 0.0, 1.0);
    v_texCoord = a_texCoord;
  }
`,Td=`
  precision mediump float;
  
  varying vec2 v_texCoord;
  
  uniform sampler2D u_image;        // The tile image texture
  uniform sampler2D u_mask;         // The distance mask (black=land, white=water)
  uniform float u_time;             // Animation time
  uniform float u_waveSpeed;        // Speed of wave animation
  uniform float u_waveFrequency;    // Frequency of waves
  uniform float u_foamThreshold;    // Controls how far from shore foam appears
  uniform float u_pixelSize;        // Not used currently
  uniform vec2 u_resolution;        // Canvas resolution
  uniform bool u_showMask;          // Debug: show mask instead of effect
  uniform float u_rippleDarkness;   // Controls how dark the ripples are
  uniform float u_waterDarkness;    // Controls overall water color darkness
  
  // Foam/wave colors
  const vec3 foamColor = vec3(0.85, 0.92, 0.95);     // Bright white-blue foam (much lighter!)
  const vec3 waveHighlight = vec3(0.7, 0.8, 0.88);   // Light blue for wave crests
  const vec3 rippleDark = vec3(0.1, 0.18, 0.25);     // Darker blue for ripple troughs
  
  void main() {
    vec2 uv = v_texCoord;
    
    // Sample the mask (0 = land, 1 = water)
    float maskValue = texture2D(u_mask, uv).r;
    
    // Debug mode: show mask
    if (u_showMask) {
      gl_FragColor = vec4(vec3(maskValue), maskValue > 0.01 ? 0.8 : 0.0);
      return;
    }
    
    // If mask is very dark (land), output transparent - let base tiles show through
    if (maskValue < 0.02) {
      gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
      return;
    }
    
    // We're in water territory - calculate wave effects
    
    // Create wave animation based on distance from shore
    float shoreDistance = maskValue;
    
    // Wave driver - creates waves that move toward shore
    float wavePhase = u_time * u_waveSpeed - shoreDistance * u_waveFrequency;
    float wave = sin(wavePhase);
    
    // Secondary wave for more natural movement
    float wave2 = sin(wavePhase * 0.7 + 2.0);
    float combinedWave = (wave + wave2 * 0.4) / 1.4;
    
    // Quantize for pixel art look (creates distinct bands)
    float pixelWave = floor(combinedWave * 4.0 + 0.5) / 4.0;
    
    // === RIPPLES IN DEEP WATER ===
    // Use multiple overlapping waves at incommensurate frequencies for organic feel
    float rippleSpeed = u_waveSpeed * 0.25;
    
    // Primary ripple layers - different scales and directions
    float r1 = sin((uv.x * 47.0 + uv.y * 31.0) + u_time * rippleSpeed * 1.0);
    float r2 = sin((uv.x * 29.0 - uv.y * 43.0) + u_time * rippleSpeed * 0.7 + 1.5);
    float r3 = sin((uv.x * 17.0 + uv.y * 53.0) + u_time * rippleSpeed * 1.3 + 3.1);
    float r4 = sin((uv.y * 37.0 - uv.x * 23.0) + u_time * rippleSpeed * 0.9 + 2.2);
    
    // Secondary finer detail ripples
    float r5 = sin((uv.x * 71.0 + uv.y * 67.0) + u_time * rippleSpeed * 1.1 + 0.7) * 0.5;
    float r6 = sin((uv.x * 83.0 - uv.y * 79.0) + u_time * rippleSpeed * 0.8 + 4.2) * 0.4;
    
    // Add some position-based variation to break up repetition
    float posNoise = sin(uv.x * 11.0) * sin(uv.y * 13.0) * 0.3;
    
    // Combine with varying weights
    float combinedRipple = (r1 + r2 * 0.8 + r3 * 0.6 + r4 * 0.7 + r5 + r6 + posNoise) / 3.5;
    
    // Quantize for pixel art look but with more levels for subtlety
    float pixelRipple = floor(combinedRipple * 5.0 + 0.5) / 5.0;
    
    // Ripples are stronger in deep water
    float deepWaterFactor = smoothstep(0.4, 0.8, maskValue);
    float rippleIntensity = pixelRipple * deepWaterFactor * u_rippleDarkness;
    
    // Foam at shoreline
    float shoreProximity = 1.0 - maskValue;
    float foamZone = smoothstep(1.0 - u_foamThreshold, 1.0 - u_foamThreshold + 0.15, shoreProximity);
    float foamIntensity = foamZone * max(0.0, pixelWave);
    
    // Wave highlight in deeper water - brighter on wave peaks
    float waveHighlightIntensity = (1.0 - foamZone) * max(0.0, pixelWave * 0.4);
    
    // Calculate the overlay effect - this is what we add/blend on top of the original tile
    // We need both darkening (ripples) and lightening (foam, wave crests)
    
    vec3 overlayColor = vec3(0.0);
    float overlayAlpha = 0.0;
    
    // Base water tint - apply water darkness as an overall color shift
    if (u_waterDarkness > 0.0) {
      vec3 waterTint = vec3(0.08, 0.12, 0.18); // Slight blue-dark tint
      overlayColor = waterTint;
      overlayAlpha = u_waterDarkness * maskValue * 0.5;
    }
    
    // Ripples create alternating light and dark bands
    // Positive rippleIntensity = trough (darken), negative = crest (lighten)
    float rippleCrest = max(0.0, -rippleIntensity); // Light bands
    float rippleTrough = max(0.0, rippleIntensity);  // Dark bands
    
    // Add darkening from ripple troughs
    if (rippleTrough > 0.0) {
      overlayColor = mix(overlayColor, rippleDark, rippleTrough * 0.7);
      overlayAlpha = max(overlayAlpha, rippleTrough * 0.6);
    }
    
    // Add lightening from ripple crests (subtle highlight)
    if (rippleCrest > 0.0) {
      float crestBlend = rippleCrest * 0.5;
      overlayColor = mix(overlayColor, waveHighlight, crestBlend);
      overlayAlpha = max(overlayAlpha, crestBlend * 0.4);
    }
    
    // Wave highlights in deeper water - brighten on wave peaks
    if (waveHighlightIntensity > 0.0) {
      float highlightBlend = waveHighlightIntensity * maskValue * 0.6;
      overlayColor = mix(overlayColor, waveHighlight, highlightBlend);
      overlayAlpha = max(overlayAlpha, highlightBlend * 0.5);
    }
    
    // Foam at shoreline - this should be the brightest effect!
    if (foamIntensity > 0.0) {
      float foamBlend = foamIntensity * 0.85; // Strong foam visibility
      overlayColor = mix(overlayColor, foamColor, foamBlend);
      overlayAlpha = max(overlayAlpha, foamIntensity * 0.9); // High alpha for bright foam
    }
    
    // Fade alpha based on how much we're in water
    overlayAlpha *= smoothstep(0.02, 0.12, maskValue);
    
    gl_FragColor = vec4(overlayColor, overlayAlpha);
  }
`,_d={waveSpeed:2,waveFrequency:10,foamThreshold:.7,pixelSize:256,rippleDarkness:.5,waterDarkness:.15};function Yu(L,M,i){const r=L.createShader(M);return r?(L.shaderSource(r,i),L.compileShader(r),L.getShaderParameter(r,L.COMPILE_STATUS)?r:(console.error("Shader compile error:",L.getShaderInfoLog(r)),L.deleteShader(r),null)):null}function Sd(L,M,i){const r=L.createProgram();return r?(L.attachShader(r,M),L.attachShader(r,i),L.linkProgram(r),L.getProgramParameter(r,L.LINK_STATUS)?r:(console.error("Program link error:",L.getProgramInfoLog(r)),L.deleteProgram(r),null)):null}function Ed(L){const M=L.getContext("webgl",{alpha:!0,premultipliedAlpha:!1,preserveDrawingBuffer:!0});if(!M)return console.error("WebGL not supported"),null;const i=Yu(M,M.VERTEX_SHADER,xd),r=Yu(M,M.FRAGMENT_SHADER,Td);if(!i||!r)return null;const a=Sd(M,i,r);return a?{gl:M,program:a,locations:{a_position:M.getAttribLocation(a,"a_position"),a_texCoord:M.getAttribLocation(a,"a_texCoord"),u_image:M.getUniformLocation(a,"u_image"),u_mask:M.getUniformLocation(a,"u_mask"),u_time:M.getUniformLocation(a,"u_time"),u_waveSpeed:M.getUniformLocation(a,"u_waveSpeed"),u_waveFrequency:M.getUniformLocation(a,"u_waveFrequency"),u_foamThreshold:M.getUniformLocation(a,"u_foamThreshold"),u_pixelSize:M.getUniformLocation(a,"u_pixelSize"),u_resolution:M.getUniformLocation(a,"u_resolution"),u_showMask:M.getUniformLocation(a,"u_showMask"),u_rippleDarkness:M.getUniformLocation(a,"u_rippleDarkness"),u_waterDarkness:M.getUniformLocation(a,"u_waterDarkness")}}:null}function Pd(L,M){const i=L.createTexture();return i?(L.bindTexture(L.TEXTURE_2D,i),L.texImage2D(L.TEXTURE_2D,0,L.RGBA,L.RGBA,L.UNSIGNED_BYTE,M),L.texParameteri(L.TEXTURE_2D,L.TEXTURE_WRAP_S,L.CLAMP_TO_EDGE),L.texParameteri(L.TEXTURE_2D,L.TEXTURE_WRAP_T,L.CLAMP_TO_EDGE),L.texParameteri(L.TEXTURE_2D,L.TEXTURE_MIN_FILTER,L.LINEAR),L.texParameteri(L.TEXTURE_2D,L.TEXTURE_MAG_FILTER,L.NEAREST),i):null}function Cd(L,M=[0,0,0,255]){const i=L.createTexture();return i?(L.bindTexture(L.TEXTURE_2D,i),L.texImage2D(L.TEXTURE_2D,0,L.RGBA,1,1,0,L.RGBA,L.UNSIGNED_BYTE,new Uint8Array(M)),i):null}const Rd="https://isometric-nyc-tiles.cannoneyed.com/dzi";function $u(){return new URLSearchParams(window.location.search)}function Dd(){return $u().get("r2")==="true"?(console.log(" Using R2 tiles (via ?r2=true)"),Rd):"https://isometric-nyc-tiles.cannoneyed.com/dzi"}function kd(){const L=$u();return L.get("prod")==="true"?!1:L.get("debug")==="true"}const ln=Dd(),Qs=kd(),Qu=new Map,Ks=new Map,to=new Set,Js=new Set;function Fd({enabled:L,viewState:M,tileConfig:i,shaderParams:r,showMask:a=!1}){const o=Fe.useRef(null),l=Fe.useRef(null),d=Fe.useRef(0),u=Fe.useRef(performance.now()),h=Fe.useRef(null),f=Fe.useRef({position:null,texCoord:null}),[g,v]=Fe.useState(0);Fe.useEffect(()=>{if(!L)return;const E=o.current;if(!E)return;E.width=window.innerWidth,E.height=window.innerHeight;const _=Ed(E);if(!_){console.error("WaterShaderOverlay: Failed to initialize WebGL");return}console.log("WaterShaderOverlay: WebGL initialized successfully"),l.current=_;const{gl:C,program:D}=_,H=new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),N=C.createBuffer();C.bindBuffer(C.ARRAY_BUFFER,N),C.bufferData(C.ARRAY_BUFFER,H,C.STATIC_DRAW),f.current.position=N;const J=new Float32Array([0,1,1,1,0,0,0,0,1,1,1,0]),Q=C.createBuffer();C.bindBuffer(C.ARRAY_BUFFER,Q),C.bufferData(C.ARRAY_BUFFER,J,C.STATIC_DRAW),f.current.texCoord=Q,h.current=Cd(C,[0,0,0,255]),C.useProgram(D),C.enable(C.BLEND),C.blendFunc(C.SRC_ALPHA,C.ONE_MINUS_SRC_ALPHA);const ee=()=>{E&&(E.width=window.innerWidth,E.height=window.innerHeight)};return window.addEventListener("resize",ee),()=>{window.removeEventListener("resize",ee),d.current&&cancelAnimationFrame(d.current)}},[L]);const T=(E,_)=>{const C=_?Qu:Ks;if(C.has(E)||to.has(E)||Js.has(E))return;to.add(E);const D=new Image;D.crossOrigin="anonymous",D.onload=()=>{to.delete(E);const H=l.current;if(H){const N=Pd(H.gl,D);N&&(C.set(E,N),v(J=>J+1))}},D.onerror=()=>{to.delete(E),Js.add(E)},D.src=E};return Fe.useEffect(()=>{if(!L)return;const E=()=>{const _=l.current,C=o.current;if(!_||!C){d.current=requestAnimationFrame(E);return}const{gl:D,program:H,locations:N}=_,{gridWidth:J,gridHeight:Q,tileSize:ee}=i,{target:he,zoom:ie}=M,ue=(performance.now()-u.current)/1e3;(C.width!==window.innerWidth||C.height!==window.innerHeight)&&(C.width=window.innerWidth,C.height=window.innerHeight);const se=Math.pow(2,ie),pe=window.innerWidth,re=window.innerHeight,Te=Q*ee;if(ie<-3){D.viewport(0,0,C.width,C.height),D.clearColor(0,0,0,0),D.clear(D.COLOR_BUFFER_BIT),d.current=requestAnimationFrame(E);return}const Le=he[0],Ce=Te-he[1],Se=Le-pe/(2*se),Y=Le+pe/(2*se),de=Ce-re/(2*se),oe=Ce+re/(2*se),O=Math.max(0,Math.floor(Se/ee)),j=Math.min(J-1,Math.ceil(Y/ee)),ne=Math.max(0,Math.floor(de/ee)),Re=Math.min(Q-1,Math.ceil(oe/ee));D.viewport(0,0,C.width,C.height),D.clearColor(0,0,0,0),D.clear(D.COLOR_BUFFER_BIT),D.useProgram(H);for(let De=O;De<=j;De++)for(let ke=ne;ke<=Re;ke++){const Ne=`${ln}/tiles/0/${De}_${ke}.png`,ze=`/water_masks/0/${De}_${ke}.png`,He=Qu.get(Ne),Je=Ks.get(ze)||h.current;if(!He){T(Ne,!0);continue}if(!Ks.has(ze)&&!Js.has(ze)&&T(ze,!1),!He||!Je)continue;const Nt=De*ee,si=ke*ee,vt=(Nt-Le)*se+pe/2,Yt=(si-Ce)*se+re/2,rt=ee*se,yt=re-Yt-rt;vt+rt<0||vt>pe||yt+rt<0||yt>re||(D.viewport(vt,yt,rt,rt),D.scissor(vt,yt,rt,rt),D.enable(D.SCISSOR_TEST),D.bindBuffer(D.ARRAY_BUFFER,f.current.position),D.enableVertexAttribArray(N.a_position),D.vertexAttribPointer(N.a_position,2,D.FLOAT,!1,0,0),D.bindBuffer(D.ARRAY_BUFFER,f.current.texCoord),D.enableVertexAttribArray(N.a_texCoord),D.vertexAttribPointer(N.a_texCoord,2,D.FLOAT,!1,0,0),D.uniform1f(N.u_time,ue),D.uniform1f(N.u_waveSpeed,r.waveSpeed),D.uniform1f(N.u_waveFrequency,r.waveFrequency),D.uniform1f(N.u_foamThreshold,r.foamThreshold),D.uniform1f(N.u_pixelSize,r.pixelSize),D.uniform2f(N.u_resolution,rt,rt),D.uniform1i(N.u_showMask,a?1:0),D.uniform1f(N.u_rippleDarkness,r.rippleDarkness),D.uniform1f(N.u_waterDarkness,r.waterDarkness),D.activeTexture(D.TEXTURE0),D.bindTexture(D.TEXTURE_2D,He),D.uniform1i(N.u_image,0),D.activeTexture(D.TEXTURE1),D.bindTexture(D.TEXTURE_2D,Je),D.uniform1i(N.u_mask,1),D.drawArrays(D.TRIANGLES,0,6),D.disable(D.SCISSOR_TEST))}d.current=requestAnimationFrame(E)};return d.current=requestAnimationFrame(E),()=>{d.current&&cancelAnimationFrame(d.current)}},[L,M,i,r,a,g]),L?te.jsx("canvas",{ref:o,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none",zIndex:10}}):null}let $s=null;const Ld=new URLSearchParams(window.location.search).get("debug")==="true";function zd(L){Ld&&($s&&clearTimeout($s),$s=setTimeout(()=>{console.log(` Viewport: x=${Math.round(L.target[0])}, y=${Math.round(L.target[1])}, zoom=${L.zoom.toFixed(2)}`)},200))}function Od({tileConfig:L,viewState:M,onViewStateChange:i,onTileHover:r,waterShader:a,showMinimap:o=!0}){const l=Fe.useRef(null),d=Fe.useRef(null),u=Fe.useRef(!1),h=Fe.useRef(null),{gridWidth:f,gridHeight:g,tileSize:v,maxZoomLevel:T,dziUrl:E}=L,_=f*v,C=g*v,D=Fe.useCallback(N=>{const J=N.target[0]/_,Q=1-N.target[1]/C,ee=Math.pow(2,N.zoom),he=window.innerWidth/_*ee;return{centerX:J,centerY:Q,zoom:he}},[_,C]),H=Fe.useCallback(N=>{const J=N.viewport,Q=J.getCenter(),ee=J.getZoom(),he=Q.x*_,ie=(1-Q.y)*C,ue=Math.log2(ee*_/window.innerWidth);return{target:[he,ie,0],zoom:ue}},[_,C]);return Fe.useEffect(()=>{if(!l.current||d.current)return;const{centerX:N,centerY:J,zoom:Q}=D(M);let ee;if(E){const re=Math.ceil(Math.log2(Math.max(_,C))),Te=Math.ceil(Math.log2(v)),Me=Te;ee={width:_,height:C,tileSize:v,tileOverlap:0,minLevel:Te,maxLevel:re,getTileUrl:(Le,Ce,Se)=>{const Y=Le-Me;return`${E.replace(".dzi","_files")}/${Y}/${Ce}_${Se}.webp`}}}else ee={width:_,height:C,tileSize:v,tileOverlap:0,minLevel:0,maxLevel:T,getTileUrl:(re,Te,Me)=>{const Le=T-re,Ce=Math.pow(2,Le),Se=Math.ceil(f/Ce),Y=Math.ceil(g/Ce);return Te<0||Te>=Se||Me<0||Me>=Y?"":`${ln}/tiles/${Le}/${Te}_${Me}.png`}};const he=1,ie=1,ue={subPixelRoundingForTransparency:1,smoothTileEdgesMinZoom:1},se=Ys({element:l.current,prefixUrl:"",showNavigationControl:!1,crossOriginPolicy:"Anonymous",showNavigator:!0,navigatorPosition:"TOP_RIGHT",navigatorSizeRatio:.15,navigatorMaintainSizeRatio:!0,navigatorAutoFade:!1,navigatorBackground:"#0a1525",animationTime:.15,blendTime:.1,minZoomImageRatio:ie,maxZoomPixelRatio:he,visibilityRatio:.2,constrainDuringPan:!1,placeholderFillStyle:"rgba(35, 65, 105, 0.7)",gestureSettingsMouse:{scrollToZoom:!0,clickToZoom:!1,dblClickToZoom:!0,flickEnabled:!0},gestureSettingsTouch:{scrollToZoom:!1,clickToZoom:!1,dblClickToZoom:!0,flickEnabled:!0,pinchToZoom:!0},imageSmoothingEnabled:!1,tileSources:ee,...ue});se.addHandler("open",()=>{const re=se.world.getItemAt(0);re&&re.setCompositeOperation("source-over"),se.viewport.zoomTo(Q,void 0,!0),se.viewport.panTo(new Ys.Point(N,J),!0)}),se.addHandler("viewport-change",()=>{if(u.current)return;const re=H(se);h.current=re,i({viewState:re}),zd(re)}),se.addHandler("canvas-exit",()=>{r(null)});const pe=re=>{if(!re.position)return;const Te=re.position,Me=se.viewport.pointFromPixel(Te),Le=se.viewport.viewportToImageCoordinates(Me),Ce=Math.floor(Le.x/v),Se=Math.floor(Le.y/v);Ce>=0&&Ce<f&&Se>=0&&Se<g?r({x:Ce,y:Se}):r(null)};return se.addHandler("canvas-drag",pe),se.addHandler("canvas-scroll",pe),se.innerTracker.moveHandler=re=>{pe(re)},d.current=se,()=>{se.destroy(),d.current=null}},[f,g,v,T,_,C,D,H,i,r,E]),Fe.useEffect(()=>{const N=d.current;if(!N||!N.viewport)return;const J=h.current;if(J&&Math.abs(J.target[0]-M.target[0])<.01&&Math.abs(J.target[1]-M.target[1])<.01&&Math.abs(J.zoom-M.zoom)<.01)return;const{centerX:Q,centerY:ee,zoom:he}=D(M);u.current=!0,N.viewport.zoomTo(he,void 0,!1),N.viewport.panTo(new Ys.Point(Q,ee),!1),u.current=!1},[M,D]),Fe.useEffect(()=>{const N=d.current;if(!N||!N.navigator)return;const J=N.navigator.element;J&&(o?J.classList.remove("hidden"):J.classList.add("hidden"))},[o]),te.jsxs("div",{className:"map-container",children:[te.jsx("div",{ref:l,style:{width:"100%",height:"100%",background:"#0a0c14"}}),a&&te.jsx(Fd,{enabled:a.enabled,viewState:M,tileConfig:L,shaderParams:a.params,showMask:a.showMask})]})}function Md({waterShader:L,onWaterShaderChange:M}){const[i,r]=Fe.useState(!1);return te.jsxs("div",{className:`panel control-panel ${i?"collapsed":""}`,children:[te.jsxs("div",{className:"panel-header",onClick:()=>r(!i),style:{cursor:"pointer"},children:[te.jsx("span",{className:"panel-title",children:"Controls"}),te.jsx("span",{className:"collapse-icon",children:i?"":""})]}),!i&&te.jsxs("div",{className:"panel-content",children:[te.jsx("div",{className:"control-group",children:te.jsxs("div",{className:"control-label",children:[te.jsx("span",{children:"Water Shader"}),te.jsxs("label",{className:"toggle-switch",children:[te.jsx("input",{type:"checkbox",checked:L.enabled,onChange:a=>M({...L,enabled:a.target.checked})}),te.jsx("span",{className:"toggle-slider"})]})]})}),L.enabled&&te.jsxs(te.Fragment,{children:[te.jsx("div",{className:"control-group",children:te.jsxs("div",{className:"control-label",children:[te.jsx("span",{children:"Show Mask"}),te.jsxs("label",{className:"toggle-switch",children:[te.jsx("input",{type:"checkbox",checked:L.showMask,onChange:a=>M({...L,showMask:a.target.checked})}),te.jsx("span",{className:"toggle-slider"})]})]})}),te.jsxs("div",{className:"control-group",children:[te.jsxs("div",{className:"control-label",children:[te.jsx("span",{children:"Wave Speed"}),te.jsx("span",{className:"control-value",children:L.params.waveSpeed.toFixed(1)})]}),te.jsx("input",{type:"range",min:"0.5",max:"5.0",step:"0.1",value:L.params.waveSpeed,onChange:a=>M({...L,params:{...L.params,waveSpeed:parseFloat(a.target.value)}})})]}),te.jsxs("div",{className:"control-group",children:[te.jsxs("div",{className:"control-label",children:[te.jsx("span",{children:"Wave Frequency"}),te.jsx("span",{className:"control-value",children:L.params.waveFrequency.toFixed(1)})]}),te.jsx("input",{type:"range",min:"2.0",max:"20.0",step:"0.5",value:L.params.waveFrequency,onChange:a=>M({...L,params:{...L.params,waveFrequency:parseFloat(a.target.value)}})})]}),te.jsxs("div",{className:"control-group",children:[te.jsxs("div",{className:"control-label",children:[te.jsx("span",{children:"Ripple Intensity"}),te.jsxs("span",{className:"control-value",children:[Math.round(L.params.rippleDarkness*100),"%"]})]}),te.jsx("input",{type:"range",min:"0.0",max:"1.0",step:"0.05",value:L.params.rippleDarkness,onChange:a=>M({...L,params:{...L.params,rippleDarkness:parseFloat(a.target.value)}})})]}),te.jsxs("div",{className:"control-group",children:[te.jsxs("div",{className:"control-label",children:[te.jsx("span",{children:"Water Darkness"}),te.jsxs("span",{className:"control-value",children:[Math.round(L.params.waterDarkness*100),"%"]})]}),te.jsx("input",{type:"range",min:"0.0",max:"0.5",step:"0.05",value:L.params.waterDarkness,onChange:a=>M({...L,params:{...L.params,waterDarkness:parseFloat(a.target.value)}})})]}),te.jsxs("div",{className:"control-group",children:[te.jsxs("div",{className:"control-label",children:[te.jsx("span",{children:"Foam Threshold"}),te.jsxs("span",{className:"control-value",children:[Math.round(L.params.foamThreshold*100),"%"]})]}),te.jsx("input",{type:"range",min:"0.3",max:"0.95",step:"0.05",value:L.params.foamThreshold,onChange:a=>M({...L,params:{...L.params,foamThreshold:parseFloat(a.target.value)}})})]})]})]})]})}function Nd({hoveredTile:L,viewState:M,originX:i,originY:r}){const a=L!==null,o=L?L.x+i:0,l=L?L.y+r:0;return te.jsxs("div",{className:`panel tile-info ${a?"visible":""}`,children:[te.jsx("div",{className:"panel-header",children:te.jsx("span",{className:"panel-title",children:"Tile Info"})}),te.jsxs("div",{className:"tile-coords",children:[te.jsxs("div",{className:"coord",children:[te.jsx("span",{className:"coord-label",children:"X"}),te.jsx("span",{className:"coord-value",children:L?o:""})]}),te.jsxs("div",{className:"coord",children:[te.jsx("span",{className:"coord-label",children:"Y"}),te.jsx("span",{className:"coord-value",children:L?l:""})]})]}),L&&te.jsxs("div",{style:{marginTop:12,fontSize:10,color:"var(--color-text-muted)"},children:["Tile: (",L.x,", ",L.y,")",te.jsx("br",{}),"View center: (",Math.round(M.target[0]),","," ",Math.round(M.target[1]),")"]})]})}const ro="isometric-nyc-view-state",Id=6.6,Ad=11.03;function Bd(L){return 2*Math.log2(L/window.innerWidth)}function Hd(){return new URLSearchParams(window.location.search).get("reset")==="1"?(localStorage.removeItem(ro),window.history.replaceState({},"",window.location.pathname),!0):!1}function bd(L){if(Hd())return null;try{const M=localStorage.getItem(ro);if(M){const i=JSON.parse(M);if(Array.isArray(i.target)&&i.target.length>=2&&typeof i.zoom=="number"){const r=[i.target[0],i.target[1],i.target[2]??0];if(L){const a=L.gridWidth*L.tileSize,o=L.gridHeight*L.tileSize;if(r[0]<0||r[0]>a||r[1]<0||r[1]>o)return console.warn("Saved view position out of bounds, resetting:",r),localStorage.removeItem(ro),null}return{target:r,zoom:i.zoom}}}}catch(M){console.warn("Failed to load saved view state:",M)}return null}let ea=null;function io(L){ea&&clearTimeout(ea),ea=setTimeout(()=>{try{localStorage.setItem(ro,JSON.stringify(L))}catch(M){console.warn("Failed to save view state:",M)}},500)}function Ud(){const[L,M]=Fe.useState(null),[i,r]=Fe.useState(!0),[a,o]=Fe.useState(null),[l,d]=Fe.useState(null),u=Fe.useRef(null),h=Fe.useCallback(ie=>{u.current&&clearTimeout(u.current),u.current=setTimeout(()=>{console.log(`Zoom level: ${ie}`)},200)},[]);Fe.useEffect(()=>{const ie=`${ln}/tiles_metadata.json`,ue=`${ln}/tiles.dzi`;console.log("Checking for DZI at:",ue),fetch(ie).then(se=>{if(!se.ok)throw new Error(`DZI metadata not found: ${se.status}`);return se.json()}).then(se=>{console.log("Loaded DZI metadata:",se),M({gridWidth:se.gridWidth,gridHeight:se.gridHeight,originalWidth:se.gridWidth,originalHeight:se.gridHeight,tileSize:se.tileSize??512,maxZoomLevel:se.maxZoom??4,originX:se.originX??0,originY:se.originY??0,dziUrl:ue}),r(!1)}).catch(se=>{console.log("DZI not available, falling back to legacy manifest:",se),fetch(`${ln}/tiles/manifest.json`).then(pe=>{if(!pe.ok)throw new Error(`Failed to load manifest: ${pe.status}`);return pe.json()}).then(pe=>{M({gridWidth:pe.gridWidth,gridHeight:pe.gridHeight,originalWidth:pe.originalWidth??pe.gridWidth,originalHeight:pe.originalHeight??pe.gridHeight,tileSize:pe.tileSize,tileUrlPattern:`${ln}/tiles/{z}/{x}_{y}.png`,maxZoomLevel:pe.maxZoomLevel??0,originX:0,originY:0}),r(!1)}).catch(pe=>{console.error("Failed to load tile manifest:",pe),o(pe.message),r(!1)})})},[]);const[f,g]=Fe.useState(null),[v,T]=Fe.useState(!0);Fe.useEffect(()=>{if(!L)return;const ie=L.gridWidth*L.tileSize,ue=()=>{const se=Bd(ie);d(se),console.log(`Max zoom updated for 1:1 pixel ratio: ${se.toFixed(2)} (window: ${window.innerWidth}x${window.innerHeight}, image: ${ie}px)`)};return ue(),window.addEventListener("resize",ue),()=>window.removeEventListener("resize",ue)},[L]),Fe.useEffect(()=>{if(f&&l!==null&&f.zoom>l){console.log(`Clamping zoom from ${f.zoom.toFixed(2)} to ${l.toFixed(2)} due to window resize`);const ie={...f,zoom:l};g(ie),io(ie)}},[l,f]),Fe.useEffect(()=>{if(L&&l!==null&&!f){const ie=bd(L);if(ie){const re=Math.min(ie.zoom,l);console.log(`View init: restoring saved position (${ie.target[0]}, ${ie.target[1]}), zoom=${re} (saved: ${ie.zoom}, max: ${l.toFixed(2)})`),g({...ie,zoom:re});return}const ue=46192,se=67469,pe=Ad;console.log(`View init: using default position (${ue}, ${se}), zoom=${pe.toFixed(2)}`),g({target:[ue,se,0],zoom:pe})}},[L,l,f]);const[E,_]=Fe.useState([.5,.5,1]),[C,D]=Fe.useState(null),[H,N]=Fe.useState({enabled:Qs,showMask:!1,params:_d}),J=Fe.useCallback(ie=>{const ue=l!==null&&ie.viewState.zoom>l?{...ie.viewState,zoom:l}:ie.viewState;g(ue),io(ue),h(ue.zoom)},[l,h]),Q=Fe.useCallback(()=>{if(!f||l===null)return;const ie=Math.min(l,f.zoom*1.05),ue={...f,zoom:ie};g(ue),io(ue),h(ie)},[f,l,h]),ee=Fe.useCallback(()=>{if(!f)return;const ie=Math.max(Id,f.zoom/1.05),ue={...f,zoom:ie};g(ue),io(ue),h(ie)},[f,h]),he=Fe.useCallback(ie=>{D(ie)},[]);return i?te.jsx("div",{className:"app loading",children:te.jsx("div",{className:"loading-message",children:"Loading tile manifest..."})}):a||!L?te.jsx("div",{className:"app error",children:te.jsxs("div",{className:"error-message",children:["Failed to load tiles: ",a||"Unknown error"]})}):!f||l===null?te.jsx("div",{className:"app loading",children:te.jsx("div",{className:"loading-message",children:"Initializing view..."})}):te.jsxs("div",{className:"app",children:[te.jsx(Od,{tileConfig:L,viewState:f,onViewStateChange:J,lightDirection:E,onTileHover:he,waterShader:H,showMinimap:v}),te.jsxs("header",{className:"header",children:[te.jsx("h1",{children:"Isometric NYC"}),te.jsxs("div",{className:"header-actions",children:[te.jsx("button",{className:"icon-button",onClick:Q,title:"Zoom in",children:te.jsx(pd,{size:14})}),te.jsx("button",{className:"icon-button",onClick:ee,title:"Zoom out",children:te.jsx(md,{size:14})}),te.jsx("button",{className:`icon-button ${v?"active":""}`,onClick:()=>T(!v),title:v?"Hide minimap":"Show minimap",children:te.jsx(dd,{size:14})}),te.jsx("a",{href:"https://cannoneyed.com/projects/isometric-nyc",target:"_blank",rel:"noopener noreferrer",className:"icon-button",title:"About this project",children:te.jsx(cd,{size:14})})]})]}),Qs&&te.jsx(Md,{waterShader:H,onWaterShaderChange:N}),Qs&&te.jsx(Nd,{hoveredTile:C,viewState:f,originX:L.originX,originY:L.originY})]})}nd.createRoot(document.getElementById("root")).render(te.jsx(Ud,{}));
